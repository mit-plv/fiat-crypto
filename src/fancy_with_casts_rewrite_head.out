fancy_with_casts_rewrite_head = 
match idc in (Compilers.ident t) return (Compile.value' true t) with
| @Literal t v => Base (##v)%expr
| Nat_succ => fun x : expr ℕ => Base (#(Nat_succ)%expr @ x)%expr_pat
| Nat_pred => fun x : expr ℕ => Base (#(Nat_pred)%expr @ x)%expr_pat
| Nat_max => fun x x0 : expr ℕ => Base (#(Nat_max)%expr @ x @ x0)%expr_pat
| Nat_mul => fun x x0 : expr ℕ => Base (#(Nat_mul)%expr @ x @ x0)%expr_pat
| Nat_add => fun x x0 : expr ℕ => Base (#(Nat_add)%expr @ x @ x0)%expr_pat
| Nat_sub => fun x x0 : expr ℕ => Base (#(Nat_sub)%expr @ x @ x0)%expr_pat
| Nat_eqb => fun x x0 : expr ℕ => Base (#(Nat_eqb)%expr @ x @ x0)%expr_pat
| @nil t => Base []%expr_pat
| @cons t => fun (x : expr t) (x0 : expr (list t)) => Base (x :: x0)%expr_pat
| @pair A B => fun (x : expr A) (x0 : expr B) => Base (x, x0)%expr_pat
| @fst A B => fun x : expr (A * B)%etype => Base (#(fst)%expr @ x)%expr_pat
| @snd A B => fun x : expr (A * B)%etype => Base (#(snd)%expr @ x)%expr_pat
| @prod_rect A B T =>
    fun (x : expr A -> expr B -> UnderLets (expr T))
      (x0 : expr (A * B)%etype) =>
    Base
      (#(prod_rect)%expr @
       (λ (x1 : var A)(x2 : var B),
        to_expr (x ($x1) ($x2)))%expr @ x0)%expr_pat
| @bool_rect T =>
    fun (x x0 : expr unit -> UnderLets (expr T)) (x1 : expr bool) =>
    Base
      (#(bool_rect)%expr @ (λ x2 : var unit,
                            to_expr (x ($x2)))%expr @
       (λ x2 : var unit,
        to_expr (x0 ($x2)))%expr @ x1)%expr_pat
| @nat_rect P =>
    fun (x : expr unit -> UnderLets (expr P))
      (x0 : expr ℕ -> expr P -> UnderLets (expr P)) (x1 : expr ℕ) =>
    Base
      (#(nat_rect)%expr @ (λ x2 : var unit,
                           to_expr (x ($x2)))%expr @
       (λ (x2 : var ℕ)(x3 : var P),
        to_expr (x0 ($x2) ($x3)))%expr @ x1)%expr_pat
| @nat_rect_arrow P Q =>
    fun (x : expr P -> UnderLets (expr Q))
      (x0 : expr ℕ ->
            (expr P -> UnderLets (expr Q)) -> expr P -> UnderLets (expr Q))
      (x1 : expr ℕ) (x2 : expr P) =>
    Base
      (#(nat_rect_arrow)%expr @ (λ x3 : var P,
                                 to_expr (x ($x3)))%expr @
       (λ (x3 : var ℕ)(x4 : var (P -> Q)%ptype)(x5 : var P),
        to_expr
          (x0 ($x3) (fun x6 : expr P => Base ($x4 @ x6)%expr_pat) ($x5)))%expr @
       x1 @ x2)%expr_pat
| @list_rect A P =>
    fun (x : expr unit -> UnderLets (expr P))
      (x0 : expr A -> expr (list A) -> expr P -> UnderLets (expr P))
      (x1 : expr (list A)) =>
    Base
      (#(list_rect)%expr @ (λ x2 : var unit,
                            to_expr (x ($x2)))%expr @
       (λ (x2 : var A)(x3 : var (list A))(x4 : var P),
        to_expr (x0 ($x2) ($x3) ($x4)))%expr @ x1)%expr_pat
| @list_case A P =>
    fun (x : expr unit -> UnderLets (expr P))
      (x0 : expr A -> expr (list A) -> UnderLets (expr P))
      (x1 : expr (list A)) =>
    Base
      (#(list_case)%expr @ (λ x2 : var unit,
                            to_expr (x ($x2)))%expr @
       (λ (x2 : var A)(x3 : var (list A)),
        to_expr (x0 ($x2) ($x3)))%expr @ x1)%expr_pat
| @List_length T =>
    fun x : expr (list T) => Base (#(List_length)%expr @ x)%expr_pat
| List_seq => fun x x0 : expr ℕ => Base (#(List_seq)%expr @ x @ x0)%expr_pat
| @List_firstn A =>
    fun (x : expr ℕ) (x0 : expr (list A)) =>
    Base (#(List_firstn)%expr @ x @ x0)%expr_pat
| @List_skipn A =>
    fun (x : expr ℕ) (x0 : expr (list A)) =>
    Base (#(List_skipn)%expr @ x @ x0)%expr_pat
| @List_repeat A =>
    fun (x : expr A) (x0 : expr ℕ) =>
    Base (#(List_repeat)%expr @ x @ x0)%expr_pat
| @List_combine A B =>
    fun (x : expr (list A)) (x0 : expr (list B)) =>
    Base (#(List_combine)%expr @ x @ x0)%expr_pat
| @List_map A B =>
    fun (x : expr A -> UnderLets (expr B)) (x0 : expr (list A)) =>
    Base
      (#(List_map)%expr @ (λ x1 : var A,
                           to_expr (x ($x1)))%expr @ x0)%expr_pat
| @List_app A => fun x x0 : expr (list A) => Base (x ++ x0)%expr
| @List_rev A =>
    fun x : expr (list A) => Base (#(List_rev)%expr @ x)%expr_pat
| @List_flat_map A B =>
    fun (x : expr A -> UnderLets (expr (list B))) (x0 : expr (list A)) =>
    Base
      (#(List_flat_map)%expr @ (λ x1 : var A,
                                to_expr (x ($x1)))%expr @ x0)%expr_pat
| @List_partition A =>
    fun (x : expr A -> UnderLets (expr bool)) (x0 : expr (list A)) =>
    Base
      (#(List_partition)%expr @ (λ x1 : var A,
                                 to_expr (x ($x1)))%expr @ x0)%expr_pat
| @List_fold_right A B =>
    fun (x : expr B -> expr A -> UnderLets (expr A)) (x0 : expr A)
      (x1 : expr (list B)) =>
    Base
      (#(List_fold_right)%expr @
       (λ (x2 : var B)(x3 : var A),
        to_expr (x ($x2) ($x3)))%expr @ x0 @ x1)%expr_pat
| @List_update_nth T =>
    fun (x : expr ℕ) (x0 : expr T -> UnderLets (expr T)) (x1 : expr (list T))
    =>
    Base
      (#(List_update_nth)%expr @ x @ (λ x2 : var T,
                                      to_expr (x0 ($x2)))%expr @ x1)%expr_pat
| @List_nth_default T =>
    fun (x : expr T) (x0 : expr (list T)) (x1 : expr ℕ) =>
    Base (#(List_nth_default)%expr @ x @ x0 @ x1)%expr_pat
| Z_add => fun x x0 : expr ℤ => Base (x + x0)%expr
| Z_mul => fun x x0 : expr ℤ => Base (x * x0)%expr
| Z_pow => fun x x0 : expr ℤ => Base (#(Z_pow)%expr @ x @ x0)%expr_pat
| Z_sub => fun x x0 : expr ℤ => Base (x - x0)%expr
| Z_opp => fun x : expr ℤ => Base (- x)%expr
| Z_div => fun x x0 : expr ℤ => Base (x / x0)%expr
| Z_modulo => fun x x0 : expr ℤ => Base (x mod x0)%expr
| Z_log2 => fun x : expr ℤ => Base (#(Z_log2)%expr @ x)%expr_pat
| Z_log2_up => fun x : expr ℤ => Base (#(Z_log2_up)%expr @ x)%expr_pat
| Z_eqb => fun x x0 : expr ℤ => Base (#(Z_eqb)%expr @ x @ x0)%expr_pat
| Z_leb => fun x x0 : expr ℤ => Base (#(Z_leb)%expr @ x @ x0)%expr_pat
| Z_ltb => fun x x0 : expr ℤ => Base (#(Z_ltb)%expr @ x @ x0)%expr_pat
| Z_geb => fun x x0 : expr ℤ => Base (#(Z_geb)%expr @ x @ x0)%expr_pat
| Z_gtb => fun x x0 : expr ℤ => Base (#(Z_gtb)%expr @ x @ x0)%expr_pat
| Z_of_nat => fun x : expr ℕ => Base (#(Z_of_nat)%expr @ x)%expr_pat
| Z_to_nat => fun x : expr ℤ => Base (#(Z_to_nat)%expr @ x)%expr_pat
| Z_shiftr => fun x x0 : expr ℤ => Base (x >> x0)%expr
| Z_shiftl => fun x x0 : expr ℤ => Base (x << x0)%expr
| Z_land => fun x x0 : expr ℤ => Base (x &' x0)%expr
| Z_lor => fun x x0 : expr ℤ => Base (x || x0)%expr
| Z_min => fun x x0 : expr ℤ => Base (#(Z_min)%expr @ x @ x0)%expr_pat
| Z_max => fun x x0 : expr ℤ => Base (#(Z_max)%expr @ x @ x0)%expr_pat
| Z_bneg => fun x : expr ℤ => Base (#(Z_bneg)%expr @ x)%expr_pat
| Z_lnot_modulo =>
    fun x x0 : expr ℤ => Base (#(Z_lnot_modulo)%expr @ x @ x0)%expr_pat
| Z_mul_split =>
    fun x x0 x1 : expr ℤ => Base (#(Z_mul_split)%expr @ x @ x0 @ x1)%expr_pat
| Z_add_get_carry =>
    fun x x0 x1 : expr ℤ =>
    Base (#(Z_add_get_carry)%expr @ x @ x0 @ x1)%expr_pat
| Z_add_with_carry =>
    fun x x0 x1 : expr ℤ =>
    Base (#(Z_add_with_carry)%expr @ x @ x0 @ x1)%expr_pat
| Z_add_with_get_carry =>
    fun x x0 x1 x2 : expr ℤ =>
    Base (#(Z_add_with_get_carry)%expr @ x @ x0 @ x1 @ x2)%expr_pat
| Z_sub_get_borrow =>
    fun x x0 x1 : expr ℤ =>
    Base (#(Z_sub_get_borrow)%expr @ x @ x0 @ x1)%expr_pat
| Z_sub_with_get_borrow =>
    fun x x0 x1 x2 : expr ℤ =>
    Base (#(Z_sub_with_get_borrow)%expr @ x @ x0 @ x1 @ x2)%expr_pat
| Z_zselect =>
    fun x x0 x1 : expr ℤ => Base (#(Z_zselect)%expr @ x @ x0 @ x1)%expr_pat
| Z_add_modulo =>
    fun x x0 x1 : expr ℤ =>
    (match
       pattern.type.unify_extracted ((ℤ -> ℤ) -> ℤ)%ptype
         ((ℤ -> ℤ) -> ℤ)%ptype
     with
     | Datatypes.Some (_, _, _)%zrange =>
         if
          type.type_beq base.type base.type.type_beq ((ℤ -> ℤ) -> ℤ)%ptype
            ((ℤ -> ℤ) -> ℤ)%ptype
         then
          Datatypes.Some (Base (#(fancy_addm)%expr @ (x, x0, x1))%expr_pat)
         else Datatypes.None
     | Datatypes.None => Datatypes.None
     end;;;
     Base (#(Z_add_modulo)%expr @ x @ x0 @ x1)%expr_pat)%option
| Z_rshi =>
    fun x x0 x1 x2 : expr ℤ =>
    Base (#(Z_rshi)%expr @ x @ x0 @ x1 @ x2)%expr_pat
| Z_cc_m => fun x x0 : expr ℤ => Base (#(Z_cc_m)%expr @ x @ x0)%expr_pat
| Z_cast range =>
    fun x : expr ℤ =>
    ((match x with
      | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1)%expr_pat)
        (@expr.Ident _ _ _ t2 idc2 @ (@expr.Ident _ _ _ t3 idc3 @ x5 @ x4))%expr_pat =>
          match x5 with
          | @expr.App _ _ _ s5 _ (@expr.Ident _ _ _ t4 idc4) x6 =>
              match x4 with
              | @expr.App _ _ _ s6 _ (@expr.Ident _ _ _ t5 idc5) x7 =>
                  match x7 with
                  | @expr.Ident _ _ _ t6 idc6 =>
                      args <- invert_bind_args idc6 Raw.ident.Literal;
                      args0 <- invert_bind_args idc5 Raw.ident.Z_cast;
                      args1 <- invert_bind_args idc4 Raw.ident.Z_cast;
                      _ <- invert_bind_args idc3 Raw.ident.Z_land;
                      args3 <- invert_bind_args idc2 Raw.ident.Z_cast;
                      args4 <- invert_bind_args idc1 Raw.ident.Literal;
                      args5 <- invert_bind_args idc0 Raw.ident.Z_cast;
                      _ <- invert_bind_args idc Raw.ident.Z_mul;
                      match
                        pattern.type.unify_extracted (ℤ -> ℤ -> ℤ)%ptype
                          ((projT1 args4) -> s5 -> (projT1 args))%ptype
                      with
                      | Datatypes.Some (_, (_, _))%zrange =>
                          if
                           type.type_beq base.type base.type.type_beq
                             (ℤ -> ℤ -> ℤ)%ptype
                             ((projT1 args4) -> s5 -> (projT1 args))%ptype
                          then
                           xv <- ident.unify pattern.ident.Literal
                                   ##(projT2 args4);
                           v <- type.try_make_transport_cps s5 ℤ;
                           xv0 <- ident.unify pattern.ident.Literal
                                    ##(projT2 args);
                           fv <- (x8 <- (if
                                          ((let (x8, _) := xv0 in x8) =?
                                           2
                                           ^ (2 *
                                              Z.log2_up
                                                (let (x8, _) := xv0 in x8) /
                                              2) - 1) &&
                                          (ZRange.normalize args1 &'
                                           ZRange.normalize
                                             (ZRange.constant
                                                (let (x8, _) := xv0 in x8)) <=?
                                           ZRange.normalize args3)%zrange &&
                                          is_bounded_by_bool
                                            (let (x8, _) := xv in x8)
                                            (ZRange.normalize args5) &&
                                          is_bounded_by_bool
                                            (let (x8, _) := xv0 in x8)
                                            (ZRange.normalize args0)
                                         then
                                          x8 <- invert_low
                                                  (2 *
                                                   Z.log2_up
                                                     (let (x8, _) := xv0 in
                                                      x8))
                                                  (let (x8, _) := xv in x8);
                                          Datatypes.Some
                                            (#(Z_cast range)%expr @
                                             (#(fancy_mulll
                                                  (2 *
                                                   Z.log2_up
                                                     (let (x9, _) := xv0 in
                                                      x9)))%expr @
                                              ((##x8)%expr,
                                              #(Z_cast args1)%expr @
                                              v (Compile.reflect x6))))%expr_pat
                                         else Datatypes.None);
                                  Datatypes.Some (Base x8));
                           Datatypes.Some (fv0 <-- fv;
                                           Base fv0)%under_lets
                          else Datatypes.None
                      | Datatypes.None => Datatypes.None
                      end
                  | _ => Datatypes.None
                  end;;
                  match x6 with
                  | @expr.Ident _ _ _ t6 idc6 =>
                      (args <- invert_bind_args idc6 Raw.ident.Literal;
                       args0 <- invert_bind_args idc5 Raw.ident.Z_cast;
                       args1 <- invert_bind_args idc4 Raw.ident.Z_cast;
                       _ <- invert_bind_args idc3 Raw.ident.Z_land;
                       args3 <- invert_bind_args idc2 Raw.ident.Z_cast;
                       args4 <- invert_bind_args idc1 Raw.ident.Literal;
                       args5 <- invert_bind_args idc0 Raw.ident.Z_cast;
                       _ <- invert_bind_args idc Raw.ident.Z_mul;
                       match
                         pattern.type.unify_extracted (ℤ -> ℤ -> ℤ)%ptype
                           ((projT1 args4) -> (projT1 args) -> s6)%ptype
                       with
                       | Datatypes.Some (_, (_, _))%zrange =>
                           if
                            type.type_beq base.type base.type.type_beq
                              (ℤ -> ℤ -> ℤ)%ptype
                              ((projT1 args4) -> (projT1 args) -> s6)%ptype
                           then
                            xv <- ident.unify pattern.ident.Literal
                                    ##(projT2 args4);
                            xv0 <- ident.unify pattern.ident.Literal
                                     ##(projT2 args);
                            v <- type.try_make_transport_cps s6 ℤ;
                            fv <- (x8 <- (if
                                           ((let (x8, _) := xv0 in x8) =?
                                            2
                                            ^ (2 *
                                               Z.log2_up
                                                 (let (x8, _) := xv0 in x8) /
                                               2) - 1) &&
                                           (ZRange.normalize
                                              (ZRange.constant
                                                 (let (x8, _) := xv0 in x8)) &'
                                            ZRange.normalize args0 <=?
                                            ZRange.normalize args3)%zrange &&
                                           is_bounded_by_bool
                                             (let (x8, _) := xv in x8)
                                             (ZRange.normalize args5) &&
                                           is_bounded_by_bool
                                             (let (x8, _) := xv0 in x8)
                                             (ZRange.normalize args1)
                                          then
                                           x8 <- invert_low
                                                   (2 *
                                                    Z.log2_up
                                                      (let (x8, _) := xv0 in
                                                       x8))
                                                   (let (x8, _) := xv in x8);
                                           Datatypes.Some
                                             (#(Z_cast range)%expr @
                                              (#(fancy_mulll
                                                   (2 *
                                                    Z.log2_up
                                                      (let (x9, _) := xv0 in
                                                       x9)))%expr @
                                               ((##x8)%expr,
                                               #(Z_cast args0)%expr @
                                               v (Compile.reflect x7))))%expr_pat
                                          else Datatypes.None);
                                   Datatypes.Some (Base x8));
                            Datatypes.Some (fv0 <-- fv;
                                            Base fv0)%under_lets
                           else Datatypes.None
                       | Datatypes.None => Datatypes.None
                       end);;
                      args <- invert_bind_args idc6 Raw.ident.Literal;
                      args0 <- invert_bind_args idc5 Raw.ident.Z_cast;
                      args1 <- invert_bind_args idc4 Raw.ident.Z_cast;
                      _ <- invert_bind_args idc3 Raw.ident.Z_land;
                      args3 <- invert_bind_args idc2 Raw.ident.Z_cast;
                      args4 <- invert_bind_args idc1 Raw.ident.Literal;
                      args5 <- invert_bind_args idc0 Raw.ident.Z_cast;
                      _ <- invert_bind_args idc Raw.ident.Z_mul;
                      match
                        pattern.type.unify_extracted (ℤ -> ℤ -> ℤ)%ptype
                          ((projT1 args4) -> (projT1 args) -> s6)%ptype
                      with
                      | Datatypes.Some (_, (_, _))%zrange =>
                          if
                           type.type_beq base.type base.type.type_beq
                             (ℤ -> ℤ -> ℤ)%ptype
                             ((projT1 args4) -> (projT1 args) -> s6)%ptype
                          then
                           xv <- ident.unify pattern.ident.Literal
                                   ##(projT2 args4);
                           xv0 <- ident.unify pattern.ident.Literal
                                    ##(projT2 args);
                           v <- type.try_make_transport_cps s6 ℤ;
                           fv <- (x8 <- (if
                                          ((let (x8, _) := xv0 in x8) =?
                                           2
                                           ^ (2 *
                                              Z.log2_up
                                                (let (x8, _) := xv0 in x8) /
                                              2) - 1) &&
                                          (ZRange.normalize
                                             (ZRange.constant
                                                (let (x8, _) := xv0 in x8)) &'
                                           ZRange.normalize args0 <=?
                                           ZRange.normalize args3)%zrange &&
                                          is_bounded_by_bool
                                            (let (x8, _) := xv in x8)
                                            (ZRange.normalize args5) &&
                                          is_bounded_by_bool
                                            (let (x8, _) := xv0 in x8)
                                            (ZRange.normalize args1)
                                         then
                                          x8 <- invert_high
                                                  (2 *
                                                   Z.log2_up
                                                     (let (x8, _) := xv0 in
                                                      x8))
                                                  (let (x8, _) := xv in x8);
                                          Datatypes.Some
                                            (#(Z_cast range)%expr @
                                             (#(fancy_mulhl
                                                  (2 *
                                                   Z.log2_up
                                                     (let (x9, _) := xv0 in
                                                      x9)))%expr @
                                              ((##x8)%expr,
                                              #(Z_cast args0)%expr @
                                              v (Compile.reflect x7))))%expr_pat
                                         else Datatypes.None);
                                  Datatypes.Some (Base x8));
                           Datatypes.Some (fv0 <-- fv;
                                           Base fv0)%under_lets
                          else Datatypes.None
                      | Datatypes.None => Datatypes.None
                      end
                  | _ => Datatypes.None
                  end;;
                  match x7 with
                  | @expr.Ident _ _ _ t6 idc6 =>
                      args <- invert_bind_args idc6 Raw.ident.Literal;
                      args0 <- invert_bind_args idc5 Raw.ident.Z_cast;
                      args1 <- invert_bind_args idc4 Raw.ident.Z_cast;
                      _ <- invert_bind_args idc3 Raw.ident.Z_land;
                      args3 <- invert_bind_args idc2 Raw.ident.Z_cast;
                      args4 <- invert_bind_args idc1 Raw.ident.Literal;
                      args5 <- invert_bind_args idc0 Raw.ident.Z_cast;
                      _ <- invert_bind_args idc Raw.ident.Z_mul;
                      match
                        pattern.type.unify_extracted (ℤ -> ℤ -> ℤ)%ptype
                          ((projT1 args4) -> s5 -> (projT1 args))%ptype
                      with
                      | Datatypes.Some (_, (_, _))%zrange =>
                          if
                           type.type_beq base.type base.type.type_beq
                             (ℤ -> ℤ -> ℤ)%ptype
                             ((projT1 args4) -> s5 -> (projT1 args))%ptype
                          then
                           xv <- ident.unify pattern.ident.Literal
                                   ##(projT2 args4);
                           v <- type.try_make_transport_cps s5 ℤ;
                           xv0 <- ident.unify pattern.ident.Literal
                                    ##(projT2 args);
                           fv <- (x8 <- (if
                                          ((let (x8, _) := xv0 in x8) =?
                                           2
                                           ^ (2 *
                                              Z.log2_up
                                                (let (x8, _) := xv0 in x8) /
                                              2) - 1) &&
                                          (ZRange.normalize args1 &'
                                           ZRange.normalize
                                             (ZRange.constant
                                                (let (x8, _) := xv0 in x8)) <=?
                                           ZRange.normalize args3)%zrange &&
                                          is_bounded_by_bool
                                            (let (x8, _) := xv in x8)
                                            (ZRange.normalize args5) &&
                                          is_bounded_by_bool
                                            (let (x8, _) := xv0 in x8)
                                            (ZRange.normalize args0)
                                         then
                                          x8 <- invert_high
                                                  (2 *
                                                   Z.log2_up
                                                     (let (x8, _) := xv0 in
                                                      x8))
                                                  (let (x8, _) := xv in x8);
                                          Datatypes.Some
                                            (#(Z_cast range)%expr @
                                             (#(fancy_mulhl
                                                  (2 *
                                                   Z.log2_up
                                                     (let (x9, _) := xv0 in
                                                      x9)))%expr @
                                              ((##x8)%expr,
                                              #(Z_cast args1)%expr @
                                              v (Compile.reflect x6))))%expr_pat
                                         else Datatypes.None);
                                  Datatypes.Some (Base x8));
                           Datatypes.Some (fv0 <-- fv;
                                           Base fv0)%under_lets
                          else Datatypes.None
                      | Datatypes.None => Datatypes.None
                      end
                  | _ => Datatypes.None
                  end
              | @expr.App _ _ _ s6 _ ($_)%expr _ | @expr.App _ _ _ s6 _
                (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _ _ s6 _
                (_ @ _)%expr_pat _ | @expr.App _ _ _ s6 _
                (@expr.LetIn _ _ _ _ _ _ _) _ => Datatypes.None
              | _ => Datatypes.None
              end
          | @expr.App _ _ _ s5 _ ($_)%expr _ | @expr.App _ _ _ s5 _
            (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _ _ s5 _ (_ @ _)%expr_pat
            _ | @expr.App _ _ _ s5 _ (@expr.LetIn _ _ _ _ _ _ _) _ =>
              Datatypes.None
          | _ => Datatypes.None
          end;;
          match x5 with
          | @expr.App _ _ _ s5 _ (@expr.Ident _ _ _ t4 idc4) x6 =>
              match x4 with
              | (@expr.Ident _ _ _ t5 idc5 @ @expr.Ident _ _ _ t6 idc6)%expr_pat =>
                  (args <- invert_bind_args idc6 Raw.ident.Literal;
                   args0 <- invert_bind_args idc5 Raw.ident.Z_cast;
                   args1 <- invert_bind_args idc4 Raw.ident.Z_cast;
                   _ <- invert_bind_args idc3 Raw.ident.Z_shiftr;
                   args3 <- invert_bind_args idc2 Raw.ident.Z_cast;
                   args4 <- invert_bind_args idc1 Raw.ident.Literal;
                   args5 <- invert_bind_args idc0 Raw.ident.Z_cast;
                   _ <- invert_bind_args idc Raw.ident.Z_mul;
                   match
                     pattern.type.unify_extracted (ℤ -> ℤ -> ℤ)%ptype
                       ((projT1 args4) -> s5 -> (projT1 args))%ptype
                   with
                   | Datatypes.Some (_, (_, _))%zrange =>
                       if
                        type.type_beq base.type base.type.type_beq
                          (ℤ -> ℤ -> ℤ)%ptype
                          ((projT1 args4) -> s5 -> (projT1 args))%ptype
                       then
                        xv <- ident.unify pattern.ident.Literal
                                ##(projT2 args4);
                        v <- type.try_make_transport_cps s5 ℤ;
                        xv0 <- ident.unify pattern.ident.Literal
                                 ##(projT2 args);
                        fv <- (x8 <- (if
                                       (ZRange.normalize args1 >>
                                        ZRange.normalize
                                          (ZRange.constant
                                             (let (x8, _) := xv0 in x8)) <=?
                                        ZRange.normalize args3)%zrange &&
                                       is_bounded_by_bool
                                         (let (x8, _) := xv in x8)
                                         (ZRange.normalize args5) &&
                                       is_bounded_by_bool
                                         (let (x8, _) := xv0 in x8)
                                         (ZRange.normalize args0)
                                      then
                                       x8 <- invert_low
                                               (2 *
                                                (let (x8, _) := xv0 in x8))
                                               (let (x8, _) := xv in x8);
                                       Datatypes.Some
                                         (#(Z_cast range)%expr @
                                          (#(fancy_mullh
                                               (2 *
                                                (let (x9, _) := xv0 in x9)))%expr @
                                           ((##x8)%expr,
                                           #(Z_cast args1)%expr @
                                           v (Compile.reflect x6))))%expr_pat
                                      else Datatypes.None);
                               Datatypes.Some (Base x8));
                        Datatypes.Some (fv0 <-- fv;
                                        Base fv0)%under_lets
                       else Datatypes.None
                   | Datatypes.None => Datatypes.None
                   end);;
                  args <- invert_bind_args idc6 Raw.ident.Literal;
                  args0 <- invert_bind_args idc5 Raw.ident.Z_cast;
                  args1 <- invert_bind_args idc4 Raw.ident.Z_cast;
                  _ <- invert_bind_args idc3 Raw.ident.Z_shiftr;
                  args3 <- invert_bind_args idc2 Raw.ident.Z_cast;
                  args4 <- invert_bind_args idc1 Raw.ident.Literal;
                  args5 <- invert_bind_args idc0 Raw.ident.Z_cast;
                  _ <- invert_bind_args idc Raw.ident.Z_mul;
                  match
                    pattern.type.unify_extracted (ℤ -> ℤ -> ℤ)%ptype
                      ((projT1 args4) -> s5 -> (projT1 args))%ptype
                  with
                  | Datatypes.Some (_, (_, _))%zrange =>
                      if
                       type.type_beq base.type base.type.type_beq
                         (ℤ -> ℤ -> ℤ)%ptype
                         ((projT1 args4) -> s5 -> (projT1 args))%ptype
                      then
                       xv <- ident.unify pattern.ident.Literal
                               ##(projT2 args4);
                       v <- type.try_make_transport_cps s5 ℤ;
                       xv0 <- ident.unify pattern.ident.Literal
                                ##(projT2 args);
                       fv <- (x8 <- (if
                                      (ZRange.normalize args1 >>
                                       ZRange.normalize
                                         (ZRange.constant
                                            (let (x8, _) := xv0 in x8)) <=?
                                       ZRange.normalize args3)%zrange &&
                                      is_bounded_by_bool
                                        (let (x8, _) := xv in x8)
                                        (ZRange.normalize args5) &&
                                      is_bounded_by_bool
                                        (let (x8, _) := xv0 in x8)
                                        (ZRange.normalize args0)
                                     then
                                      x8 <- invert_high
                                              (2 * (let (x8, _) := xv0 in x8))
                                              (let (x8, _) := xv in x8);
                                      Datatypes.Some
                                        (#(Z_cast range)%expr @
                                         (#(fancy_mulhh
                                              (2 * (let (x9, _) := xv0 in x9)))%expr @
                                          ((##x8)%expr,
                                          #(Z_cast args1)%expr @
                                          v (Compile.reflect x6))))%expr_pat
                                     else Datatypes.None);
                              Datatypes.Some (Base x8));
                       Datatypes.Some (fv0 <-- fv;
                                       Base fv0)%under_lets
                      else Datatypes.None
                  | Datatypes.None => Datatypes.None
                  end
              | (@expr.Ident _ _ _ t5 idc5 @ ($_)%expr)%expr_pat |
                (@expr.Ident _ _ _ t5 idc5 @ @expr.Abs _ _ _ _ _ _)%expr_pat |
                (@expr.Ident _ _ _ t5 idc5 @ (_ @ _))%expr_pat |
                (@expr.Ident _ _ _ t5 idc5 @ @expr.LetIn _ _ _ _ _ _ _)%expr_pat =>
                  Datatypes.None
              | _ => Datatypes.None
              end
          | @expr.App _ _ _ s5 _ ($_)%expr _ | @expr.App _ _ _ s5 _
            (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _ _ s5 _ (_ @ _)%expr_pat
            _ | @expr.App _ _ _ s5 _ (@expr.LetIn _ _ _ _ _ _ _) _ =>
              Datatypes.None
          | _ => Datatypes.None
          end
      | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1)%expr_pat)
        (@expr.Ident _ _ _ t2 idc2 @ #(_))%expr_pat | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1)%expr_pat)
        (@expr.Ident _ _ _ t2 idc2 @ ($_)%expr)%expr_pat | @expr.App _ _ _ s
        _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1)%expr_pat)
        (@expr.Ident _ _ _ t2 idc2 @ @expr.Abs _ _ _ _ _ _)%expr_pat |
        @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1)%expr_pat)
        (@expr.Ident _ _ _ t2 idc2 @ (#(_) @ _))%expr_pat | @expr.App _ _ _ s
        _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1)%expr_pat)
        (@expr.Ident _ _ _ t2 idc2 @ (($_)%expr @ _))%expr_pat | @expr.App _
        _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1)%expr_pat)
        (@expr.Ident _ _ _ t2 idc2 @ (@expr.Abs _ _ _ _ _ _ @ _))%expr_pat |
        @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1)%expr_pat)
        (@expr.Ident _ _ _ t2 idc2 @ (($_)%expr @ _ @ _))%expr_pat |
        @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1)%expr_pat)
        (@expr.Ident _ _ _ t2 idc2 @ (@expr.Abs _ _ _ _ _ _ @ _ @ _))%expr_pat |
        @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1)%expr_pat)
        (@expr.Ident _ _ _ t2 idc2 @ (_ @ _ @ _ @ _))%expr_pat | @expr.App _
        _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1)%expr_pat)
        (@expr.Ident _ _ _ t2 idc2 @ (@expr.LetIn _ _ _ _ _ _ _ @ _ @ _))%expr_pat |
        @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1)%expr_pat)
        (@expr.Ident _ _ _ t2 idc2 @ (@expr.LetIn _ _ _ _ _ _ _ @ _))%expr_pat |
        @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1)%expr_pat)
        (@expr.Ident _ _ _ t2 idc2 @ @expr.LetIn _ _ _ _ _ _ _)%expr_pat =>
          Datatypes.None
      | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1)%expr_pat)
        #(_)%expr_pat | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1)%expr_pat)
        ($_)%expr | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1)%expr_pat)
        (@expr.Abs _ _ _ _ _ _) | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1)%expr_pat)
        (($_)%expr @ _)%expr_pat | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1)%expr_pat)
        (@expr.Abs _ _ _ _ _ _ @ _)%expr_pat | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1)%expr_pat)
        (_ @ _ @ _)%expr_pat | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1)%expr_pat)
        (@expr.LetIn _ _ _ _ _ _ _ @ _)%expr_pat | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1)%expr_pat)
        (@expr.LetIn _ _ _ _ _ _ _) => Datatypes.None
      | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ (@expr.Ident _ _ _ t1 idc1 @ x4 @ x3))%expr_pat)
        x0 =>
          match x4 with
          | @expr.App _ _ _ s4 _ (@expr.Ident _ _ _ t2 idc2) x5 =>
              match x5 with
              | @expr.Ident _ _ _ t3 idc3 =>
                  match x3 with
                  | @expr.App _ _ _ s5 _ (@expr.Ident _ _ _ t4 idc4) x6 =>
                      match x0 with
                      | (@expr.Ident _ _ _ t5 idc5 @ @expr.Ident _ _ _ t6
                         idc6)%expr_pat =>
                          args <- invert_bind_args idc6 Raw.ident.Literal;
                          args0 <- invert_bind_args idc5 Raw.ident.Z_cast;
                          args1 <- invert_bind_args idc4 Raw.ident.Z_cast;
                          args2 <- invert_bind_args idc3 Raw.ident.Literal;
                          args3 <- invert_bind_args idc2 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc1 Raw.ident.Z_land;
                          args5 <- invert_bind_args idc0 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc Raw.ident.Z_mul;
                          match
                            pattern.type.unify_extracted
                              ((ℤ -> ℤ) -> ℤ)%ptype
                              (((projT1 args2) -> s5) -> (projT1 args))%ptype
                          with
                          | Datatypes.Some (_, _, _)%zrange =>
                              if
                               type.type_beq base.type base.type.type_beq
                                 ((ℤ -> ℤ) -> ℤ)%ptype
                                 (((projT1 args2) -> s5) -> (projT1 args))%ptype
                              then
                               xv <- ident.unify pattern.ident.Literal
                                       ##(projT2 args2);
                               v <- type.try_make_transport_cps s5 ℤ;
                               xv0 <- ident.unify pattern.ident.Literal
                                        ##(projT2 args);
                               fv <- (x8 <- (if
                                              ((let (x8, _) := xv in x8) =?
                                               2
                                               ^ (2 *
                                                  Z.log2_up
                                                    (let (x8, _) := xv in x8) /
                                                  2) - 1) &&
                                              (ZRange.normalize
                                                 (ZRange.constant
                                                    (let (x8, _) := xv in x8)) &'
                                               ZRange.normalize args1 <=?
                                               ZRange.normalize args5)%zrange &&
                                              is_bounded_by_bool
                                                (let (x8, _) := xv0 in x8)
                                                (ZRange.normalize args0) &&
                                              is_bounded_by_bool
                                                (let (x8, _) := xv in x8)
                                                (ZRange.normalize args3)
                                             then
                                              y <- invert_low
                                                     (2 *
                                                      Z.log2_up
                                                        (let (x8, _) := xv in
                                                         x8))
                                                     (let (x8, _) := xv0 in
                                                      x8);
                                              Datatypes.Some
                                                (#(Z_cast range)%expr @
                                                 (#(fancy_mulll
                                                      (2 *
                                                       Z.log2_up
                                                         (let (x8, _) :=
                                                            xv in
                                                          x8)))%expr @
                                                  (#(Z_cast args1)%expr @
                                                   v (Compile.reflect x6),
                                                  (##y)%expr)))%expr_pat
                                             else Datatypes.None);
                                      Datatypes.Some (Base x8));
                               Datatypes.Some
                                 (fv0 <-- fv;
                                  Base fv0)%under_lets
                              else Datatypes.None
                          | Datatypes.None => Datatypes.None
                          end
                      | (@expr.Ident _ _ _ t5 idc5 @ ($_)%expr)%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ @expr.Abs _ _ _ _ _ _)%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (_ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ @expr.LetIn _ _ _ _ _ _
                         _)%expr_pat => Datatypes.None
                      | _ => Datatypes.None
                      end
                  | @expr.App _ _ _ s5 _ ($_)%expr _ | @expr.App _ _ _ s5 _
                    (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _ _ s5 _
                    (_ @ _)%expr_pat _ | @expr.App _ _ _ s5 _
                    (@expr.LetIn _ _ _ _ _ _ _) _ => Datatypes.None
                  | _ => Datatypes.None
                  end
              | _ => Datatypes.None
              end;;
              match x3 with
              | @expr.App _ _ _ s5 _ (@expr.Ident _ _ _ t3 idc3) x6 =>
                  match x6 with
                  | @expr.Ident _ _ _ t4 idc4 =>
                      match x0 with
                      | (@expr.Ident _ _ _ t5 idc5 @ @expr.Ident _ _ _ t6
                         idc6)%expr_pat =>
                          args <- invert_bind_args idc6 Raw.ident.Literal;
                          args0 <- invert_bind_args idc5 Raw.ident.Z_cast;
                          args1 <- invert_bind_args idc4 Raw.ident.Literal;
                          args2 <- invert_bind_args idc3 Raw.ident.Z_cast;
                          args3 <- invert_bind_args idc2 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc1 Raw.ident.Z_land;
                          args5 <- invert_bind_args idc0 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc Raw.ident.Z_mul;
                          match
                            pattern.type.unify_extracted
                              ((ℤ -> ℤ) -> ℤ)%ptype
                              ((s4 -> (projT1 args1)) -> (projT1 args))%ptype
                          with
                          | Datatypes.Some (_, _, _)%zrange =>
                              if
                               type.type_beq base.type base.type.type_beq
                                 ((ℤ -> ℤ) -> ℤ)%ptype
                                 ((s4 -> (projT1 args1)) -> (projT1 args))%ptype
                              then
                               v <- type.try_make_transport_cps s4 ℤ;
                               xv <- ident.unify pattern.ident.Literal
                                       ##(projT2 args1);
                               xv0 <- ident.unify pattern.ident.Literal
                                        ##(projT2 args);
                               fv <- (x8 <- (if
                                              ((let (x8, _) := xv in x8) =?
                                               2
                                               ^ (2 *
                                                  Z.log2_up
                                                    (let (x8, _) := xv in x8) /
                                                  2) - 1) &&
                                              (ZRange.normalize args3 &'
                                               ZRange.normalize
                                                 (ZRange.constant
                                                    (let (x8, _) := xv in x8)) <=?
                                               ZRange.normalize args5)%zrange &&
                                              is_bounded_by_bool
                                                (let (x8, _) := xv0 in x8)
                                                (ZRange.normalize args0) &&
                                              is_bounded_by_bool
                                                (let (x8, _) := xv in x8)
                                                (ZRange.normalize args2)
                                             then
                                              y <- invert_low
                                                     (2 *
                                                      Z.log2_up
                                                        (let (x8, _) := xv in
                                                         x8))
                                                     (let (x8, _) := xv0 in
                                                      x8);
                                              Datatypes.Some
                                                (#(Z_cast range)%expr @
                                                 (#(fancy_mulll
                                                      (2 *
                                                       Z.log2_up
                                                         (let (x8, _) :=
                                                            xv in
                                                          x8)))%expr @
                                                  (#(Z_cast args3)%expr @
                                                   v (Compile.reflect x5),
                                                  (##y)%expr)))%expr_pat
                                             else Datatypes.None);
                                      Datatypes.Some (Base x8));
                               Datatypes.Some
                                 (fv0 <-- fv;
                                  Base fv0)%under_lets
                              else Datatypes.None
                          | Datatypes.None => Datatypes.None
                          end
                      | (@expr.Ident _ _ _ t5 idc5 @ ($_)%expr)%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ @expr.Abs _ _ _ _ _ _)%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (_ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ @expr.LetIn _ _ _ _ _ _
                         _)%expr_pat => Datatypes.None
                      | _ => Datatypes.None
                      end
                  | _ => Datatypes.None
                  end;;
                  match x5 with
                  | @expr.Ident _ _ _ t4 idc4 =>
                      match x0 with
                      | (@expr.Ident _ _ _ t5 idc5 @ @expr.Ident _ _ _ t6
                         idc6)%expr_pat =>
                          args <- invert_bind_args idc6 Raw.ident.Literal;
                          args0 <- invert_bind_args idc5 Raw.ident.Z_cast;
                          args1 <- invert_bind_args idc4 Raw.ident.Literal;
                          args2 <- invert_bind_args idc3 Raw.ident.Z_cast;
                          args3 <- invert_bind_args idc2 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc1 Raw.ident.Z_land;
                          args5 <- invert_bind_args idc0 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc Raw.ident.Z_mul;
                          match
                            pattern.type.unify_extracted
                              ((ℤ -> ℤ) -> ℤ)%ptype
                              (((projT1 args1) -> s5) -> (projT1 args))%ptype
                          with
                          | Datatypes.Some (_, _, _)%zrange =>
                              if
                               type.type_beq base.type base.type.type_beq
                                 ((ℤ -> ℤ) -> ℤ)%ptype
                                 (((projT1 args1) -> s5) -> (projT1 args))%ptype
                              then
                               xv <- ident.unify pattern.ident.Literal
                                       ##(projT2 args1);
                               v <- type.try_make_transport_cps s5 ℤ;
                               xv0 <- ident.unify pattern.ident.Literal
                                        ##(projT2 args);
                               fv <- (x8 <- (if
                                              ((let (x8, _) := xv in x8) =?
                                               2
                                               ^ (2 *
                                                  Z.log2_up
                                                    (let (x8, _) := xv in x8) /
                                                  2) - 1) &&
                                              (ZRange.normalize
                                                 (ZRange.constant
                                                    (let (x8, _) := xv in x8)) &'
                                               ZRange.normalize args2 <=?
                                               ZRange.normalize args5)%zrange &&
                                              is_bounded_by_bool
                                                (let (x8, _) := xv0 in x8)
                                                (ZRange.normalize args0) &&
                                              is_bounded_by_bool
                                                (let (x8, _) := xv in x8)
                                                (ZRange.normalize args3)
                                             then
                                              y <- invert_high
                                                     (2 *
                                                      Z.log2_up
                                                        (let (x8, _) := xv in
                                                         x8))
                                                     (let (x8, _) := xv0 in
                                                      x8);
                                              Datatypes.Some
                                                (#(Z_cast range)%expr @
                                                 (#(fancy_mullh
                                                      (2 *
                                                       Z.log2_up
                                                         (let (x8, _) :=
                                                            xv in
                                                          x8)))%expr @
                                                  (#(Z_cast args2)%expr @
                                                   v (Compile.reflect x6),
                                                  (##y)%expr)))%expr_pat
                                             else Datatypes.None);
                                      Datatypes.Some (Base x8));
                               Datatypes.Some
                                 (fv0 <-- fv;
                                  Base fv0)%under_lets
                              else Datatypes.None
                          | Datatypes.None => Datatypes.None
                          end
                      | (@expr.Ident _ _ _ t5 idc5 @ ($_)%expr)%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ @expr.Abs _ _ _ _ _ _)%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (_ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ @expr.LetIn _ _ _ _ _ _
                         _)%expr_pat => Datatypes.None
                      | _ => Datatypes.None
                      end
                  | _ => Datatypes.None
                  end;;
                  match x6 with
                  | @expr.Ident _ _ _ t4 idc4 =>
                      match x0 with
                      | (@expr.Ident _ _ _ t5 idc5 @ @expr.Ident _ _ _ t6
                         idc6)%expr_pat =>
                          args <- invert_bind_args idc6 Raw.ident.Literal;
                          args0 <- invert_bind_args idc5 Raw.ident.Z_cast;
                          args1 <- invert_bind_args idc4 Raw.ident.Literal;
                          args2 <- invert_bind_args idc3 Raw.ident.Z_cast;
                          args3 <- invert_bind_args idc2 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc1 Raw.ident.Z_land;
                          args5 <- invert_bind_args idc0 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc Raw.ident.Z_mul;
                          match
                            pattern.type.unify_extracted
                              ((ℤ -> ℤ) -> ℤ)%ptype
                              ((s4 -> (projT1 args1)) -> (projT1 args))%ptype
                          with
                          | Datatypes.Some (_, _, _)%zrange =>
                              if
                               type.type_beq base.type base.type.type_beq
                                 ((ℤ -> ℤ) -> ℤ)%ptype
                                 ((s4 -> (projT1 args1)) -> (projT1 args))%ptype
                              then
                               v <- type.try_make_transport_cps s4 ℤ;
                               xv <- ident.unify pattern.ident.Literal
                                       ##(projT2 args1);
                               xv0 <- ident.unify pattern.ident.Literal
                                        ##(projT2 args);
                               fv <- (x8 <- (if
                                              ((let (x8, _) := xv in x8) =?
                                               2
                                               ^ (2 *
                                                  Z.log2_up
                                                    (let (x8, _) := xv in x8) /
                                                  2) - 1) &&
                                              (ZRange.normalize args3 &'
                                               ZRange.normalize
                                                 (ZRange.constant
                                                    (let (x8, _) := xv in x8)) <=?
                                               ZRange.normalize args5)%zrange &&
                                              is_bounded_by_bool
                                                (let (x8, _) := xv0 in x8)
                                                (ZRange.normalize args0) &&
                                              is_bounded_by_bool
                                                (let (x8, _) := xv in x8)
                                                (ZRange.normalize args2)
                                             then
                                              y <- invert_high
                                                     (2 *
                                                      Z.log2_up
                                                        (let (x8, _) := xv in
                                                         x8))
                                                     (let (x8, _) := xv0 in
                                                      x8);
                                              Datatypes.Some
                                                (#(Z_cast range)%expr @
                                                 (#(fancy_mullh
                                                      (2 *
                                                       Z.log2_up
                                                         (let (x8, _) :=
                                                            xv in
                                                          x8)))%expr @
                                                  (#(Z_cast args3)%expr @
                                                   v (Compile.reflect x5),
                                                  (##y)%expr)))%expr_pat
                                             else Datatypes.None);
                                      Datatypes.Some (Base x8));
                               Datatypes.Some
                                 (fv0 <-- fv;
                                  Base fv0)%under_lets
                              else Datatypes.None
                          | Datatypes.None => Datatypes.None
                          end
                      | (@expr.Ident _ _ _ t5 idc5 @ ($_)%expr)%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ @expr.Abs _ _ _ _ _ _)%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (_ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ @expr.LetIn _ _ _ _ _ _
                         _)%expr_pat => Datatypes.None
                      | _ => Datatypes.None
                      end
                  | _ => Datatypes.None
                  end;;
                  match x5 with
                  | @expr.Ident _ _ _ t4 idc4 =>
                      match x0 with
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Ident _ _ _ t7 idc7 @ @expr.Ident _ _ _ t8
                           idc8) @ @expr.App _ _ _ s10 _
                          (@expr.Ident _ _ _ t9 idc9) x11))%expr_pat =>
                          args <- invert_bind_args idc9 Raw.ident.Z_cast;
                          args0 <- invert_bind_args idc8 Raw.ident.Literal;
                          args1 <- invert_bind_args idc7 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc6 Raw.ident.Z_land;
                          args3 <- invert_bind_args idc5 Raw.ident.Z_cast;
                          args4 <- invert_bind_args idc4 Raw.ident.Literal;
                          args5 <- invert_bind_args idc3 Raw.ident.Z_cast;
                          args6 <- invert_bind_args idc2 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc1 Raw.ident.Z_land;
                          args8 <- invert_bind_args idc0 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc Raw.ident.Z_mul;
                          match
                            pattern.type.unify_extracted
                              ((ℤ -> ℤ) -> ℤ -> ℤ)%ptype
                              (((projT1 args4) -> s5) ->
                               (projT1 args0) -> s10)%ptype
                          with
                          | Datatypes.Some (_, _, (_, _))%zrange =>
                              if
                               type.type_beq base.type base.type.type_beq
                                 ((ℤ -> ℤ) -> ℤ -> ℤ)%ptype
                                 (((projT1 args4) -> s5) ->
                                  (projT1 args0) -> s10)%ptype
                              then
                               xv <- ident.unify pattern.ident.Literal
                                       ##(projT2 args4);
                               v <- type.try_make_transport_cps s5 ℤ;
                               xv0 <- ident.unify pattern.ident.Literal
                                        ##(projT2 args0);
                               v0 <- type.try_make_transport_cps s10 ℤ;
                               fv <- (x12 <- (if
                                               ((let (x12, _) := xv in x12) =?
                                                2
                                                ^ (2 *
                                                   Z.log2_up
                                                     (let (x12, _) := xv in
                                                      x12) / 2) - 1) &&
                                               ((let (x12, _) := xv0 in x12) =?
                                                2
                                                ^ (2 *
                                                   Z.log2_up
                                                     (let (x12, _) := xv in
                                                      x12) / 2) - 1) &&
                                               (ZRange.normalize
                                                  (ZRange.constant
                                                     (let (x12, _) := xv in
                                                      x12)) &'
                                                ZRange.normalize args5 <=?
                                                ZRange.normalize args8)%zrange &&
                                               (ZRange.normalize
                                                  (ZRange.constant
                                                     (let (x12, _) := xv0 in
                                                      x12)) &'
                                                ZRange.normalize args <=?
                                                ZRange.normalize args3)%zrange &&
                                               is_bounded_by_bool
                                                 (let (x12, _) := xv in x12)
                                                 (ZRange.normalize args6) &&
                                               is_bounded_by_bool
                                                 (let (x12, _) := xv0 in x12)
                                                 (ZRange.normalize args1)
                                              then
                                               Datatypes.Some
                                                 (#(Z_cast range)%expr @
                                                  (#(fancy_mulll
                                                       (2 *
                                                        Z.log2_up
                                                          (let (x12, _) :=
                                                             xv in
                                                           x12)))%expr @
                                                   (#(Z_cast args5)%expr @
                                                    v (Compile.reflect x6),
                                                   #(Z_cast args)%expr @
                                                   v0 (Compile.reflect x11))))%expr_pat
                                              else Datatypes.None);
                                      Datatypes.Some (Base x12));
                               Datatypes.Some
                                 (fv0 <-- fv;
                                  Base fv0)%under_lets
                              else Datatypes.None
                          | Datatypes.None => Datatypes.None
                          end
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Ident _ _ _ t7 idc7 @ @expr.Ident _ _ _ t8
                           idc8) @ @expr.App _ _ _ s10 _ ($_)%expr _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Ident _ _ _ t7 idc7 @ @expr.Ident _ _ _ t8
                           idc8) @ @expr.App _ _ _ s10 _
                          (@expr.Abs _ _ _ _ _ _) _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Ident _ _ _ t7 idc7 @ @expr.Ident _ _ _ t8
                           idc8) @ @expr.App _ _ _ s10 _ (_ @ _) _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Ident _ _ _ t7 idc7 @ @expr.Ident _ _ _ t8
                           idc8) @ @expr.App _ _ _ s10 _
                          (@expr.LetIn _ _ _ _ _ _ _) _))%expr_pat =>
                          Datatypes.None
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Ident _ _ _ t7 idc7 @ @expr.Ident _ _ _ t8
                           idc8) @ #(_)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Ident _ _ _ t7 idc7 @ @expr.Ident _ _ _ t8
                           idc8) @ ($_)%expr))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Ident _ _ _ t7 idc7 @ @expr.Ident _ _ _ t8
                           idc8) @ @expr.Abs _ _ _ _ _ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Ident _ _ _ t7 idc7 @ @expr.Ident _ _ _ t8
                           idc8) @ @expr.LetIn _ _ _ _ _ _ _))%expr_pat =>
                          Datatypes.None
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Ident _ _ _ t7 idc7 @ ($_)%expr) @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Ident _ _ _ t7 idc7 @ @expr.Abs _ _ _ _ _ _) @
                          _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Ident _ _ _ t7 idc7 @ (_ @ _)) @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Ident _ _ _ t7 idc7 @ @expr.LetIn _ _ _ _ _
                           _ _) @ _))%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ #(_) @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ ($_)%expr @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.Abs _ _ _ _ _ _ @
                          _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ (($_)%expr @ _) @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Abs _ _ _ _ _ _ @ _) @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ (_ @ _ @ _) @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.LetIn _ _ _ _ _ _ _ @ _) @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.LetIn _ _ _ _ _ _
                          _ @ _))%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t5 idc5 @ #(_))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ ($_)%expr)%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ @expr.Abs _ _ _ _ _ _)%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (#(_) @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (($_)%expr @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Abs _ _ _ _ _ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (($_)%expr @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Abs _ _ _ _ _ _ @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (_ @ _ @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.LetIn _ _ _ _ _ _ _ @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.LetIn _ _ _ _ _ _ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ @expr.LetIn _ _ _ _ _ _
                         _)%expr_pat => Datatypes.None
                      | _ => Datatypes.None
                      end
                  | _ => Datatypes.None
                  end;;
                  match x6 with
                  | @expr.Ident _ _ _ t4 idc4 =>
                      match x0 with
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Ident _ _ _ t7 idc7 @ @expr.Ident _ _ _ t8
                           idc8) @ @expr.App _ _ _ s10 _
                          (@expr.Ident _ _ _ t9 idc9) x11))%expr_pat =>
                          args <- invert_bind_args idc9 Raw.ident.Z_cast;
                          args0 <- invert_bind_args idc8 Raw.ident.Literal;
                          args1 <- invert_bind_args idc7 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc6 Raw.ident.Z_land;
                          args3 <- invert_bind_args idc5 Raw.ident.Z_cast;
                          args4 <- invert_bind_args idc4 Raw.ident.Literal;
                          args5 <- invert_bind_args idc3 Raw.ident.Z_cast;
                          args6 <- invert_bind_args idc2 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc1 Raw.ident.Z_land;
                          args8 <- invert_bind_args idc0 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc Raw.ident.Z_mul;
                          match
                            pattern.type.unify_extracted
                              ((ℤ -> ℤ) -> ℤ -> ℤ)%ptype
                              ((s4 -> (projT1 args4)) ->
                               (projT1 args0) -> s10)%ptype
                          with
                          | Datatypes.Some (_, _, (_, _))%zrange =>
                              if
                               type.type_beq base.type base.type.type_beq
                                 ((ℤ -> ℤ) -> ℤ -> ℤ)%ptype
                                 ((s4 -> (projT1 args4)) ->
                                  (projT1 args0) -> s10)%ptype
                              then
                               v <- type.try_make_transport_cps s4 ℤ;
                               xv <- ident.unify pattern.ident.Literal
                                       ##(projT2 args4);
                               xv0 <- ident.unify pattern.ident.Literal
                                        ##(projT2 args0);
                               v0 <- type.try_make_transport_cps s10 ℤ;
                               fv <- (x12 <- (if
                                               ((let (x12, _) := xv in x12) =?
                                                2
                                                ^ (2 *
                                                   Z.log2_up
                                                     (let (x12, _) := xv in
                                                      x12) / 2) - 1) &&
                                               ((let (x12, _) := xv0 in x12) =?
                                                2
                                                ^ (2 *
                                                   Z.log2_up
                                                     (let (x12, _) := xv in
                                                      x12) / 2) - 1) &&
                                               (ZRange.normalize args6 &'
                                                ZRange.normalize
                                                  (ZRange.constant
                                                     (let (x12, _) := xv in
                                                      x12)) <=?
                                                ZRange.normalize args8)%zrange &&
                                               (ZRange.normalize
                                                  (ZRange.constant
                                                     (let (x12, _) := xv0 in
                                                      x12)) &'
                                                ZRange.normalize args <=?
                                                ZRange.normalize args3)%zrange &&
                                               is_bounded_by_bool
                                                 (let (x12, _) := xv in x12)
                                                 (ZRange.normalize args5) &&
                                               is_bounded_by_bool
                                                 (let (x12, _) := xv0 in x12)
                                                 (ZRange.normalize args1)
                                              then
                                               Datatypes.Some
                                                 (#(Z_cast range)%expr @
                                                  (#(fancy_mulll
                                                       (2 *
                                                        Z.log2_up
                                                          (let (x12, _) :=
                                                             xv in
                                                           x12)))%expr @
                                                   (#(Z_cast args6)%expr @
                                                    v (Compile.reflect x5),
                                                   #(Z_cast args)%expr @
                                                   v0 (Compile.reflect x11))))%expr_pat
                                              else Datatypes.None);
                                      Datatypes.Some (Base x12));
                               Datatypes.Some
                                 (fv0 <-- fv;
                                  Base fv0)%under_lets
                              else Datatypes.None
                          | Datatypes.None => Datatypes.None
                          end
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Ident _ _ _ t7 idc7 @ @expr.Ident _ _ _ t8
                           idc8) @ @expr.App _ _ _ s10 _ ($_)%expr _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Ident _ _ _ t7 idc7 @ @expr.Ident _ _ _ t8
                           idc8) @ @expr.App _ _ _ s10 _
                          (@expr.Abs _ _ _ _ _ _) _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Ident _ _ _ t7 idc7 @ @expr.Ident _ _ _ t8
                           idc8) @ @expr.App _ _ _ s10 _ (_ @ _) _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Ident _ _ _ t7 idc7 @ @expr.Ident _ _ _ t8
                           idc8) @ @expr.App _ _ _ s10 _
                          (@expr.LetIn _ _ _ _ _ _ _) _))%expr_pat =>
                          Datatypes.None
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Ident _ _ _ t7 idc7 @ @expr.Ident _ _ _ t8
                           idc8) @ #(_)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Ident _ _ _ t7 idc7 @ @expr.Ident _ _ _ t8
                           idc8) @ ($_)%expr))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Ident _ _ _ t7 idc7 @ @expr.Ident _ _ _ t8
                           idc8) @ @expr.Abs _ _ _ _ _ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Ident _ _ _ t7 idc7 @ @expr.Ident _ _ _ t8
                           idc8) @ @expr.LetIn _ _ _ _ _ _ _))%expr_pat =>
                          Datatypes.None
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Ident _ _ _ t7 idc7 @ ($_)%expr) @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Ident _ _ _ t7 idc7 @ @expr.Abs _ _ _ _ _ _) @
                          _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Ident _ _ _ t7 idc7 @ (_ @ _)) @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Ident _ _ _ t7 idc7 @ @expr.LetIn _ _ _ _ _
                           _ _) @ _))%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ #(_) @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ ($_)%expr @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.Abs _ _ _ _ _ _ @
                          _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ (($_)%expr @ _) @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.Abs _ _ _ _ _ _ @ _) @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ (_ @ _ @ _) @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @
                          (@expr.LetIn _ _ _ _ _ _ _ @ _) @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.LetIn _ _ _ _ _ _
                          _ @ _))%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t5 idc5 @ #(_))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ ($_)%expr)%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ @expr.Abs _ _ _ _ _ _)%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (#(_) @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (($_)%expr @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Abs _ _ _ _ _ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (($_)%expr @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Abs _ _ _ _ _ _ @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (_ @ _ @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.LetIn _ _ _ _ _ _ _ @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.LetIn _ _ _ _ _ _ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ @expr.LetIn _ _ _ _ _ _
                         _)%expr_pat => Datatypes.None
                      | _ => Datatypes.None
                      end
                  | _ => Datatypes.None
                  end;;
                  match x5 with
                  | @expr.Ident _ _ _ t4 idc4 =>
                      match x0 with
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                           idc9)))%expr_pat =>
                          args <- invert_bind_args idc9 Raw.ident.Literal;
                          args0 <- invert_bind_args idc8 Raw.ident.Z_cast;
                          args1 <- invert_bind_args idc7 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc6 Raw.ident.Z_land;
                          args3 <- invert_bind_args idc5 Raw.ident.Z_cast;
                          args4 <- invert_bind_args idc4 Raw.ident.Literal;
                          args5 <- invert_bind_args idc3 Raw.ident.Z_cast;
                          args6 <- invert_bind_args idc2 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc1 Raw.ident.Z_land;
                          args8 <- invert_bind_args idc0 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc Raw.ident.Z_mul;
                          match
                            pattern.type.unify_extracted
                              ((ℤ -> ℤ) -> ℤ -> ℤ)%ptype
                              (((projT1 args4) -> s5) -> s9 -> (projT1 args))%ptype
                          with
                          | Datatypes.Some (_, _, (_, _))%zrange =>
                              if
                               type.type_beq base.type base.type.type_beq
                                 ((ℤ -> ℤ) -> ℤ -> ℤ)%ptype
                                 (((projT1 args4) -> s5) ->
                                  s9 -> (projT1 args))%ptype
                              then
                               xv <- ident.unify pattern.ident.Literal
                                       ##(projT2 args4);
                               v <- type.try_make_transport_cps s5 ℤ;
                               v0 <- type.try_make_transport_cps s9 ℤ;
                               xv0 <- ident.unify pattern.ident.Literal
                                        ##(projT2 args);
                               fv <- (x12 <- (if
                                               ((let (x12, _) := xv in x12) =?
                                                2
                                                ^ (2 *
                                                   Z.log2_up
                                                     (let (x12, _) := xv in
                                                      x12) / 2) - 1) &&
                                               ((let (x12, _) := xv0 in x12) =?
                                                2
                                                ^ (2 *
                                                   Z.log2_up
                                                     (let (x12, _) := xv in
                                                      x12) / 2) - 1) &&
                                               (ZRange.normalize
                                                  (ZRange.constant
                                                     (let (x12, _) := xv in
                                                      x12)) &'
                                                ZRange.normalize args5 <=?
                                                ZRange.normalize args8)%zrange &&
                                               (ZRange.normalize args1 &'
                                                ZRange.normalize
                                                  (ZRange.constant
                                                     (let (x12, _) := xv0 in
                                                      x12)) <=?
                                                ZRange.normalize args3)%zrange &&
                                               is_bounded_by_bool
                                                 (let (x12, _) := xv in x12)
                                                 (ZRange.normalize args6) &&
                                               is_bounded_by_bool
                                                 (let (x12, _) := xv0 in x12)
                                                 (ZRange.normalize args0)
                                              then
                                               Datatypes.Some
                                                 (#(Z_cast range)%expr @
                                                  (#(fancy_mulll
                                                       (2 *
                                                        Z.log2_up
                                                          (let (x12, _) :=
                                                             xv in
                                                           x12)))%expr @
                                                   (#(Z_cast args5)%expr @
                                                    v (Compile.reflect x6),
                                                   #(Z_cast args1)%expr @
                                                   v0 (Compile.reflect x10))))%expr_pat
                                              else Datatypes.None);
                                      Datatypes.Some (Base x12));
                               Datatypes.Some
                                 (fv0 <-- fv;
                                  Base fv0)%under_lets
                              else Datatypes.None
                          | Datatypes.None => Datatypes.None
                          end
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.Ident _ _ _ t8 idc8 @ ($_)%expr)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.Ident _ _ _ t8 idc8 @ @expr.Abs _ _ _ _ _ _)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.Ident _ _ _ t8 idc8 @ (_ @ _))))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.Ident _ _ _ t8 idc8 @ @expr.LetIn _ _ _ _ _
                           _ _)))%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @ #(_)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @ ($_)%expr))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @ @expr.Abs _ _ _ _
                          _ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @ (($_)%expr @ _)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.Abs _ _ _ _ _ _ @ _)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @ (_ @ _ @ _)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.LetIn _ _ _ _ _ _ _ @ _)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @ @expr.LetIn _ _ _
                          _ _ _ _))%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          ($_)%expr _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Abs _ _ _ _ _ _) _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (_ @ _) _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.LetIn _ _ _ _ _ _ _) _ @ _))%expr_pat =>
                          Datatypes.None
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ #(_) @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ ($_)%expr @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.Abs _ _ _ _ _ _ @
                          _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.LetIn _ _ _ _ _ _
                          _ @ _))%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t5 idc5 @ #(_))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ ($_)%expr)%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ @expr.Abs _ _ _ _ _ _)%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (#(_) @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (($_)%expr @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Abs _ _ _ _ _ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (($_)%expr @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Abs _ _ _ _ _ _ @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (_ @ _ @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.LetIn _ _ _ _ _ _ _ @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.LetIn _ _ _ _ _ _ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ @expr.LetIn _ _ _ _ _ _
                         _)%expr_pat => Datatypes.None
                      | _ => Datatypes.None
                      end
                  | _ => Datatypes.None
                  end;;
                  match x6 with
                  | @expr.Ident _ _ _ t4 idc4 =>
                      match x0 with
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                           idc9)))%expr_pat =>
                          args <- invert_bind_args idc9 Raw.ident.Literal;
                          args0 <- invert_bind_args idc8 Raw.ident.Z_cast;
                          args1 <- invert_bind_args idc7 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc6 Raw.ident.Z_land;
                          args3 <- invert_bind_args idc5 Raw.ident.Z_cast;
                          args4 <- invert_bind_args idc4 Raw.ident.Literal;
                          args5 <- invert_bind_args idc3 Raw.ident.Z_cast;
                          args6 <- invert_bind_args idc2 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc1 Raw.ident.Z_land;
                          args8 <- invert_bind_args idc0 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc Raw.ident.Z_mul;
                          match
                            pattern.type.unify_extracted
                              ((ℤ -> ℤ) -> ℤ -> ℤ)%ptype
                              ((s4 -> (projT1 args4)) -> s9 -> (projT1 args))%ptype
                          with
                          | Datatypes.Some (_, _, (_, _))%zrange =>
                              if
                               type.type_beq base.type base.type.type_beq
                                 ((ℤ -> ℤ) -> ℤ -> ℤ)%ptype
                                 ((s4 -> (projT1 args4)) ->
                                  s9 -> (projT1 args))%ptype
                              then
                               v <- type.try_make_transport_cps s4 ℤ;
                               xv <- ident.unify pattern.ident.Literal
                                       ##(projT2 args4);
                               v0 <- type.try_make_transport_cps s9 ℤ;
                               xv0 <- ident.unify pattern.ident.Literal
                                        ##(projT2 args);
                               fv <- (x12 <- (if
                                               ((let (x12, _) := xv in x12) =?
                                                2
                                                ^ (2 *
                                                   Z.log2_up
                                                     (let (x12, _) := xv in
                                                      x12) / 2) - 1) &&
                                               ((let (x12, _) := xv0 in x12) =?
                                                2
                                                ^ (2 *
                                                   Z.log2_up
                                                     (let (x12, _) := xv in
                                                      x12) / 2) - 1) &&
                                               (ZRange.normalize args6 &'
                                                ZRange.normalize
                                                  (ZRange.constant
                                                     (let (x12, _) := xv in
                                                      x12)) <=?
                                                ZRange.normalize args8)%zrange &&
                                               (ZRange.normalize args1 &'
                                                ZRange.normalize
                                                  (ZRange.constant
                                                     (let (x12, _) := xv0 in
                                                      x12)) <=?
                                                ZRange.normalize args3)%zrange &&
                                               is_bounded_by_bool
                                                 (let (x12, _) := xv in x12)
                                                 (ZRange.normalize args5) &&
                                               is_bounded_by_bool
                                                 (let (x12, _) := xv0 in x12)
                                                 (ZRange.normalize args0)
                                              then
                                               Datatypes.Some
                                                 (#(Z_cast range)%expr @
                                                  (#(fancy_mulll
                                                       (2 *
                                                        Z.log2_up
                                                          (let (x12, _) :=
                                                             xv in
                                                           x12)))%expr @
                                                   (#(Z_cast args6)%expr @
                                                    v (Compile.reflect x5),
                                                   #(Z_cast args1)%expr @
                                                   v0 (Compile.reflect x10))))%expr_pat
                                              else Datatypes.None);
                                      Datatypes.Some (Base x12));
                               Datatypes.Some
                                 (fv0 <-- fv;
                                  Base fv0)%under_lets
                              else Datatypes.None
                          | Datatypes.None => Datatypes.None
                          end
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.Ident _ _ _ t8 idc8 @ ($_)%expr)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.Ident _ _ _ t8 idc8 @ @expr.Abs _ _ _ _ _ _)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.Ident _ _ _ t8 idc8 @ (_ @ _))))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.Ident _ _ _ t8 idc8 @ @expr.LetIn _ _ _ _ _
                           _ _)))%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @ #(_)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @ ($_)%expr))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @ @expr.Abs _ _ _ _
                          _ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @ (($_)%expr @ _)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.Abs _ _ _ _ _ _ @ _)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @ (_ @ _ @ _)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.LetIn _ _ _ _ _ _ _ @ _)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @ @expr.LetIn _ _ _
                          _ _ _ _))%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          ($_)%expr _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Abs _ _ _ _ _ _) _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (_ @ _) _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.LetIn _ _ _ _ _ _ _) _ @ _))%expr_pat =>
                          Datatypes.None
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ #(_) @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ ($_)%expr @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.Abs _ _ _ _ _ _ @
                          _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.LetIn _ _ _ _ _ _
                          _ @ _))%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t5 idc5 @ #(_))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ ($_)%expr)%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ @expr.Abs _ _ _ _ _ _)%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (#(_) @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (($_)%expr @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Abs _ _ _ _ _ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (($_)%expr @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Abs _ _ _ _ _ _ @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (_ @ _ @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.LetIn _ _ _ _ _ _ _ @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.LetIn _ _ _ _ _ _ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ @expr.LetIn _ _ _ _ _ _
                         _)%expr_pat => Datatypes.None
                      | _ => Datatypes.None
                      end
                  | _ => Datatypes.None
                  end;;
                  match x5 with
                  | @expr.Ident _ _ _ t4 idc4 =>
                      match x0 with
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                           idc9)))%expr_pat =>
                          args <- invert_bind_args idc9 Raw.ident.Literal;
                          args0 <- invert_bind_args idc8 Raw.ident.Z_cast;
                          args1 <- invert_bind_args idc7 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc6 Raw.ident.Z_shiftr;
                          args3 <- invert_bind_args idc5 Raw.ident.Z_cast;
                          args4 <- invert_bind_args idc4 Raw.ident.Literal;
                          args5 <- invert_bind_args idc3 Raw.ident.Z_cast;
                          args6 <- invert_bind_args idc2 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc1 Raw.ident.Z_land;
                          args8 <- invert_bind_args idc0 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc Raw.ident.Z_mul;
                          match
                            pattern.type.unify_extracted
                              ((ℤ -> ℤ) -> ℤ -> ℤ)%ptype
                              (((projT1 args4) -> s5) -> s9 -> (projT1 args))%ptype
                          with
                          | Datatypes.Some (_, _, (_, _))%zrange =>
                              if
                               type.type_beq base.type base.type.type_beq
                                 ((ℤ -> ℤ) -> ℤ -> ℤ)%ptype
                                 (((projT1 args4) -> s5) ->
                                  s9 -> (projT1 args))%ptype
                              then
                               xv <- ident.unify pattern.ident.Literal
                                       ##(projT2 args4);
                               v <- type.try_make_transport_cps s5 ℤ;
                               v0 <- type.try_make_transport_cps s9 ℤ;
                               xv0 <- ident.unify pattern.ident.Literal
                                        ##(projT2 args);
                               fv <- (x12 <- (if
                                               ((let (x12, _) := xv in x12) =?
                                                2
                                                ^ (2 *
                                                   (let (x12, _) := xv0 in
                                                    x12) / 2) - 1) &&
                                               (ZRange.normalize
                                                  (ZRange.constant
                                                     (let (x12, _) := xv in
                                                      x12)) &'
                                                ZRange.normalize args5 <=?
                                                ZRange.normalize args8)%zrange &&
                                               (ZRange.normalize args1 >>
                                                ZRange.normalize
                                                  (ZRange.constant
                                                     (let (x12, _) := xv0 in
                                                      x12)) <=?
                                                ZRange.normalize args3)%zrange &&
                                               is_bounded_by_bool
                                                 (let (x12, _) := xv in x12)
                                                 (ZRange.normalize args6) &&
                                               is_bounded_by_bool
                                                 (let (x12, _) := xv0 in x12)
                                                 (ZRange.normalize args0)
                                              then
                                               Datatypes.Some
                                                 (#(Z_cast range)%expr @
                                                  (#(fancy_mullh
                                                       (2 *
                                                        (let (x12, _) :=
                                                           xv0 in
                                                         x12)))%expr @
                                                   (#(Z_cast args5)%expr @
                                                    v (Compile.reflect x6),
                                                   #(Z_cast args1)%expr @
                                                   v0 (Compile.reflect x10))))%expr_pat
                                              else Datatypes.None);
                                      Datatypes.Some (Base x12));
                               Datatypes.Some
                                 (fv0 <-- fv;
                                  Base fv0)%under_lets
                              else Datatypes.None
                          | Datatypes.None => Datatypes.None
                          end
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.Ident _ _ _ t8 idc8 @ ($_)%expr)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.Ident _ _ _ t8 idc8 @ @expr.Abs _ _ _ _ _ _)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.Ident _ _ _ t8 idc8 @ (_ @ _))))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.Ident _ _ _ t8 idc8 @ @expr.LetIn _ _ _ _ _
                           _ _)))%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @ #(_)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @ ($_)%expr))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @ @expr.Abs _ _ _ _
                          _ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @ (($_)%expr @ _)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.Abs _ _ _ _ _ _ @ _)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @ (_ @ _ @ _)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.LetIn _ _ _ _ _ _ _ @ _)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @ @expr.LetIn _ _ _
                          _ _ _ _))%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          ($_)%expr _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Abs _ _ _ _ _ _) _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (_ @ _) _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.LetIn _ _ _ _ _ _ _) _ @ _))%expr_pat =>
                          Datatypes.None
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ #(_) @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ ($_)%expr @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.Abs _ _ _ _ _ _ @
                          _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.LetIn _ _ _ _ _ _
                          _ @ _))%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t5 idc5 @ #(_))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ ($_)%expr)%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ @expr.Abs _ _ _ _ _ _)%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (#(_) @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (($_)%expr @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Abs _ _ _ _ _ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (($_)%expr @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Abs _ _ _ _ _ _ @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (_ @ _ @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.LetIn _ _ _ _ _ _ _ @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.LetIn _ _ _ _ _ _ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ @expr.LetIn _ _ _ _ _ _
                         _)%expr_pat => Datatypes.None
                      | _ => Datatypes.None
                      end
                  | _ => Datatypes.None
                  end;;
                  match x6 with
                  | @expr.Ident _ _ _ t4 idc4 =>
                      match x0 with
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                           idc9)))%expr_pat =>
                          args <- invert_bind_args idc9 Raw.ident.Literal;
                          args0 <- invert_bind_args idc8 Raw.ident.Z_cast;
                          args1 <- invert_bind_args idc7 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc6 Raw.ident.Z_shiftr;
                          args3 <- invert_bind_args idc5 Raw.ident.Z_cast;
                          args4 <- invert_bind_args idc4 Raw.ident.Literal;
                          args5 <- invert_bind_args idc3 Raw.ident.Z_cast;
                          args6 <- invert_bind_args idc2 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc1 Raw.ident.Z_land;
                          args8 <- invert_bind_args idc0 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc Raw.ident.Z_mul;
                          match
                            pattern.type.unify_extracted
                              ((ℤ -> ℤ) -> ℤ -> ℤ)%ptype
                              ((s4 -> (projT1 args4)) -> s9 -> (projT1 args))%ptype
                          with
                          | Datatypes.Some (_, _, (_, _))%zrange =>
                              if
                               type.type_beq base.type base.type.type_beq
                                 ((ℤ -> ℤ) -> ℤ -> ℤ)%ptype
                                 ((s4 -> (projT1 args4)) ->
                                  s9 -> (projT1 args))%ptype
                              then
                               v <- type.try_make_transport_cps s4 ℤ;
                               xv <- ident.unify pattern.ident.Literal
                                       ##(projT2 args4);
                               v0 <- type.try_make_transport_cps s9 ℤ;
                               xv0 <- ident.unify pattern.ident.Literal
                                        ##(projT2 args);
                               fv <- (x12 <- (if
                                               ((let (x12, _) := xv in x12) =?
                                                2
                                                ^ (2 *
                                                   (let (x12, _) := xv0 in
                                                    x12) / 2) - 1) &&
                                               (ZRange.normalize args6 &'
                                                ZRange.normalize
                                                  (ZRange.constant
                                                     (let (x12, _) := xv in
                                                      x12)) <=?
                                                ZRange.normalize args8)%zrange &&
                                               (ZRange.normalize args1 >>
                                                ZRange.normalize
                                                  (ZRange.constant
                                                     (let (x12, _) := xv0 in
                                                      x12)) <=?
                                                ZRange.normalize args3)%zrange &&
                                               is_bounded_by_bool
                                                 (let (x12, _) := xv in x12)
                                                 (ZRange.normalize args5) &&
                                               is_bounded_by_bool
                                                 (let (x12, _) := xv0 in x12)
                                                 (ZRange.normalize args0)
                                              then
                                               Datatypes.Some
                                                 (#(Z_cast range)%expr @
                                                  (#(fancy_mullh
                                                       (2 *
                                                        (let (x12, _) :=
                                                           xv0 in
                                                         x12)))%expr @
                                                   (#(Z_cast args6)%expr @
                                                    v (Compile.reflect x5),
                                                   #(Z_cast args1)%expr @
                                                   v0 (Compile.reflect x10))))%expr_pat
                                              else Datatypes.None);
                                      Datatypes.Some (Base x12));
                               Datatypes.Some
                                 (fv0 <-- fv;
                                  Base fv0)%under_lets
                              else Datatypes.None
                          | Datatypes.None => Datatypes.None
                          end
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.Ident _ _ _ t8 idc8 @ ($_)%expr)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.Ident _ _ _ t8 idc8 @ @expr.Abs _ _ _ _ _ _)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.Ident _ _ _ t8 idc8 @ (_ @ _))))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.Ident _ _ _ t8 idc8 @ @expr.LetIn _ _ _ _ _
                           _ _)))%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @ #(_)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @ ($_)%expr))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @ @expr.Abs _ _ _ _
                          _ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @ (($_)%expr @ _)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.Abs _ _ _ _ _ _ @ _)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @ (_ @ _ @ _)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @
                          (@expr.LetIn _ _ _ _ _ _ _ @ _)))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Ident _ _ _ t7 idc7) x10 @ @expr.LetIn _ _ _
                          _ _ _ _))%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          ($_)%expr _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.Abs _ _ _ _ _ _) _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (_ @ _) _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s9 _
                          (@expr.LetIn _ _ _ _ _ _ _) _ @ _))%expr_pat =>
                          Datatypes.None
                      | (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ #(_) @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ ($_)%expr @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.Abs _ _ _ _ _ _ @
                          _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.LetIn _ _ _ _ _ _
                          _ @ _))%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t5 idc5 @ #(_))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ ($_)%expr)%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ @expr.Abs _ _ _ _ _ _)%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (#(_) @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (($_)%expr @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Abs _ _ _ _ _ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (($_)%expr @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.Abs _ _ _ _ _ _ @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ (_ @ _ @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.LetIn _ _ _ _ _ _ _ @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @
                         (@expr.LetIn _ _ _ _ _ _ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t5 idc5 @ @expr.LetIn _ _ _ _ _ _
                         _)%expr_pat => Datatypes.None
                      | _ => Datatypes.None
                      end
                  | _ => Datatypes.None
                  end
              | @expr.App _ _ _ s5 _ ($_)%expr _ | @expr.App _ _ _ s5 _
                (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _ _ s5 _
                (_ @ _)%expr_pat _ | @expr.App _ _ _ s5 _
                (@expr.LetIn _ _ _ _ _ _ _) _ => Datatypes.None
              | _ => Datatypes.None
              end
          | @expr.App _ _ _ s4 _ ($_)%expr _ | @expr.App _ _ _ s4 _
            (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _ _ s4 _ (_ @ _)%expr_pat
            _ | @expr.App _ _ _ s4 _ (@expr.LetIn _ _ _ _ _ _ _) _ =>
              Datatypes.None
          | _ => Datatypes.None
          end;;
          match x4 with
          | @expr.App _ _ _ s4 _ (@expr.Ident _ _ _ t2 idc2) x5 =>
              match x3 with
              | (@expr.Ident _ _ _ t3 idc3 @ @expr.Ident _ _ _ t4 idc4)%expr_pat =>
                  match x0 with
                  | (@expr.Ident _ _ _ t5 idc5 @ @expr.Ident _ _ _ t6 idc6)%expr_pat =>
                      (args <- invert_bind_args idc6 Raw.ident.Literal;
                       args0 <- invert_bind_args idc5 Raw.ident.Z_cast;
                       args1 <- invert_bind_args idc4 Raw.ident.Literal;
                       args2 <- invert_bind_args idc3 Raw.ident.Z_cast;
                       args3 <- invert_bind_args idc2 Raw.ident.Z_cast;
                       _ <- invert_bind_args idc1 Raw.ident.Z_shiftr;
                       args5 <- invert_bind_args idc0 Raw.ident.Z_cast;
                       _ <- invert_bind_args idc Raw.ident.Z_mul;
                       match
                         pattern.type.unify_extracted ((ℤ -> ℤ) -> ℤ)%ptype
                           ((s4 -> (projT1 args1)) -> (projT1 args))%ptype
                       with
                       | Datatypes.Some (_, _, _)%zrange =>
                           if
                            type.type_beq base.type base.type.type_beq
                              ((ℤ -> ℤ) -> ℤ)%ptype
                              ((s4 -> (projT1 args1)) -> (projT1 args))%ptype
                           then
                            v <- type.try_make_transport_cps s4 ℤ;
                            xv <- ident.unify pattern.ident.Literal
                                    ##(projT2 args1);
                            xv0 <- ident.unify pattern.ident.Literal
                                     ##(projT2 args);
                            fv <- (x8 <- (if
                                           (ZRange.normalize args3 >>
                                            ZRange.normalize
                                              (ZRange.constant
                                                 (let (x8, _) := xv in x8)) <=?
                                            ZRange.normalize args5)%zrange &&
                                           is_bounded_by_bool
                                             (let (x8, _) := xv0 in x8)
                                             (ZRange.normalize args0) &&
                                           is_bounded_by_bool
                                             (let (x8, _) := xv in x8)
                                             (ZRange.normalize args2)
                                          then
                                           y <- invert_low
                                                  (2 *
                                                   (let (x8, _) := xv in x8))
                                                  (let (x8, _) := xv0 in x8);
                                           Datatypes.Some
                                             (#(Z_cast range)%expr @
                                              (#(fancy_mulhl
                                                   (2 *
                                                    (let (x8, _) := xv in x8)))%expr @
                                               (#(Z_cast args3)%expr @
                                                v (Compile.reflect x5),
                                               (##y)%expr)))%expr_pat
                                          else Datatypes.None);
                                   Datatypes.Some (Base x8));
                            Datatypes.Some (fv0 <-- fv;
                                            Base fv0)%under_lets
                           else Datatypes.None
                       | Datatypes.None => Datatypes.None
                       end);;
                      args <- invert_bind_args idc6 Raw.ident.Literal;
                      args0 <- invert_bind_args idc5 Raw.ident.Z_cast;
                      args1 <- invert_bind_args idc4 Raw.ident.Literal;
                      args2 <- invert_bind_args idc3 Raw.ident.Z_cast;
                      args3 <- invert_bind_args idc2 Raw.ident.Z_cast;
                      _ <- invert_bind_args idc1 Raw.ident.Z_shiftr;
                      args5 <- invert_bind_args idc0 Raw.ident.Z_cast;
                      _ <- invert_bind_args idc Raw.ident.Z_mul;
                      match
                        pattern.type.unify_extracted ((ℤ -> ℤ) -> ℤ)%ptype
                          ((s4 -> (projT1 args1)) -> (projT1 args))%ptype
                      with
                      | Datatypes.Some (_, _, _)%zrange =>
                          if
                           type.type_beq base.type base.type.type_beq
                             ((ℤ -> ℤ) -> ℤ)%ptype
                             ((s4 -> (projT1 args1)) -> (projT1 args))%ptype
                          then
                           v <- type.try_make_transport_cps s4 ℤ;
                           xv <- ident.unify pattern.ident.Literal
                                   ##(projT2 args1);
                           xv0 <- ident.unify pattern.ident.Literal
                                    ##(projT2 args);
                           fv <- (x8 <- (if
                                          (ZRange.normalize args3 >>
                                           ZRange.normalize
                                             (ZRange.constant
                                                (let (x8, _) := xv in x8)) <=?
                                           ZRange.normalize args5)%zrange &&
                                          is_bounded_by_bool
                                            (let (x8, _) := xv0 in x8)
                                            (ZRange.normalize args0) &&
                                          is_bounded_by_bool
                                            (let (x8, _) := xv in x8)
                                            (ZRange.normalize args2)
                                         then
                                          y <- invert_high
                                                 (2 *
                                                  (let (x8, _) := xv in x8))
                                                 (let (x8, _) := xv0 in x8);
                                          Datatypes.Some
                                            (#(Z_cast range)%expr @
                                             (#(fancy_mulhh
                                                  (2 *
                                                   (let (x8, _) := xv in x8)))%expr @
                                              (#(Z_cast args3)%expr @
                                               v (Compile.reflect x5),
                                              (##y)%expr)))%expr_pat
                                         else Datatypes.None);
                                  Datatypes.Some (Base x8));
                           Datatypes.Some (fv0 <-- fv;
                                           Base fv0)%under_lets
                          else Datatypes.None
                      | Datatypes.None => Datatypes.None
                      end
                  | (@expr.Ident _ _ _ t5 idc5 @
                     (@expr.Ident _ _ _ t6 idc6 @ x9 @ x8))%expr_pat =>
                      match x9 with
                      | @expr.App _ _ _ s9 _ (@expr.Ident _ _ _ t7 idc7)
                        x10 =>
                          match x10 with
                          | @expr.Ident _ _ _ t8 idc8 =>
                              match x8 with
                              | @expr.App _ _ _ s10 _
                                (@expr.Ident _ _ _ t9 idc9) x11 =>
                                  args <- invert_bind_args idc9
                                            Raw.ident.Z_cast;
                                  args0 <- invert_bind_args idc8
                                             Raw.ident.Literal;
                                  args1 <- invert_bind_args idc7
                                             Raw.ident.Z_cast;
                                  _ <- invert_bind_args idc6 Raw.ident.Z_land;
                                  args3 <- invert_bind_args idc5
                                             Raw.ident.Z_cast;
                                  args4 <- invert_bind_args idc4
                                             Raw.ident.Literal;
                                  args5 <- invert_bind_args idc3
                                             Raw.ident.Z_cast;
                                  args6 <- invert_bind_args idc2
                                             Raw.ident.Z_cast;
                                  _ <- invert_bind_args idc1
                                         Raw.ident.Z_shiftr;
                                  args8 <- invert_bind_args idc0
                                             Raw.ident.Z_cast;
                                  _ <- invert_bind_args idc Raw.ident.Z_mul;
                                  match
                                    pattern.type.unify_extracted
                                      ((ℤ -> ℤ) -> ℤ -> ℤ)%ptype
                                      ((s4 -> (projT1 args4)) ->
                                       (projT1 args0) -> s10)%ptype
                                  with
                                  | Datatypes.Some (_, _, (_, _))%zrange =>
                                      if
                                       type.type_beq base.type
                                         base.type.type_beq
                                         ((ℤ -> ℤ) -> ℤ -> ℤ)%ptype
                                         ((s4 -> (projT1 args4)) ->
                                          (projT1 args0) -> s10)%ptype
                                      then
                                       v <- type.try_make_transport_cps s4 ℤ;
                                       xv <- ident.unify
                                               pattern.ident.Literal
                                               ##(projT2 args4);
                                       xv0 <- ident.unify
                                                pattern.ident.Literal
                                                ##(projT2 args0);
                                       v0 <- type.try_make_transport_cps s10 ℤ;
                                       fv <- (x12 <- (if
                                                       ((let (x12, _) :=
                                                           xv0 in
                                                         x12) =?
                                                        2
                                                        ^ (2 *
                                                           (let (x12, _) :=
                                                              xv in
                                                            x12) / 2) - 1) &&
                                                       (ZRange.normalize
                                                          args6 >>
                                                        ZRange.normalize
                                                          (ZRange.constant
                                                             (let (x12, _) :=
                                                                xv in
                                                              x12)) <=?
                                                        ZRange.normalize
                                                          args8)%zrange &&
                                                       (ZRange.normalize
                                                          (ZRange.constant
                                                             (let (x12, _) :=
                                                                xv0 in
                                                              x12)) &'
                                                        ZRange.normalize args <=?
                                                        ZRange.normalize
                                                          args3)%zrange &&
                                                       is_bounded_by_bool
                                                         (let (x12, _) :=
                                                            xv0 in
                                                          x12)
                                                         (ZRange.normalize
                                                            args1) &&
                                                       is_bounded_by_bool
                                                         (let (x12, _) :=
                                                            xv in
                                                          x12)
                                                         (ZRange.normalize
                                                            args5)
                                                      then
                                                       Datatypes.Some
                                                         (#(Z_cast range)%expr @
                                                          (#(fancy_mulhl
                                                               (2 *
                                                                (let
                                                                   (x12,
                                                                    _) :=
                                                                   xv in
                                                                 x12)))%expr @
                                                           (#(Z_cast args6)%expr @
                                                            v
                                                              (Compile.reflect
                                                                 x5),
                                                           #(Z_cast args)%expr @
                                                           v0
                                                             (Compile.reflect
                                                                x11))))%expr_pat
                                                      else Datatypes.None);
                                              Datatypes.Some (Base x12));
                                       Datatypes.Some
                                         (fv0 <-- fv;
                                          Base fv0)%under_lets
                                      else Datatypes.None
                                  | Datatypes.None => Datatypes.None
                                  end
                              | @expr.App _ _ _ s10 _ ($_)%expr _ | @expr.App
                                _ _ _ s10 _ (@expr.Abs _ _ _ _ _ _) _ |
                                @expr.App _ _ _ s10 _ (_ @ _)%expr_pat _ |
                                @expr.App _ _ _ s10 _
                                (@expr.LetIn _ _ _ _ _ _ _) _ =>
                                  Datatypes.None
                              | _ => Datatypes.None
                              end
                          | _ => Datatypes.None
                          end;;
                          match x8 with
                          | (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                             idc9)%expr_pat =>
                              args <- invert_bind_args idc9 Raw.ident.Literal;
                              args0 <- invert_bind_args idc8 Raw.ident.Z_cast;
                              args1 <- invert_bind_args idc7 Raw.ident.Z_cast;
                              _ <- invert_bind_args idc6 Raw.ident.Z_land;
                              args3 <- invert_bind_args idc5 Raw.ident.Z_cast;
                              args4 <- invert_bind_args idc4
                                         Raw.ident.Literal;
                              args5 <- invert_bind_args idc3 Raw.ident.Z_cast;
                              args6 <- invert_bind_args idc2 Raw.ident.Z_cast;
                              _ <- invert_bind_args idc1 Raw.ident.Z_shiftr;
                              args8 <- invert_bind_args idc0 Raw.ident.Z_cast;
                              _ <- invert_bind_args idc Raw.ident.Z_mul;
                              match
                                pattern.type.unify_extracted
                                  ((ℤ -> ℤ) -> ℤ -> ℤ)%ptype
                                  ((s4 -> (projT1 args4)) ->
                                   s9 -> (projT1 args))%ptype
                              with
                              | Datatypes.Some (_, _, (_, _))%zrange =>
                                  if
                                   type.type_beq base.type base.type.type_beq
                                     ((ℤ -> ℤ) -> ℤ -> ℤ)%ptype
                                     ((s4 -> (projT1 args4)) ->
                                      s9 -> (projT1 args))%ptype
                                  then
                                   v <- type.try_make_transport_cps s4 ℤ;
                                   xv <- ident.unify pattern.ident.Literal
                                           ##(projT2 args4);
                                   v0 <- type.try_make_transport_cps s9 ℤ;
                                   xv0 <- ident.unify pattern.ident.Literal
                                            ##(projT2 args);
                                   fv <- (x12 <- (if
                                                   ((let (x12, _) := xv0 in
                                                     x12) =?
                                                    2
                                                    ^ (2 *
                                                       (let (x12, _) := xv in
                                                        x12) / 2) - 1) &&
                                                   (ZRange.normalize args6 >>
                                                    ZRange.normalize
                                                      (ZRange.constant
                                                         (let (x12, _) :=
                                                            xv in
                                                          x12)) <=?
                                                    ZRange.normalize args8)%zrange &&
                                                   (ZRange.normalize args1 &'
                                                    ZRange.normalize
                                                      (ZRange.constant
                                                         (let (x12, _) :=
                                                            xv0 in
                                                          x12)) <=?
                                                    ZRange.normalize args3)%zrange &&
                                                   is_bounded_by_bool
                                                     (let (x12, _) := xv0 in
                                                      x12)
                                                     (ZRange.normalize args0) &&
                                                   is_bounded_by_bool
                                                     (let (x12, _) := xv in
                                                      x12)
                                                     (ZRange.normalize args5)
                                                  then
                                                   Datatypes.Some
                                                     (#(Z_cast range)%expr @
                                                      (#(fancy_mulhl
                                                           (2 *
                                                            (let (x12, _) :=
                                                               xv in
                                                             x12)))%expr @
                                                       (#(Z_cast args6)%expr @
                                                        v
                                                          (Compile.reflect x5),
                                                       #(Z_cast args1)%expr @
                                                       v0
                                                         (Compile.reflect x10))))%expr_pat
                                                  else Datatypes.None);
                                          Datatypes.Some (Base x12));
                                   Datatypes.Some
                                     (fv0 <-- fv;
                                      Base fv0)%under_lets
                                  else Datatypes.None
                              | Datatypes.None => Datatypes.None
                              end
                          | (@expr.Ident _ _ _ t8 idc8 @ ($_)%expr)%expr_pat |
                            (@expr.Ident _ _ _ t8 idc8 @ @expr.Abs _ _ _ _ _
                             _)%expr_pat |
                            (@expr.Ident _ _ _ t8 idc8 @ (_ @ _))%expr_pat |
                            (@expr.Ident _ _ _ t8 idc8 @ @expr.LetIn _ _ _ _
                             _ _ _)%expr_pat => Datatypes.None
                          | _ => Datatypes.None
                          end
                      | @expr.App _ _ _ s9 _ ($_)%expr _ | @expr.App _ _ _ s9
                        _ (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _ _ s9 _
                        (_ @ _)%expr_pat _ | @expr.App _ _ _ s9 _
                        (@expr.LetIn _ _ _ _ _ _ _) _ => Datatypes.None
                      | _ => Datatypes.None
                      end;;
                      match x9 with
                      | @expr.App _ _ _ s9 _ (@expr.Ident _ _ _ t7 idc7)
                        x10 =>
                          match x8 with
                          | (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                             idc9)%expr_pat =>
                              args <- invert_bind_args idc9 Raw.ident.Literal;
                              args0 <- invert_bind_args idc8 Raw.ident.Z_cast;
                              args1 <- invert_bind_args idc7 Raw.ident.Z_cast;
                              _ <- invert_bind_args idc6 Raw.ident.Z_shiftr;
                              args3 <- invert_bind_args idc5 Raw.ident.Z_cast;
                              args4 <- invert_bind_args idc4
                                         Raw.ident.Literal;
                              args5 <- invert_bind_args idc3 Raw.ident.Z_cast;
                              args6 <- invert_bind_args idc2 Raw.ident.Z_cast;
                              _ <- invert_bind_args idc1 Raw.ident.Z_shiftr;
                              args8 <- invert_bind_args idc0 Raw.ident.Z_cast;
                              _ <- invert_bind_args idc Raw.ident.Z_mul;
                              match
                                pattern.type.unify_extracted
                                  ((ℤ -> ℤ) -> ℤ -> ℤ)%ptype
                                  ((s4 -> (projT1 args4)) ->
                                   s9 -> (projT1 args))%ptype
                              with
                              | Datatypes.Some (_, _, (_, _))%zrange =>
                                  if
                                   type.type_beq base.type base.type.type_beq
                                     ((ℤ -> ℤ) -> ℤ -> ℤ)%ptype
                                     ((s4 -> (projT1 args4)) ->
                                      s9 -> (projT1 args))%ptype
                                  then
                                   v <- type.try_make_transport_cps s4 ℤ;
                                   xv <- ident.unify pattern.ident.Literal
                                           ##(projT2 args4);
                                   v0 <- type.try_make_transport_cps s9 ℤ;
                                   xv0 <- ident.unify pattern.ident.Literal
                                            ##(projT2 args);
                                   fv <- (x12 <- (if
                                                   ((let (x12, _) := xv in
                                                     x12) =?
                                                    (let (x12, _) := xv0 in
                                                     x12)) &&
                                                   (ZRange.normalize args6 >>
                                                    ZRange.normalize
                                                      (ZRange.constant
                                                         (let (x12, _) :=
                                                            xv in
                                                          x12)) <=?
                                                    ZRange.normalize args8)%zrange &&
                                                   (ZRange.normalize args1 >>
                                                    ZRange.normalize
                                                      (ZRange.constant
                                                         (let (x12, _) :=
                                                            xv0 in
                                                          x12)) <=?
                                                    ZRange.normalize args3)%zrange &&
                                                   is_bounded_by_bool
                                                     (let (x12, _) := xv in
                                                      x12)
                                                     (ZRange.normalize args5) &&
                                                   is_bounded_by_bool
                                                     (let (x12, _) := xv0 in
                                                      x12)
                                                     (ZRange.normalize args0)
                                                  then
                                                   Datatypes.Some
                                                     (#(Z_cast range)%expr @
                                                      (#(fancy_mulhh
                                                           (2 *
                                                            (let (x12, _) :=
                                                               xv in
                                                             x12)))%expr @
                                                       (#(Z_cast args6)%expr @
                                                        v
                                                          (Compile.reflect x5),
                                                       #(Z_cast args1)%expr @
                                                       v0
                                                         (Compile.reflect x10))))%expr_pat
                                                  else Datatypes.None);
                                          Datatypes.Some (Base x12));
                                   Datatypes.Some
                                     (fv0 <-- fv;
                                      Base fv0)%under_lets
                                  else Datatypes.None
                              | Datatypes.None => Datatypes.None
                              end
                          | (@expr.Ident _ _ _ t8 idc8 @ ($_)%expr)%expr_pat |
                            (@expr.Ident _ _ _ t8 idc8 @ @expr.Abs _ _ _ _ _
                             _)%expr_pat |
                            (@expr.Ident _ _ _ t8 idc8 @ (_ @ _))%expr_pat |
                            (@expr.Ident _ _ _ t8 idc8 @ @expr.LetIn _ _ _ _
                             _ _ _)%expr_pat => Datatypes.None
                          | _ => Datatypes.None
                          end
                      | @expr.App _ _ _ s9 _ ($_)%expr _ | @expr.App _ _ _ s9
                        _ (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _ _ s9 _
                        (_ @ _)%expr_pat _ | @expr.App _ _ _ s9 _
                        (@expr.LetIn _ _ _ _ _ _ _) _ => Datatypes.None
                      | _ => Datatypes.None
                      end
                  | (@expr.Ident _ _ _ t5 idc5 @ ($_)%expr)%expr_pat |
                    (@expr.Ident _ _ _ t5 idc5 @ @expr.Abs _ _ _ _ _ _)%expr_pat |
                    (@expr.Ident _ _ _ t5 idc5 @ (#(_) @ _))%expr_pat |
                    (@expr.Ident _ _ _ t5 idc5 @ (($_)%expr @ _))%expr_pat |
                    (@expr.Ident _ _ _ t5 idc5 @ (@expr.Abs _ _ _ _ _ _ @ _))%expr_pat |
                    (@expr.Ident _ _ _ t5 idc5 @ (($_)%expr @ _ @ _))%expr_pat |
                    (@expr.Ident _ _ _ t5 idc5 @
                     (@expr.Abs _ _ _ _ _ _ @ _ @ _))%expr_pat |
                    (@expr.Ident _ _ _ t5 idc5 @ (_ @ _ @ _ @ _))%expr_pat |
                    (@expr.Ident _ _ _ t5 idc5 @
                     (@expr.LetIn _ _ _ _ _ _ _ @ _ @ _))%expr_pat |
                    (@expr.Ident _ _ _ t5 idc5 @
                     (@expr.LetIn _ _ _ _ _ _ _ @ _))%expr_pat |
                    (@expr.Ident _ _ _ t5 idc5 @ @expr.LetIn _ _ _ _ _ _ _)%expr_pat =>
                      Datatypes.None
                  | _ => Datatypes.None
                  end
              | (@expr.Ident _ _ _ t3 idc3 @ ($_)%expr)%expr_pat |
                (@expr.Ident _ _ _ t3 idc3 @ @expr.Abs _ _ _ _ _ _)%expr_pat |
                (@expr.Ident _ _ _ t3 idc3 @ (_ @ _))%expr_pat |
                (@expr.Ident _ _ _ t3 idc3 @ @expr.LetIn _ _ _ _ _ _ _)%expr_pat =>
                  Datatypes.None
              | _ => Datatypes.None
              end
          | @expr.App _ _ _ s4 _ ($_)%expr _ | @expr.App _ _ _ s4 _
            (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _ _ s4 _ (_ @ _)%expr_pat
            _ | @expr.App _ _ _ s4 _ (@expr.LetIn _ _ _ _ _ _ _) _ =>
              Datatypes.None
          | _ => Datatypes.None
          end
      | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ ($_)%expr)%expr_pat) _ | @expr.App _ _
        _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ @expr.Abs _ _ _ _ _ _)%expr_pat) _ |
        @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ (#(_) @ _))%expr_pat) _ | @expr.App _ _
        _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ (($_)%expr @ _))%expr_pat) _ |
        @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ (@expr.Abs _ _ _ _ _ _ @ _))%expr_pat)
        _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ (($_)%expr @ _ @ _))%expr_pat) _ |
        @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ (@expr.Abs _ _ _ _ _ _ @ _ @ _))%expr_pat)
        _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ (_ @ _ @ _ @ _))%expr_pat) _ |
        @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ (@expr.LetIn _ _ _ _ _ _ _ @ _ @ _))%expr_pat)
        _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ (@expr.LetIn _ _ _ _ _ _ _ @ _))%expr_pat)
        _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Ident _ _ _ t0 idc0 @ @expr.LetIn _ _ _ _ _ _ _)%expr_pat)
        _ => Datatypes.None
      | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc) #(_)%expr_pat) _ |
        @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc) ($_)%expr) _ |
        @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Abs _ _ _ _ _ _)) _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (($_)%expr @ _)%expr_pat) _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.Abs _ _ _ _ _ _ @ _)%expr_pat) _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc) (_ @ _ @ _)%expr_pat)
        _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.LetIn _ _ _ _ _ _ _ @ _)%expr_pat) _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.Ident _ _ _ t idc)
         (@expr.LetIn _ _ _ _ _ _ _)) _ => Datatypes.None
      | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _ (@expr.Ident _ _ _ t idc) x2) x1) x0 =>
          match x2 with
          | (@expr.Ident _ _ _ t0 idc0 @
             (@expr.Ident _ _ _ t1 idc1 @ x5 @ x4))%expr_pat =>
              match x5 with
              | (@expr.Ident _ _ _ t2 idc2 @ @expr.Ident _ _ _ t3 idc3)%expr_pat =>
                  match x4 with
                  | @expr.App _ _ _ s6 _ (@expr.Ident _ _ _ t4 idc4) x7 =>
                      match x1 with
                      | @expr.App _ _ _ s7 _ (@expr.Ident _ _ _ t5 idc5)
                        x8 =>
                          match x0 with
                          | @expr.App _ _ _ s8 _ (@expr.Ident _ _ _ t6 idc6)
                            x9 =>
                              args <- invert_bind_args idc6 Raw.ident.Z_cast;
                              args0 <- invert_bind_args idc5 Raw.ident.Z_cast;
                              args1 <- invert_bind_args idc4 Raw.ident.Z_cast;
                              args2 <- invert_bind_args idc3
                                         Raw.ident.Literal;
                              args3 <- invert_bind_args idc2 Raw.ident.Z_cast;
                              _ <- invert_bind_args idc1 Raw.ident.Z_cc_m;
                              args5 <- invert_bind_args idc0 Raw.ident.Z_cast;
                              _ <- invert_bind_args idc Raw.ident.Z_zselect;
                              match
                                pattern.type.unify_extracted
                                  (((ℤ -> ℤ) -> ℤ) -> ℤ)%ptype
                                  ((((projT1 args2) -> s6) -> s7) -> s8)%ptype
                              with
                              | Datatypes.Some (_, _, _, _)%zrange =>
                                  if
                                   type.type_beq base.type base.type.type_beq
                                     (((ℤ -> ℤ) -> ℤ) -> ℤ)%ptype
                                     ((((projT1 args2) -> s6) -> s7) -> s8)%ptype
                                  then
                                   xv <- ident.unify pattern.ident.Literal
                                           ##(projT2 args2);
                                   v <- type.try_make_transport_cps s6 ℤ;
                                   v0 <- type.try_make_transport_cps s7 ℤ;
                                   v1 <- type.try_make_transport_cps s8 ℤ;
                                   fv <- (x10 <- (if
                                                   ((let (x10, _) := xv in
                                                     x10) =?
                                                    2
                                                    ^ Z.log2
                                                        (let (x10, _) :=
                                                           xv in
                                                         x10)) &&
                                                   ((ZRange.cc_m
                                                       (let (x10, _) := xv in
                                                        x10))
                                                      (ZRange.normalize args1) <=?
                                                    ZRange.normalize args5)%zrange &&
                                                   is_bounded_by_bool
                                                     (let (x10, _) := xv in
                                                      x10)
                                                     (ZRange.normalize args3)
                                                  then
                                                   Datatypes.Some
                                                     (#(Z_cast range)%expr @
                                                      (#(fancy_selm
                                                           (Z.log2
                                                              (let
                                                                 (x10, _) :=
                                                                 xv in
                                                               x10)))%expr @
                                                       (#(Z_cast args1)%expr @
                                                        v
                                                          (Compile.reflect x7),
                                                       #(Z_cast args0)%expr @
                                                       v0
                                                         (Compile.reflect x8),
                                                       #(Z_cast args)%expr @
                                                       v1
                                                         (Compile.reflect x9))))%expr_pat
                                                  else Datatypes.None);
                                          Datatypes.Some (Base x10));
                                   Datatypes.Some
                                     (fv0 <-- fv;
                                      Base fv0)%under_lets
                                  else Datatypes.None
                              | Datatypes.None => Datatypes.None
                              end
                          | @expr.App _ _ _ s8 _ ($_)%expr _ | @expr.App _ _
                            _ s8 _ (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _
                            _ s8 _ (_ @ _)%expr_pat _ | @expr.App _ _ _ s8 _
                            (@expr.LetIn _ _ _ _ _ _ _) _ => Datatypes.None
                          | _ => Datatypes.None
                          end
                      | @expr.App _ _ _ s7 _ ($_)%expr _ | @expr.App _ _ _ s7
                        _ (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _ _ s7 _
                        (_ @ _)%expr_pat _ | @expr.App _ _ _ s7 _
                        (@expr.LetIn _ _ _ _ _ _ _) _ => Datatypes.None
                      | _ => Datatypes.None
                      end
                  | @expr.App _ _ _ s6 _ ($_)%expr _ | @expr.App _ _ _ s6 _
                    (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _ _ s6 _
                    (_ @ _)%expr_pat _ | @expr.App _ _ _ s6 _
                    (@expr.LetIn _ _ _ _ _ _ _) _ => Datatypes.None
                  | _ => Datatypes.None
                  end
              | (@expr.Ident _ _ _ t2 idc2 @ ($_)%expr)%expr_pat |
                (@expr.Ident _ _ _ t2 idc2 @ @expr.Abs _ _ _ _ _ _)%expr_pat |
                (@expr.Ident _ _ _ t2 idc2 @ (_ @ _))%expr_pat |
                (@expr.Ident _ _ _ t2 idc2 @ @expr.LetIn _ _ _ _ _ _ _)%expr_pat =>
                  Datatypes.None
              | _ => Datatypes.None
              end;;
              match x5 with
              | @expr.App _ _ _ s5 _ (@expr.Ident _ _ _ t2 idc2) x6 =>
                  match x6 with
                  | @expr.Ident _ _ _ t3 idc3 =>
                      match x4 with
                      | @expr.App _ _ _ s6 _ (@expr.Ident _ _ _ t4 idc4)
                        x7 =>
                          match x1 with
                          | @expr.App _ _ _ s7 _ (@expr.Ident _ _ _ t5 idc5)
                            x8 =>
                              match x0 with
                              | @expr.App _ _ _ s8 _
                                (@expr.Ident _ _ _ t6 idc6) x9 =>
                                  args <- invert_bind_args idc6
                                            Raw.ident.Z_cast;
                                  args0 <- invert_bind_args idc5
                                             Raw.ident.Z_cast;
                                  args1 <- invert_bind_args idc4
                                             Raw.ident.Z_cast;
                                  args2 <- invert_bind_args idc3
                                             Raw.ident.Literal;
                                  args3 <- invert_bind_args idc2
                                             Raw.ident.Z_cast;
                                  _ <- invert_bind_args idc1 Raw.ident.Z_land;
                                  args5 <- invert_bind_args idc0
                                             Raw.ident.Z_cast;
                                  _ <- invert_bind_args idc
                                         Raw.ident.Z_zselect;
                                  match
                                    pattern.type.unify_extracted
                                      (((ℤ -> ℤ) -> ℤ) -> ℤ)%ptype
                                      ((((projT1 args2) -> s6) -> s7) -> s8)%ptype
                                  with
                                  | Datatypes.Some (_, _, _, _)%zrange =>
                                      if
                                       type.type_beq base.type
                                         base.type.type_beq
                                         (((ℤ -> ℤ) -> ℤ) -> ℤ)%ptype
                                         ((((projT1 args2) -> s6) -> s7) ->
                                          s8)%ptype
                                      then
                                       xv <- ident.unify
                                               pattern.ident.Literal
                                               ##(projT2 args2);
                                       v <- type.try_make_transport_cps s6 ℤ;
                                       v0 <- type.try_make_transport_cps s7 ℤ;
                                       v1 <- type.try_make_transport_cps s8 ℤ;
                                       fv <- (x10 <- (if
                                                       ((let (x10, _) :=
                                                           xv in
                                                         x10) =? 1) &&
                                                       (ZRange.normalize
                                                          (ZRange.constant
                                                             (let (x10, _) :=
                                                                xv in
                                                              x10)) &'
                                                        ZRange.normalize
                                                          args1 <=?
                                                        ZRange.normalize
                                                          args5)%zrange &&
                                                       is_bounded_by_bool
                                                         (let (x10, _) :=
                                                            xv in
                                                          x10)
                                                         (ZRange.normalize
                                                            args3)
                                                      then
                                                       Datatypes.Some
                                                         (#(Z_cast range)%expr @
                                                          (#(fancy_sell)%expr @
                                                           (#(Z_cast args1)%expr @
                                                            v
                                                              (Compile.reflect
                                                                 x7),
                                                           #(Z_cast args0)%expr @
                                                           v0
                                                             (Compile.reflect
                                                                x8),
                                                           #(Z_cast args)%expr @
                                                           v1
                                                             (Compile.reflect
                                                                x9))))%expr_pat
                                                      else Datatypes.None);
                                              Datatypes.Some (Base x10));
                                       Datatypes.Some
                                         (fv0 <-- fv;
                                          Base fv0)%under_lets
                                      else Datatypes.None
                                  | Datatypes.None => Datatypes.None
                                  end
                              | @expr.App _ _ _ s8 _ ($_)%expr _ | @expr.App
                                _ _ _ s8 _ (@expr.Abs _ _ _ _ _ _) _ |
                                @expr.App _ _ _ s8 _ (_ @ _)%expr_pat _ |
                                @expr.App _ _ _ s8 _
                                (@expr.LetIn _ _ _ _ _ _ _) _ =>
                                  Datatypes.None
                              | _ => Datatypes.None
                              end
                          | @expr.App _ _ _ s7 _ ($_)%expr _ | @expr.App _ _
                            _ s7 _ (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _
                            _ s7 _ (_ @ _)%expr_pat _ | @expr.App _ _ _ s7 _
                            (@expr.LetIn _ _ _ _ _ _ _) _ => Datatypes.None
                          | _ => Datatypes.None
                          end
                      | @expr.App _ _ _ s6 _ ($_)%expr _ | @expr.App _ _ _ s6
                        _ (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _ _ s6 _
                        (_ @ _)%expr_pat _ | @expr.App _ _ _ s6 _
                        (@expr.LetIn _ _ _ _ _ _ _) _ => Datatypes.None
                      | _ => Datatypes.None
                      end
                  | _ => Datatypes.None
                  end;;
                  match x4 with
                  | (@expr.Ident _ _ _ t3 idc3 @ @expr.Ident _ _ _ t4 idc4)%expr_pat =>
                      match x1 with
                      | @expr.App _ _ _ s7 _ (@expr.Ident _ _ _ t5 idc5)
                        x8 =>
                          match x0 with
                          | @expr.App _ _ _ s8 _ (@expr.Ident _ _ _ t6 idc6)
                            x9 =>
                              args <- invert_bind_args idc6 Raw.ident.Z_cast;
                              args0 <- invert_bind_args idc5 Raw.ident.Z_cast;
                              args1 <- invert_bind_args idc4
                                         Raw.ident.Literal;
                              args2 <- invert_bind_args idc3 Raw.ident.Z_cast;
                              args3 <- invert_bind_args idc2 Raw.ident.Z_cast;
                              _ <- invert_bind_args idc1 Raw.ident.Z_land;
                              args5 <- invert_bind_args idc0 Raw.ident.Z_cast;
                              _ <- invert_bind_args idc Raw.ident.Z_zselect;
                              match
                                pattern.type.unify_extracted
                                  (((ℤ -> ℤ) -> ℤ) -> ℤ)%ptype
                                  (((s5 -> (projT1 args1)) -> s7) -> s8)%ptype
                              with
                              | Datatypes.Some (_, _, _, _)%zrange =>
                                  if
                                   type.type_beq base.type base.type.type_beq
                                     (((ℤ -> ℤ) -> ℤ) -> ℤ)%ptype
                                     (((s5 -> (projT1 args1)) -> s7) -> s8)%ptype
                                  then
                                   v <- type.try_make_transport_cps s5 ℤ;
                                   xv <- ident.unify pattern.ident.Literal
                                           ##(projT2 args1);
                                   v0 <- type.try_make_transport_cps s7 ℤ;
                                   v1 <- type.try_make_transport_cps s8 ℤ;
                                   fv <- (x10 <- (if
                                                   ((let (x10, _) := xv in
                                                     x10) =? 1) &&
                                                   (ZRange.normalize args3 &'
                                                    ZRange.normalize
                                                      (ZRange.constant
                                                         (let (x10, _) :=
                                                            xv in
                                                          x10)) <=?
                                                    ZRange.normalize args5)%zrange &&
                                                   is_bounded_by_bool
                                                     (let (x10, _) := xv in
                                                      x10)
                                                     (ZRange.normalize args2)
                                                  then
                                                   Datatypes.Some
                                                     (#(Z_cast range)%expr @
                                                      (#(fancy_sell)%expr @
                                                       (#(Z_cast args3)%expr @
                                                        v
                                                          (Compile.reflect x6),
                                                       #(Z_cast args0)%expr @
                                                       v0
                                                         (Compile.reflect x8),
                                                       #(Z_cast args)%expr @
                                                       v1
                                                         (Compile.reflect x9))))%expr_pat
                                                  else Datatypes.None);
                                          Datatypes.Some (Base x10));
                                   Datatypes.Some
                                     (fv0 <-- fv;
                                      Base fv0)%under_lets
                                  else Datatypes.None
                              | Datatypes.None => Datatypes.None
                              end
                          | @expr.App _ _ _ s8 _ ($_)%expr _ | @expr.App _ _
                            _ s8 _ (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _
                            _ s8 _ (_ @ _)%expr_pat _ | @expr.App _ _ _ s8 _
                            (@expr.LetIn _ _ _ _ _ _ _) _ => Datatypes.None
                          | _ => Datatypes.None
                          end
                      | @expr.App _ _ _ s7 _ ($_)%expr _ | @expr.App _ _ _ s7
                        _ (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _ _ s7 _
                        (_ @ _)%expr_pat _ | @expr.App _ _ _ s7 _
                        (@expr.LetIn _ _ _ _ _ _ _) _ => Datatypes.None
                      | _ => Datatypes.None
                      end
                  | (@expr.Ident _ _ _ t3 idc3 @ ($_)%expr)%expr_pat |
                    (@expr.Ident _ _ _ t3 idc3 @ @expr.Abs _ _ _ _ _ _)%expr_pat |
                    (@expr.Ident _ _ _ t3 idc3 @ (_ @ _))%expr_pat |
                    (@expr.Ident _ _ _ t3 idc3 @ @expr.LetIn _ _ _ _ _ _ _)%expr_pat =>
                      Datatypes.None
                  | _ => Datatypes.None
                  end
              | @expr.App _ _ _ s5 _ ($_)%expr _ | @expr.App _ _ _ s5 _
                (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _ _ s5 _
                (_ @ _)%expr_pat _ | @expr.App _ _ _ s5 _
                (@expr.LetIn _ _ _ _ _ _ _) _ => Datatypes.None
              | _ => Datatypes.None
              end
          | (@expr.Ident _ _ _ t0 idc0 @ #(_))%expr_pat |
            (@expr.Ident _ _ _ t0 idc0 @ ($_)%expr)%expr_pat |
            (@expr.Ident _ _ _ t0 idc0 @ @expr.Abs _ _ _ _ _ _)%expr_pat |
            (@expr.Ident _ _ _ t0 idc0 @ (#(_) @ _))%expr_pat |
            (@expr.Ident _ _ _ t0 idc0 @ (($_)%expr @ _))%expr_pat |
            (@expr.Ident _ _ _ t0 idc0 @ (@expr.Abs _ _ _ _ _ _ @ _))%expr_pat |
            (@expr.Ident _ _ _ t0 idc0 @ (($_)%expr @ _ @ _))%expr_pat |
            (@expr.Ident _ _ _ t0 idc0 @ (@expr.Abs _ _ _ _ _ _ @ _ @ _))%expr_pat |
            (@expr.Ident _ _ _ t0 idc0 @ (_ @ _ @ _ @ _))%expr_pat |
            (@expr.Ident _ _ _ t0 idc0 @ (@expr.LetIn _ _ _ _ _ _ _ @ _ @ _))%expr_pat |
            (@expr.Ident _ _ _ t0 idc0 @ (@expr.LetIn _ _ _ _ _ _ _ @ _))%expr_pat |
            (@expr.Ident _ _ _ t0 idc0 @ @expr.LetIn _ _ _ _ _ _ _)%expr_pat =>
              Datatypes.None
          | _ => Datatypes.None
          end;;
          _ <- invert_bind_args idc Raw.ident.Z_zselect;
          match
            pattern.type.unify_extracted ((ℤ -> ℤ) -> ℤ)%ptype
              ((s1 -> s0) -> s)%ptype
          with
          | Datatypes.Some (_, _, _)%zrange =>
              if
               type.type_beq base.type base.type.type_beq
                 ((ℤ -> ℤ) -> ℤ)%ptype ((s1 -> s0) -> s)%ptype
              then
               v <- type.try_make_transport_cps s1 ℤ;
               v0 <- type.try_make_transport_cps s0 ℤ;
               v1 <- type.try_make_transport_cps s ℤ;
               Datatypes.Some
                 (Base
                    (#(Z_cast range)%expr @
                     (#(fancy_selc)%expr @
                      (v (Compile.reflect x2), v0 (Compile.reflect x1),
                      v1 (Compile.reflect x0))))%expr_pat)
              else Datatypes.None
          | Datatypes.None => Datatypes.None
          end
      | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          (@expr.App _ _ _ s4 _ (@expr.Ident _ _ _ t2 idc2) x5))
         (@expr.App _ _ _ s5 _ (@expr.Ident _ _ _ t3 idc3) x6))
        (@expr.Ident _ _ _ t4 idc4 @ @expr.Ident _ _ _ t5 idc5)%expr_pat =>
          args <- invert_bind_args idc5 Raw.ident.Literal;
          args0 <- invert_bind_args idc4 Raw.ident.Z_cast;
          args1 <- invert_bind_args idc3 Raw.ident.Z_cast;
          args2 <- invert_bind_args idc2 Raw.ident.Z_cast;
          args3 <- invert_bind_args idc1 Raw.ident.Literal;
          args4 <- invert_bind_args idc0 Raw.ident.Z_cast;
          _ <- invert_bind_args idc Raw.ident.Z_rshi;
          match
            pattern.type.unify_extracted (((ℤ -> ℤ) -> ℤ) -> ℤ)%ptype
              ((((projT1 args3) -> s4) -> s5) -> (projT1 args))%ptype
          with
          | Datatypes.Some (_, _, _, _)%zrange =>
              if
               type.type_beq base.type base.type.type_beq
                 (((ℤ -> ℤ) -> ℤ) -> ℤ)%ptype
                 ((((projT1 args3) -> s4) -> s5) -> (projT1 args))%ptype
              then
               xv <- ident.unify pattern.ident.Literal ##(projT2 args3);
               v <- type.try_make_transport_cps s4 ℤ;
               v0 <- type.try_make_transport_cps s5 ℤ;
               xv0 <- ident.unify pattern.ident.Literal ##(projT2 args);
               fv <- (x8 <- (if
                              ((let (x8, _) := xv in x8) =?
                               2 ^ Z.log2 (let (x8, _) := xv in x8)) &&
                              is_bounded_by_bool (let (x8, _) := xv in x8)
                                (ZRange.normalize args4) &&
                              is_bounded_by_bool (let (x8, _) := xv0 in x8)
                                (ZRange.normalize args0)
                             then
                              Datatypes.Some
                                (#(Z_cast range)%expr @
                                 (#(fancy_rshi
                                      (Z.log2 (let (x8, _) := xv in x8))
                                      (let (x8, _) := xv0 in x8))%expr @
                                  (#(Z_cast args2)%expr @
                                   v (Compile.reflect x5),
                                  #(Z_cast args1)%expr @
                                  v0 (Compile.reflect x6))))%expr_pat
                             else Datatypes.None);
                      Datatypes.Some (Base x8));
               Datatypes.Some (fv0 <-- fv;
                               Base fv0)%under_lets
              else Datatypes.None
          | Datatypes.None => Datatypes.None
          end
      | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          (@expr.App _ _ _ s4 _ (@expr.Ident _ _ _ t2 idc2) x5))
         (@expr.App _ _ _ s5 _ (@expr.Ident _ _ _ t3 idc3) x6))
        (@expr.Ident _ _ _ t4 idc4 @ ($_)%expr)%expr_pat | @expr.App _ _ _ s
        _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          (@expr.App _ _ _ s4 _ (@expr.Ident _ _ _ t2 idc2) x5))
         (@expr.App _ _ _ s5 _ (@expr.Ident _ _ _ t3 idc3) x6))
        (@expr.Ident _ _ _ t4 idc4 @ @expr.Abs _ _ _ _ _ _)%expr_pat |
        @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          (@expr.App _ _ _ s4 _ (@expr.Ident _ _ _ t2 idc2) x5))
         (@expr.App _ _ _ s5 _ (@expr.Ident _ _ _ t3 idc3) x6))
        (@expr.Ident _ _ _ t4 idc4 @ (_ @ _))%expr_pat | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          (@expr.App _ _ _ s4 _ (@expr.Ident _ _ _ t2 idc2) x5))
         (@expr.App _ _ _ s5 _ (@expr.Ident _ _ _ t3 idc3) x6))
        (@expr.Ident _ _ _ t4 idc4 @ @expr.LetIn _ _ _ _ _ _ _)%expr_pat =>
          Datatypes.None
      | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          (@expr.App _ _ _ s4 _ (@expr.Ident _ _ _ t2 idc2) x5))
         (@expr.App _ _ _ s5 _ (@expr.Ident _ _ _ t3 idc3) x6))
        #(_)%expr_pat | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          (@expr.App _ _ _ s4 _ (@expr.Ident _ _ _ t2 idc2) x5))
         (@expr.App _ _ _ s5 _ (@expr.Ident _ _ _ t3 idc3) x6)) ($_)%expr |
        @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          (@expr.App _ _ _ s4 _ (@expr.Ident _ _ _ t2 idc2) x5))
         (@expr.App _ _ _ s5 _ (@expr.Ident _ _ _ t3 idc3) x6))
        (@expr.Abs _ _ _ _ _ _) | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          (@expr.App _ _ _ s4 _ (@expr.Ident _ _ _ t2 idc2) x5))
         (@expr.App _ _ _ s5 _ (@expr.Ident _ _ _ t3 idc3) x6))
        (($_)%expr @ _)%expr_pat | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          (@expr.App _ _ _ s4 _ (@expr.Ident _ _ _ t2 idc2) x5))
         (@expr.App _ _ _ s5 _ (@expr.Ident _ _ _ t3 idc3) x6))
        (@expr.Abs _ _ _ _ _ _ @ _)%expr_pat | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          (@expr.App _ _ _ s4 _ (@expr.Ident _ _ _ t2 idc2) x5))
         (@expr.App _ _ _ s5 _ (@expr.Ident _ _ _ t3 idc3) x6))
        (_ @ _ @ _)%expr_pat | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          (@expr.App _ _ _ s4 _ (@expr.Ident _ _ _ t2 idc2) x5))
         (@expr.App _ _ _ s5 _ (@expr.Ident _ _ _ t3 idc3) x6))
        (@expr.LetIn _ _ _ _ _ _ _ @ _)%expr_pat | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          (@expr.App _ _ _ s4 _ (@expr.Ident _ _ _ t2 idc2) x5))
         (@expr.App _ _ _ s5 _ (@expr.Ident _ _ _ t3 idc3) x6))
        (@expr.LetIn _ _ _ _ _ _ _) => Datatypes.None
      | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          (@expr.App _ _ _ s4 _ (@expr.Ident _ _ _ t2 idc2) x5))
         (@expr.App _ _ _ s5 _ ($_)%expr _)) _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          (@expr.App _ _ _ s4 _ (@expr.Ident _ _ _ t2 idc2) x5))
         (@expr.App _ _ _ s5 _ (@expr.Abs _ _ _ _ _ _) _)) _ | @expr.App _ _
        _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          (@expr.App _ _ _ s4 _ (@expr.Ident _ _ _ t2 idc2) x5))
         (@expr.App _ _ _ s5 _ (_ @ _)%expr_pat _)) _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          (@expr.App _ _ _ s4 _ (@expr.Ident _ _ _ t2 idc2) x5))
         (@expr.App _ _ _ s5 _ (@expr.LetIn _ _ _ _ _ _ _) _)) _ =>
          Datatypes.None
      | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          (@expr.App _ _ _ s4 _ (@expr.Ident _ _ _ t2 idc2) x5))
         #(_)%expr_pat) _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          (@expr.App _ _ _ s4 _ (@expr.Ident _ _ _ t2 idc2) x5)) ($_)%expr)
        _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          (@expr.App _ _ _ s4 _ (@expr.Ident _ _ _ t2 idc2) x5))
         (@expr.Abs _ _ _ _ _ _)) _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          (@expr.App _ _ _ s4 _ (@expr.Ident _ _ _ t2 idc2) x5))
         (@expr.LetIn _ _ _ _ _ _ _)) _ => Datatypes.None
      | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          (@expr.App _ _ _ s4 _ ($_)%expr _)) _) _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          (@expr.App _ _ _ s4 _ (@expr.Abs _ _ _ _ _ _) _)) _) _ | @expr.App
        _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          (@expr.App _ _ _ s4 _ (_ @ _)%expr_pat _)) _) _ | @expr.App _ _ _ s
        _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          (@expr.App _ _ _ s4 _ (@expr.LetIn _ _ _ _ _ _ _) _)) _) _ =>
          Datatypes.None
      | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          #(_)%expr_pat) _) _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          ($_)%expr) _) _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          (@expr.Abs _ _ _ _ _ _)) _) _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1))%expr_pat
          (@expr.LetIn _ _ _ _ _ _ _)) _) _ => Datatypes.None
      | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @ (@expr.Ident _ _ _ t0 idc0 @ ($_)%expr))%expr_pat
          _) _) _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.Abs _ _ _ _ _ _))%expr_pat _)
         _) _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @ (@expr.Ident _ _ _ t0 idc0 @ (_ @ _)))%expr_pat
          _) _) _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @
           (@expr.Ident _ _ _ t0 idc0 @ @expr.LetIn _ _ _ _ _ _ _))%expr_pat
          _) _) _ => Datatypes.None
      | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _ (@expr.Ident _ _ _ t idc @ #(_))%expr_pat _)
         _) _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _ (@expr.Ident _ _ _ t idc @ ($_)%expr)%expr_pat
          _) _) _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @ @expr.Abs _ _ _ _ _ _)%expr_pat _) _)
        _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @ (($_)%expr @ _))%expr_pat _) _) _ |
        @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @ (@expr.Abs _ _ _ _ _ _ @ _))%expr_pat _)
         _) _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @ (_ @ _ @ _))%expr_pat _) _) _ |
        @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @ (@expr.LetIn _ _ _ _ _ _ _ @ _))%expr_pat
          _) _) _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _
          (@expr.Ident _ _ _ t idc @ @expr.LetIn _ _ _ _ _ _ _)%expr_pat _)
         _) _ => Datatypes.None
      | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.App _ _ _ s1 _ ($_)%expr _) _) _ |
        @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _ (@expr.Abs _ _ _ _ _ _) _) _) _ | @expr.App _
        _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _ (($_)%expr @ _)%expr_pat _) _) _ | @expr.App _
        _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _ (@expr.Abs _ _ _ _ _ _ @ _)%expr_pat _) _) _ |
        @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.App _ _ _ s1 _ (_ @ _ @ _)%expr_pat _)
         _) _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _ (@expr.LetIn _ _ _ _ _ _ _ @ _)%expr_pat _) _)
        _ | @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _
         (@expr.App _ _ _ s1 _ (@expr.LetIn _ _ _ _ _ _ _) _) _) _ =>
          Datatypes.None
      | @expr.App _ _ _ s _ (@expr.App _ _ _ s0 _ ($_)%expr _) _ | @expr.App
        _ _ _ s _ (@expr.App _ _ _ s0 _ (@expr.Abs _ _ _ _ _ _) _) _ |
        @expr.App _ _ _ s _
        (@expr.App _ _ _ s0 _ (@expr.LetIn _ _ _ _ _ _ _) _) _ =>
          Datatypes.None
      | @expr.App _ _ _ s _ #(_)%expr_pat _ | @expr.App _ _ _ s _ ($_)%expr
        _ | @expr.App _ _ _ s _ (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _ _ s
        _ (@expr.LetIn _ _ _ _ _ _ _) _ => Datatypes.None
      | _ => Datatypes.None
      end;;
      match pattern.type.unify_extracted ℤ ℤ with
      | Datatypes.Some _ =>
          if type.type_beq base.type base.type.type_beq ℤ ℤ
          then
           fv <- (x0 <- (if
                          (range <=? value_range)%zrange
                          || (range <=? flag_range)%zrange
                         then
                          Datatypes.Some (#(Z_cast range)%expr @ x)%expr_pat
                         else Datatypes.None);
                  Datatypes.Some (Base x0));
           Datatypes.Some (fv0 <-- fv;
                           Base fv0)%under_lets
          else Datatypes.None
      | Datatypes.None => Datatypes.None
      end);;;
     Base (#(Z_cast range)%expr @ x)%expr_pat)%option
| Z_cast2 range =>
    fun x : expr (ℤ * ℤ)%etype =>
    ((match x with
      | (@expr.Ident _ _ _ t idc @ x2 @ x1 @ x0)%expr_pat =>
          match x2 with
          | (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1)%expr_pat =>
              match x1 with
              | @expr.App _ _ _ s3 _ (@expr.Ident _ _ _ t2 idc2) x4 =>
                  match x0 with
                  | @expr.App _ _ _ s4 _ (@expr.Ident _ _ _ t3 idc3) x5 =>
                      match x5 with
                      | (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                            idc9))) @
                         (@expr.Ident _ _ _ t10 idc10 @ @expr.Ident _ _ _ t11
                          idc11))%expr_pat =>
                          args <- invert_bind_args idc11 Raw.ident.Literal;
                          args0 <- invert_bind_args idc10 Raw.ident.Z_cast;
                          args1 <- invert_bind_args idc9 Raw.ident.Literal;
                          args2 <- invert_bind_args idc8 Raw.ident.Z_cast;
                          args3 <- invert_bind_args idc7 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc6 Raw.ident.Z_land;
                          args5 <- invert_bind_args idc5 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc4 Raw.ident.Z_shiftl;
                          args7 <- invert_bind_args idc3 Raw.ident.Z_cast;
                          args8 <- invert_bind_args idc2 Raw.ident.Z_cast;
                          args9 <- invert_bind_args idc1 Raw.ident.Literal;
                          args10 <- invert_bind_args idc0 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc Raw.ident.Z_add_get_carry;
                          match
                            pattern.type.unify_extracted
                              ((ℤ -> ℤ) -> (ℤ -> ℤ) -> ℤ)%ptype
                              (((projT1 args9) -> s3) ->
                               (s10 -> (projT1 args1)) -> (projT1 args))%ptype
                          with
                          | Datatypes.Some (_, _, (_, _, _))%zrange =>
                              if
                               type.type_beq base.type base.type.type_beq
                                 ((ℤ -> ℤ) -> (ℤ -> ℤ) -> ℤ)%ptype
                                 (((projT1 args9) -> s3) ->
                                  (s10 -> (projT1 args1)) -> (projT1 args))%ptype
                              then
                               xv <- ident.unify pattern.ident.Literal
                                       ##(projT2 args9);
                               v <- type.try_make_transport_cps s3 ℤ;
                               v0 <- type.try_make_transport_cps s10 ℤ;
                               xv0 <- ident.unify pattern.ident.Literal
                                        ##(projT2 args1);
                               xv1 <- ident.unify pattern.ident.Literal
                                        ##(projT2 args);
                               fv <- (x14 <- (let
                                              '(r1, r2)%zrange := range in
                                               fun (rs : zrange) (s13 : Z)
                                                 (rx : zrange) (x14 : expr ℤ)
                                                 (rshiftl rland ry : zrange)
                                                 (y : expr ℤ)
                                                 (rmask : zrange) (mask : Z)
                                                 (roffset : zrange)
                                                 (offset : Z) =>
                                               if
                                                (s13 =? 2 ^ Z.log2 s13) &&
                                                (ZRange.normalize rland <<
                                                 ZRange.normalize
                                                   (ZRange.constant offset) <=?
                                                 ZRange.normalize rshiftl)%zrange &&
                                                (ZRange.normalize ry &'
                                                 ZRange.normalize
                                                   (ZRange.constant mask) <=?
                                                 ZRange.normalize rland)%zrange &&
                                                (ZRange.normalize rshiftl <=?
                                                 r[0 ~> s13 - 1])%zrange &&
                                                (mask =?
                                                 Z.ones (Z.log2 s13 - offset)) &&
                                                (0 <=? offset) &&
                                                (offset <=? Z.log2 s13) &&
                                                is_bounded_by_bool s13
                                                  (ZRange.normalize rs) &&
                                                is_bounded_by_bool mask
                                                  (ZRange.normalize rmask) &&
                                                is_bounded_by_bool offset
                                                  (ZRange.normalize roffset)
                                               then
                                                Datatypes.Some
                                                  (#(Z_cast2 (r1, r2))%expr @
                                                   (#(fancy_add (Z.log2 s13)
                                                        offset)%expr @
                                                    (#(Z_cast rx)%expr @ x14,
                                                    #(Z_cast ry)%expr @ y)))%expr_pat
                                               else Datatypes.None) args10
                                               (let (x14, _) := xv in x14)
                                               args8 (v (Compile.reflect x4))
                                               args7 args5 args3
                                               (v0 (Compile.reflect x11))
                                               args2
                                               (let (x14, _) := xv0 in x14)
                                               args0
                                               (let (x14, _) := xv1 in x14);
                                      Datatypes.Some (Base x14));
                               Datatypes.Some
                                 (fv0 <-- fv;
                                  Base fv0)%under_lets
                              else Datatypes.None
                          | Datatypes.None => Datatypes.None
                          end
                      | (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                            idc9))) @
                         (@expr.Ident _ _ _ t10 idc10 @ ($_)%expr))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                            idc9))) @
                         (@expr.Ident _ _ _ t10 idc10 @ @expr.Abs _ _ _ _ _ _))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                            idc9))) @ (@expr.Ident _ _ _ t10 idc10 @ (_ @ _)))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                            idc9))) @
                         (@expr.Ident _ _ _ t10 idc10 @ @expr.LetIn _ _ _ _ _
                          _ _))%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                            idc9))) @ #(_))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                            idc9))) @ ($_)%expr)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                            idc9))) @ @expr.Abs _ _ _ _ _ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                            idc9))) @ (($_)%expr @ _))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                            idc9))) @ (@expr.Abs _ _ _ _ _ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                            idc9))) @ (_ @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                            idc9))) @ (@expr.LetIn _ _ _ _ _ _ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                            idc9))) @ @expr.LetIn _ _ _ _ _ _ _)%expr_pat =>
                          Datatypes.None
                      | (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ ($_)%expr))) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Abs _ _ _ _ _ _))) @
                         _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ (_ @ _)))) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.LetIn _ _ _ _ _
                            _ _))) @ _)%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @ #(_))) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @ ($_)%expr)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @ @expr.Abs _ _ _
                           _ _ _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @ (($_)%expr @ _))) @
                         _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Abs _ _ _ _ _ _ @ _))) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @ (_ @ _ @ _))) @
                         _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.LetIn _ _ _ _ _ _ _ @ _))) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @ @expr.LetIn _ _
                           _ _ _ _ _)) @ _)%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           ($_)%expr _ @ _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Abs _ _ _ _ _ _) _ @ _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (_ @ _) _ @ _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.LetIn _ _ _ _ _ _ _) _ @ _)) @ _)%expr_pat =>
                          Datatypes.None
                      | (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ #(_) @ _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ ($_)%expr @ _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.Abs _ _ _ _ _ _ @
                           _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.LetIn _ _ _ _ _
                           _ _ @ _)) @ _)%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @ #(_)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @ ($_)%expr) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @ @expr.Abs _ _ _ _ _ _) @
                         _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @ (#(_) @ _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @ (($_)%expr @ _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Abs _ _ _ _ _ _ @ _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @ (($_)%expr @ _ @ _)) @
                         _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Abs _ _ _ _ _ _ @ _ @ _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @ (_ @ _ @ _ @ _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.LetIn _ _ _ _ _ _ _ @ _ @ _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.LetIn _ _ _ _ _ _ _ @ _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @ @expr.LetIn _ _ _ _ _ _
                          _) @ _)%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t4 idc4 @ #(_) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ ($_)%expr @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.Abs _ _ _ _ _ _ @
                         _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ (($_)%expr @ _) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Abs _ _ _ _ _ _ @ _) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ (_ @ _ @ _) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.LetIn _ _ _ _ _ _ _ @ _) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.LetIn _ _ _ _ _ _
                         _ @ _)%expr_pat => Datatypes.None
                      | _ => Datatypes.None
                      end;;
                      match x4 with
                      | (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                            idc9))) @
                         (@expr.Ident _ _ _ t10 idc10 @ @expr.Ident _ _ _ t11
                          idc11))%expr_pat =>
                          args <- invert_bind_args idc11 Raw.ident.Literal;
                          args0 <- invert_bind_args idc10 Raw.ident.Z_cast;
                          args1 <- invert_bind_args idc9 Raw.ident.Literal;
                          args2 <- invert_bind_args idc8 Raw.ident.Z_cast;
                          args3 <- invert_bind_args idc7 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc6 Raw.ident.Z_land;
                          args5 <- invert_bind_args idc5 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc4 Raw.ident.Z_shiftl;
                          args7 <- invert_bind_args idc3 Raw.ident.Z_cast;
                          args8 <- invert_bind_args idc2 Raw.ident.Z_cast;
                          args9 <- invert_bind_args idc1 Raw.ident.Literal;
                          args10 <- invert_bind_args idc0 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc Raw.ident.Z_add_get_carry;
                          match
                            pattern.type.unify_extracted
                              ((ℤ -> (ℤ -> ℤ) -> ℤ) -> ℤ)%ptype
                              (((projT1 args9) ->
                                (s10 -> (projT1 args1)) -> (projT1 args)) ->
                               s4)%ptype
                          with
                          | Datatypes.Some (_, (_, _, _), _)%zrange =>
                              if
                               type.type_beq base.type base.type.type_beq
                                 ((ℤ -> (ℤ -> ℤ) -> ℤ) -> ℤ)%ptype
                                 (((projT1 args9) ->
                                   (s10 -> (projT1 args1)) -> (projT1 args)) ->
                                  s4)%ptype
                              then
                               xv <- ident.unify pattern.ident.Literal
                                       ##(projT2 args9);
                               v <- type.try_make_transport_cps s10 ℤ;
                               xv0 <- ident.unify pattern.ident.Literal
                                        ##(projT2 args1);
                               xv1 <- ident.unify pattern.ident.Literal
                                        ##(projT2 args);
                               v0 <- type.try_make_transport_cps s4 ℤ;
                               fv <- (x14 <- (let
                                              '(r1, r2)%zrange := range in
                                               fun (rs : zrange) (s13 : Z)
                                                 (rshiftl rland ry : zrange)
                                                 (y : expr ℤ)
                                                 (rmask : zrange) (mask : Z)
                                                 (roffset : zrange)
                                                 (offset : Z) (rx : zrange)
                                                 (x14 : expr ℤ) =>
                                               if
                                                (s13 =? 2 ^ Z.log2 s13) &&
                                                (ZRange.normalize rland <<
                                                 ZRange.normalize
                                                   (ZRange.constant offset) <=?
                                                 ZRange.normalize rshiftl)%zrange &&
                                                (ZRange.normalize ry &'
                                                 ZRange.normalize
                                                   (ZRange.constant mask) <=?
                                                 ZRange.normalize rland)%zrange &&
                                                (ZRange.normalize rshiftl <=?
                                                 r[0 ~> s13 - 1])%zrange &&
                                                (mask =?
                                                 Z.ones (Z.log2 s13 - offset)) &&
                                                (0 <=? offset) &&
                                                (offset <=? Z.log2 s13) &&
                                                is_bounded_by_bool s13
                                                  (ZRange.normalize rs) &&
                                                is_bounded_by_bool mask
                                                  (ZRange.normalize rmask) &&
                                                is_bounded_by_bool offset
                                                  (ZRange.normalize roffset)
                                               then
                                                Datatypes.Some
                                                  (#(Z_cast2 (r1, r2))%expr @
                                                   (#(fancy_add (Z.log2 s13)
                                                        offset)%expr @
                                                    (#(Z_cast rx)%expr @ x14,
                                                    #(Z_cast ry)%expr @ y)))%expr_pat
                                               else Datatypes.None) args10
                                               (let (x14, _) := xv in x14)
                                               args8 args5 args3
                                               (v (Compile.reflect x11))
                                               args2
                                               (let (x14, _) := xv0 in x14)
                                               args0
                                               (let (x14, _) := xv1 in x14)
                                               args7
                                               (v0 (Compile.reflect x5));
                                      Datatypes.Some (Base x14));
                               Datatypes.Some
                                 (fv0 <-- fv;
                                  Base fv0)%under_lets
                              else Datatypes.None
                          | Datatypes.None => Datatypes.None
                          end
                      | (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                            idc9))) @
                         (@expr.Ident _ _ _ t10 idc10 @ ($_)%expr))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                            idc9))) @
                         (@expr.Ident _ _ _ t10 idc10 @ @expr.Abs _ _ _ _ _ _))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                            idc9))) @ (@expr.Ident _ _ _ t10 idc10 @ (_ @ _)))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                            idc9))) @
                         (@expr.Ident _ _ _ t10 idc10 @ @expr.LetIn _ _ _ _ _
                          _ _))%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                            idc9))) @ #(_))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                            idc9))) @ ($_)%expr)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                            idc9))) @ @expr.Abs _ _ _ _ _ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                            idc9))) @ (($_)%expr @ _))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                            idc9))) @ (@expr.Abs _ _ _ _ _ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                            idc9))) @ (_ @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                            idc9))) @ (@expr.LetIn _ _ _ _ _ _ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _ t9
                            idc9))) @ @expr.LetIn _ _ _ _ _ _ _)%expr_pat =>
                          Datatypes.None
                      | (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ ($_)%expr))) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.Abs _ _ _ _ _ _))) @
                         _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ (_ @ _)))) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Ident _ _ _ t8 idc8 @ @expr.LetIn _ _ _ _ _
                            _ _))) @ _)%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @ #(_))) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @ ($_)%expr)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @ @expr.Abs _ _ _
                           _ _ _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @ (($_)%expr @ _))) @
                         _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.Abs _ _ _ _ _ _ @ _))) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @ (_ @ _ @ _))) @
                         _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @
                           (@expr.LetIn _ _ _ _ _ _ _ @ _))) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Ident _ _ _ t7 idc7) x11 @ @expr.LetIn _ _
                           _ _ _ _ _)) @ _)%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           ($_)%expr _ @ _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.Abs _ _ _ _ _ _) _ @ _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (_ @ _) _ @ _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10 _
                           (@expr.LetIn _ _ _ _ _ _ _) _ @ _)) @ _)%expr_pat =>
                          Datatypes.None
                      | (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ #(_) @ _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ ($_)%expr @ _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.Abs _ _ _ _ _ _ @
                           _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Ident _ _ _ t6 idc6 @ @expr.LetIn _ _ _ _ _
                           _ _ @ _)) @ _)%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @ #(_)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @ ($_)%expr) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @ @expr.Abs _ _ _ _ _ _) @
                         _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @ (#(_) @ _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @ (($_)%expr @ _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Abs _ _ _ _ _ _ @ _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @ (($_)%expr @ _ @ _)) @
                         _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.Abs _ _ _ _ _ _ @ _ @ _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @ (_ @ _ @ _ @ _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.LetIn _ _ _ _ _ _ _ @ _ @ _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @
                          (@expr.LetIn _ _ _ _ _ _ _ @ _)) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Ident _ _ _ t5 idc5 @ @expr.LetIn _ _ _ _ _ _
                          _) @ _)%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t4 idc4 @ #(_) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ ($_)%expr @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.Abs _ _ _ _ _ _ @
                         _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ (($_)%expr @ _) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.Abs _ _ _ _ _ _ @ _) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ (_ @ _ @ _) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @
                         (@expr.LetIn _ _ _ _ _ _ _ @ _) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.LetIn _ _ _ _ _ _
                         _ @ _)%expr_pat => Datatypes.None
                      | _ => Datatypes.None
                      end;;
                      match x5 with
                      | (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Ident _ _ _ t5 idc5) x8 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.Ident _ _ _ t7
                          idc7))%expr_pat =>
                          args <- invert_bind_args idc7 Raw.ident.Literal;
                          args0 <- invert_bind_args idc6 Raw.ident.Z_cast;
                          args1 <- invert_bind_args idc5 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc4 Raw.ident.Z_shiftr;
                          args3 <- invert_bind_args idc3 Raw.ident.Z_cast;
                          args4 <- invert_bind_args idc2 Raw.ident.Z_cast;
                          args5 <- invert_bind_args idc1 Raw.ident.Literal;
                          args6 <- invert_bind_args idc0 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc Raw.ident.Z_add_get_carry;
                          match
                            pattern.type.unify_extracted
                              ((ℤ -> ℤ) -> ℤ -> ℤ)%ptype
                              (((projT1 args5) -> s3) -> s7 -> (projT1 args))%ptype
                          with
                          | Datatypes.Some (_, _, (_, _))%zrange =>
                              if
                               type.type_beq base.type base.type.type_beq
                                 ((ℤ -> ℤ) -> ℤ -> ℤ)%ptype
                                 (((projT1 args5) -> s3) ->
                                  s7 -> (projT1 args))%ptype
                              then
                               xv <- ident.unify pattern.ident.Literal
                                       ##(projT2 args5);
                               v <- type.try_make_transport_cps s3 ℤ;
                               v0 <- type.try_make_transport_cps s7 ℤ;
                               xv0 <- ident.unify pattern.ident.Literal
                                        ##(projT2 args);
                               fv <- (x10 <- (let
                                              '(r1, r2)%zrange := range in
                                               fun (rs : zrange) (s9 : Z)
                                                 (rx : zrange) (x10 : expr ℤ)
                                                 (rshiftr ry : zrange)
                                                 (y : expr ℤ)
                                                 (roffset : zrange)
                                                 (offset : Z) =>
                                               if
                                                (s9 =? 2 ^ Z.log2 s9) &&
                                                (ZRange.normalize ry >>
                                                 ZRange.normalize
                                                   (ZRange.constant offset) <=?
                                                 ZRange.normalize rshiftr)%zrange &&
                                                (ZRange.normalize rshiftr <=?
                                                 r[0 ~> s9 - 1])%zrange &&
                                                is_bounded_by_bool s9
                                                  (ZRange.normalize rs) &&
                                                is_bounded_by_bool offset
                                                  (ZRange.normalize roffset)
                                               then
                                                Datatypes.Some
                                                  (#(Z_cast2 (r1, r2))%expr @
                                                   (#(fancy_add (Z.log2 s9)
                                                        (- offset))%expr @
                                                    (#(Z_cast rx)%expr @ x10,
                                                    #(Z_cast ry)%expr @ y)))%expr_pat
                                               else Datatypes.None) args6
                                               (let (x10, _) := xv in x10)
                                               args4 (v (Compile.reflect x4))
                                               args3 args1
                                               (v0 (Compile.reflect x8))
                                               args0
                                               (let (x10, _) := xv0 in x10);
                                      Datatypes.Some (Base x10));
                               Datatypes.Some
                                 (fv0 <-- fv;
                                  Base fv0)%under_lets
                              else Datatypes.None
                          | Datatypes.None => Datatypes.None
                          end
                      | (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Ident _ _ _ t5 idc5) x8 @
                         (@expr.Ident _ _ _ t6 idc6 @ ($_)%expr))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Ident _ _ _ t5 idc5) x8 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.Abs _ _ _ _ _ _))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Ident _ _ _ t5 idc5) x8 @
                         (@expr.Ident _ _ _ t6 idc6 @ (_ @ _)))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Ident _ _ _ t5 idc5) x8 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.LetIn _ _ _ _ _ _
                          _))%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Ident _ _ _ t5 idc5) x8 @ #(_))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Ident _ _ _ t5 idc5) x8 @ ($_)%expr)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Ident _ _ _ t5 idc5) x8 @ @expr.Abs _ _ _ _ _
                         _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Ident _ _ _ t5 idc5) x8 @ (($_)%expr @ _))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Ident _ _ _ t5 idc5) x8 @
                         (@expr.Abs _ _ _ _ _ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Ident _ _ _ t5 idc5) x8 @ (_ @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Ident _ _ _ t5 idc5) x8 @
                         (@expr.LetIn _ _ _ _ _ _ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Ident _ _ _ t5 idc5) x8 @ @expr.LetIn _ _ _ _
                         _ _ _)%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         ($_)%expr _ @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Abs _ _ _ _ _ _) _ @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (_ @ _) _ @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.LetIn _ _ _ _ _ _ _) _ @ _)%expr_pat =>
                          Datatypes.None
                      | (@expr.Ident _ _ _ t4 idc4 @ #(_) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ ($_)%expr @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.Abs _ _ _ _ _ _ @
                         _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.LetIn _ _ _ _ _ _
                         _ @ _)%expr_pat => Datatypes.None
                      | _ => Datatypes.None
                      end;;
                      match x4 with
                      | (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Ident _ _ _ t5 idc5) x8 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.Ident _ _ _ t7
                          idc7))%expr_pat =>
                          args <- invert_bind_args idc7 Raw.ident.Literal;
                          args0 <- invert_bind_args idc6 Raw.ident.Z_cast;
                          args1 <- invert_bind_args idc5 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc4 Raw.ident.Z_shiftr;
                          args3 <- invert_bind_args idc3 Raw.ident.Z_cast;
                          args4 <- invert_bind_args idc2 Raw.ident.Z_cast;
                          args5 <- invert_bind_args idc1 Raw.ident.Literal;
                          args6 <- invert_bind_args idc0 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc Raw.ident.Z_add_get_carry;
                          match
                            pattern.type.unify_extracted
                              ((ℤ -> ℤ -> ℤ) -> ℤ)%ptype
                              (((projT1 args5) -> s7 -> (projT1 args)) -> s4)%ptype
                          with
                          | Datatypes.Some (_, (_, _), _)%zrange =>
                              if
                               type.type_beq base.type base.type.type_beq
                                 ((ℤ -> ℤ -> ℤ) -> ℤ)%ptype
                                 (((projT1 args5) -> s7 -> (projT1 args)) ->
                                  s4)%ptype
                              then
                               xv <- ident.unify pattern.ident.Literal
                                       ##(projT2 args5);
                               v <- type.try_make_transport_cps s7 ℤ;
                               xv0 <- ident.unify pattern.ident.Literal
                                        ##(projT2 args);
                               v0 <- type.try_make_transport_cps s4 ℤ;
                               fv <- (x10 <- (let
                                              '(r1, r2)%zrange := range in
                                               fun (rs : zrange) (s9 : Z)
                                                 (rshiftr ry : zrange)
                                                 (y : expr ℤ)
                                                 (roffset : zrange)
                                                 (offset : Z) (rx : zrange)
                                                 (x10 : expr ℤ) =>
                                               if
                                                (s9 =? 2 ^ Z.log2 s9) &&
                                                (ZRange.normalize ry >>
                                                 ZRange.normalize
                                                   (ZRange.constant offset) <=?
                                                 ZRange.normalize rshiftr)%zrange &&
                                                (ZRange.normalize rshiftr <=?
                                                 r[0 ~> s9 - 1])%zrange &&
                                                is_bounded_by_bool s9
                                                  (ZRange.normalize rs) &&
                                                is_bounded_by_bool offset
                                                  (ZRange.normalize roffset)
                                               then
                                                Datatypes.Some
                                                  (#(Z_cast2 (r1, r2))%expr @
                                                   (#(fancy_add (Z.log2 s9)
                                                        (- offset))%expr @
                                                    (#(Z_cast rx)%expr @ x10,
                                                    #(Z_cast ry)%expr @ y)))%expr_pat
                                               else Datatypes.None) args6
                                               (let (x10, _) := xv in x10)
                                               args4 args1
                                               (v (Compile.reflect x8)) args0
                                               (let (x10, _) := xv0 in x10)
                                               args3
                                               (v0 (Compile.reflect x5));
                                      Datatypes.Some (Base x10));
                               Datatypes.Some
                                 (fv0 <-- fv;
                                  Base fv0)%under_lets
                              else Datatypes.None
                          | Datatypes.None => Datatypes.None
                          end
                      | (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Ident _ _ _ t5 idc5) x8 @
                         (@expr.Ident _ _ _ t6 idc6 @ ($_)%expr))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Ident _ _ _ t5 idc5) x8 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.Abs _ _ _ _ _ _))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Ident _ _ _ t5 idc5) x8 @
                         (@expr.Ident _ _ _ t6 idc6 @ (_ @ _)))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Ident _ _ _ t5 idc5) x8 @
                         (@expr.Ident _ _ _ t6 idc6 @ @expr.LetIn _ _ _ _ _ _
                          _))%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Ident _ _ _ t5 idc5) x8 @ #(_))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Ident _ _ _ t5 idc5) x8 @ ($_)%expr)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Ident _ _ _ t5 idc5) x8 @ @expr.Abs _ _ _ _ _
                         _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Ident _ _ _ t5 idc5) x8 @ (($_)%expr @ _))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Ident _ _ _ t5 idc5) x8 @
                         (@expr.Abs _ _ _ _ _ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Ident _ _ _ t5 idc5) x8 @ (_ @ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Ident _ _ _ t5 idc5) x8 @
                         (@expr.LetIn _ _ _ _ _ _ _ @ _))%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Ident _ _ _ t5 idc5) x8 @ @expr.LetIn _ _ _ _
                         _ _ _)%expr_pat => Datatypes.None
                      | (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         ($_)%expr _ @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.Abs _ _ _ _ _ _) _ @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (_ @ _) _ @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.App _ _ _ s7 _
                         (@expr.LetIn _ _ _ _ _ _ _) _ @ _)%expr_pat =>
                          Datatypes.None
                      | (@expr.Ident _ _ _ t4 idc4 @ #(_) @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ ($_)%expr @ _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.Abs _ _ _ _ _ _ @
                         _)%expr_pat |
                        (@expr.Ident _ _ _ t4 idc4 @ @expr.LetIn _ _ _ _ _ _
                         _ @ _)%expr_pat => Datatypes.None
                      | _ => Datatypes.None
                      end;;
                      args <- invert_bind_args idc3 Raw.ident.Z_cast;
                      args0 <- invert_bind_args idc2 Raw.ident.Z_cast;
                      args1 <- invert_bind_args idc1 Raw.ident.Literal;
                      args2 <- invert_bind_args idc0 Raw.ident.Z_cast;
                      _ <- invert_bind_args idc Raw.ident.Z_add_get_carry;
                      match
                        pattern.type.unify_extracted ((ℤ -> ℤ) -> ℤ)%ptype
                          (((projT1 args1) -> s3) -> s4)%ptype
                      with
                      | Datatypes.Some (_, _, _)%zrange =>
                          if
                           type.type_beq base.type base.type.type_beq
                             ((ℤ -> ℤ) -> ℤ)%ptype
                             (((projT1 args1) -> s3) -> s4)%ptype
                          then
                           xv <- ident.unify pattern.ident.Literal
                                   ##(projT2 args1);
                           v <- type.try_make_transport_cps s3 ℤ;
                           v0 <- type.try_make_transport_cps s4 ℤ;
                           fv <- (x6 <- (let
                                         '(r1, r2)%zrange := range in
                                          fun (rs : zrange) (s5 : Z)
                                            (rx : zrange) (x6 : expr ℤ)
                                            (ry : zrange) (y : expr ℤ) =>
                                          if
                                           (s5 =? 2 ^ Z.log2 s5) &&
                                           (ZRange.normalize ry <=?
                                            r[0 ~> s5 - 1])%zrange &&
                                           is_bounded_by_bool s5
                                             (ZRange.normalize rs)
                                          then
                                           Datatypes.Some
                                             (#(Z_cast2 (r1, r2))%expr @
                                              (#(fancy_add (Z.log2 s5) 0)%expr @
                                               (#(Z_cast rx)%expr @ x6,
                                               #(Z_cast ry)%expr @ y)))%expr_pat
                                          else Datatypes.None) args2
                                          (let (x6, _) := xv in x6) args0
                                          (v (Compile.reflect x4)) args
                                          (v0 (Compile.reflect x5));
                                  Datatypes.Some (Base x6));
                           Datatypes.Some (fv0 <-- fv;
                                           Base fv0)%under_lets
                          else Datatypes.None
                      | Datatypes.None => Datatypes.None
                      end
                  | @expr.App _ _ _ s4 _ ($_)%expr _ | @expr.App _ _ _ s4 _
                    (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _ _ s4 _
                    (_ @ _)%expr_pat _ | @expr.App _ _ _ s4 _
                    (@expr.LetIn _ _ _ _ _ _ _) _ => Datatypes.None
                  | _ => Datatypes.None
                  end
              | @expr.App _ _ _ s3 _ ($_)%expr _ | @expr.App _ _ _ s3 _
                (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _ _ s3 _
                (_ @ _)%expr_pat _ | @expr.App _ _ _ s3 _
                (@expr.LetIn _ _ _ _ _ _ _) _ => Datatypes.None
              | _ => Datatypes.None
              end
          | (@expr.Ident _ _ _ t0 idc0 @ ($_)%expr)%expr_pat |
            (@expr.Ident _ _ _ t0 idc0 @ @expr.Abs _ _ _ _ _ _)%expr_pat |
            (@expr.Ident _ _ _ t0 idc0 @ (_ @ _))%expr_pat |
            (@expr.Ident _ _ _ t0 idc0 @ @expr.LetIn _ _ _ _ _ _ _)%expr_pat =>
              Datatypes.None
          | _ => Datatypes.None
          end;;
          match x2 with
          | (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1)%expr_pat =>
              match x1 with
              | @expr.App _ _ _ s3 _ (@expr.Ident _ _ _ t2 idc2) x4 =>
                  match x0 with
                  | @expr.App _ _ _ s4 _ (@expr.Ident _ _ _ t3 idc3) x5 =>
                      match x5 with
                      | (@expr.Ident _ _ _ t4 idc4 @ x7 @ x6)%expr_pat =>
                          match x7 with
                          | (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10
                              _ (@expr.Ident _ _ _ t7 idc7) x11 @
                              (@expr.Ident _ _ _ t8 idc8 @ @expr.Ident _ _ _
                               t9 idc9)))%expr_pat =>
                              match x6 with
                              | (@expr.Ident _ _ _ t10 idc10 @ @expr.Ident _
                                 _ _ t11 idc11)%expr_pat =>
                                  args <- invert_bind_args idc11
                                            Raw.ident.Literal;
                                  args0 <- invert_bind_args idc10
                                             Raw.ident.Z_cast;
                                  args1 <- invert_bind_args idc9
                                             Raw.ident.Literal;
                                  args2 <- invert_bind_args idc8
                                             Raw.ident.Z_cast;
                                  args3 <- invert_bind_args idc7
                                             Raw.ident.Z_cast;
                                  _ <- invert_bind_args idc6 Raw.ident.Z_land;
                                  args5 <- invert_bind_args idc5
                                             Raw.ident.Z_cast;
                                  _ <- invert_bind_args idc4
                                         Raw.ident.Z_shiftl;
                                  args7 <- invert_bind_args idc3
                                             Raw.ident.Z_cast;
                                  args8 <- invert_bind_args idc2
                                             Raw.ident.Z_cast;
                                  args9 <- invert_bind_args idc1
                                             Raw.ident.Literal;
                                  args10 <- invert_bind_args idc0
                                              Raw.ident.Z_cast;
                                  _ <- invert_bind_args idc
                                         Raw.ident.Z_sub_get_borrow;
                                  match
                                    pattern.type.unify_extracted
                                      ((ℤ -> ℤ) -> (ℤ -> ℤ) -> ℤ)%ptype
                                      (((projT1 args9) -> s3) ->
                                       (s10 -> (projT1 args1)) ->
                                       (projT1 args))%ptype
                                  with
                                  | Datatypes.Some
                                    (_, _, (_, _, _))%zrange =>
                                      if
                                       type.type_beq base.type
                                         base.type.type_beq
                                         ((ℤ -> ℤ) -> (ℤ -> ℤ) -> ℤ)%ptype
                                         (((projT1 args9) -> s3) ->
                                          (s10 -> (projT1 args1)) ->
                                          (projT1 args))%ptype
                                      then
                                       xv <- ident.unify
                                               pattern.ident.Literal
                                               ##(projT2 args9);
                                       v <- type.try_make_transport_cps s3 ℤ;
                                       v0 <- type.try_make_transport_cps s10 ℤ;
                                       xv0 <- ident.unify
                                                pattern.ident.Literal
                                                ##(projT2 args1);
                                       xv1 <- ident.unify
                                                pattern.ident.Literal
                                                ##(projT2 args);
                                       fv <- (x14 <- (let
                                                      '(r1, r2)%zrange :=
                                                       range in
                                                       fun (rs : zrange)
                                                         (s13 : Z)
                                                         (rx : zrange)
                                                         (x14 : expr ℤ)
                                                         (rshiftl rland
                                                          ry : zrange)
                                                         (y : expr ℤ)
                                                         (rmask : zrange)
                                                         (mask : Z)
                                                         (roffset : zrange)
                                                         (offset : Z) =>
                                                       if
                                                        (s13 =?
                                                         2 ^ Z.log2 s13) &&
                                                        (ZRange.normalize
                                                           rland <<
                                                         ZRange.normalize
                                                           (ZRange.constant
                                                              offset) <=?
                                                         ZRange.normalize
                                                           rshiftl)%zrange &&
                                                        (ZRange.normalize
                                                           rshiftl <=?
                                                         r[0 ~> s13 - 1])%zrange &&
                                                        (ZRange.normalize ry &'
                                                         ZRange.normalize
                                                           (ZRange.constant
                                                              mask) <=?
                                                         ZRange.normalize
                                                           rland)%zrange &&
                                                        (mask =?
                                                         Z.ones
                                                           (Z.log2 s13 -
                                                            offset)) &&
                                                        (0 <=? offset) &&
                                                        (offset <=?
                                                         Z.log2 s13) &&
                                                        is_bounded_by_bool
                                                          s13
                                                          (ZRange.normalize
                                                             rs) &&
                                                        is_bounded_by_bool
                                                          mask
                                                          (ZRange.normalize
                                                             rmask) &&
                                                        is_bounded_by_bool
                                                          offset
                                                          (ZRange.normalize
                                                             roffset)
                                                       then
                                                        Datatypes.Some
                                                          (#(Z_cast2 (r1, r2))%expr @
                                                           (#(fancy_sub
                                                                (Z.log2 s13)
                                                                offset)%expr @
                                                            (#(Z_cast rx)%expr @
                                                             x14,
                                                            #(Z_cast ry)%expr @
                                                            y)))%expr_pat
                                                       else Datatypes.None)
                                                       args10
                                                       (let (x14, _) := xv in
                                                        x14) args8
                                                       (v
                                                          (Compile.reflect x4))
                                                       args7 args5 args3
                                                       (v0
                                                          (Compile.reflect
                                                             x11)) args2
                                                       (let (x14, _) :=
                                                          xv0 in
                                                        x14) args0
                                                       (let (x14, _) :=
                                                          xv1 in
                                                        x14);
                                              Datatypes.Some (Base x14));
                                       Datatypes.Some
                                         (fv0 <-- fv;
                                          Base fv0)%under_lets
                                      else Datatypes.None
                                  | Datatypes.None => Datatypes.None
                                  end
                              | (@expr.Ident _ _ _ t10 idc10 @ ($_)%expr)%expr_pat |
                                (@expr.Ident _ _ _ t10 idc10 @ @expr.Abs _ _
                                 _ _ _ _)%expr_pat |
                                (@expr.Ident _ _ _ t10 idc10 @ (_ @ _))%expr_pat |
                                (@expr.Ident _ _ _ t10 idc10 @ @expr.LetIn _
                                 _ _ _ _ _ _)%expr_pat => Datatypes.None
                              | _ => Datatypes.None
                              end
                          | (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10
                              _ (@expr.Ident _ _ _ t7 idc7) x11 @
                              (@expr.Ident _ _ _ t8 idc8 @ ($_)%expr)))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10
                              _ (@expr.Ident _ _ _ t7 idc7) x11 @
                              (@expr.Ident _ _ _ t8 idc8 @ @expr.Abs _ _ _ _
                               _ _)))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10
                              _ (@expr.Ident _ _ _ t7 idc7) x11 @
                              (@expr.Ident _ _ _ t8 idc8 @ (_ @ _))))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10
                              _ (@expr.Ident _ _ _ t7 idc7) x11 @
                              (@expr.Ident _ _ _ t8 idc8 @ @expr.LetIn _ _ _
                               _ _ _ _)))%expr_pat => Datatypes.None
                          | (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10
                              _ (@expr.Ident _ _ _ t7 idc7) x11 @ #(_)))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10
                              _ (@expr.Ident _ _ _ t7 idc7) x11 @ ($_)%expr))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10
                              _ (@expr.Ident _ _ _ t7 idc7) x11 @ @expr.Abs _
                              _ _ _ _ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10
                              _ (@expr.Ident _ _ _ t7 idc7) x11 @
                              (($_)%expr @ _)))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10
                              _ (@expr.Ident _ _ _ t7 idc7) x11 @
                              (@expr.Abs _ _ _ _ _ _ @ _)))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10
                              _ (@expr.Ident _ _ _ t7 idc7) x11 @ (_ @ _ @ _)))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10
                              _ (@expr.Ident _ _ _ t7 idc7) x11 @
                              (@expr.LetIn _ _ _ _ _ _ _ @ _)))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10
                              _ (@expr.Ident _ _ _ t7 idc7) x11 @ @expr.LetIn
                              _ _ _ _ _ _ _))%expr_pat => Datatypes.None
                          | (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10
                              _ ($_)%expr _ @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10
                              _ (@expr.Abs _ _ _ _ _ _) _ @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10
                              _ (_ @ _) _ @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ @expr.App _ _ _ s10
                              _ (@expr.LetIn _ _ _ _ _ _ _) _ @ _))%expr_pat =>
                              Datatypes.None
                          | (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ #(_) @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ ($_)%expr @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ @expr.Abs _ _ _ _ _
                              _ @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ @expr.LetIn _ _ _ _
                              _ _ _ @ _))%expr_pat => Datatypes.None
                          | (@expr.Ident _ _ _ t5 idc5 @ #(_))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ ($_)%expr)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.Abs _ _ _ _ _
                             _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ (#(_) @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ (($_)%expr @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Abs _ _ _ _ _ _ @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ (($_)%expr @ _ @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Abs _ _ _ _ _ _ @ _ @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ (_ @ _ @ _ @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.LetIn _ _ _ _ _ _ _ @ _ @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.LetIn _ _ _ _ _ _ _ @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.LetIn _ _ _ _
                             _ _ _)%expr_pat => Datatypes.None
                          | _ => Datatypes.None
                          end;;
                          match x7 with
                          | @expr.App _ _ _ s7 _ (@expr.Ident _ _ _ t5 idc5)
                            x8 =>
                              match x6 with
                              | (@expr.Ident _ _ _ t6 idc6 @ @expr.Ident _ _
                                 _ t7 idc7)%expr_pat =>
                                  args <- invert_bind_args idc7
                                            Raw.ident.Literal;
                                  args0 <- invert_bind_args idc6
                                             Raw.ident.Z_cast;
                                  args1 <- invert_bind_args idc5
                                             Raw.ident.Z_cast;
                                  _ <- invert_bind_args idc4
                                         Raw.ident.Z_shiftr;
                                  args3 <- invert_bind_args idc3
                                             Raw.ident.Z_cast;
                                  args4 <- invert_bind_args idc2
                                             Raw.ident.Z_cast;
                                  args5 <- invert_bind_args idc1
                                             Raw.ident.Literal;
                                  args6 <- invert_bind_args idc0
                                             Raw.ident.Z_cast;
                                  _ <- invert_bind_args idc
                                         Raw.ident.Z_sub_get_borrow;
                                  match
                                    pattern.type.unify_extracted
                                      ((ℤ -> ℤ) -> ℤ -> ℤ)%ptype
                                      (((projT1 args5) -> s3) ->
                                       s7 -> (projT1 args))%ptype
                                  with
                                  | Datatypes.Some (_, _, (_, _))%zrange =>
                                      if
                                       type.type_beq base.type
                                         base.type.type_beq
                                         ((ℤ -> ℤ) -> ℤ -> ℤ)%ptype
                                         (((projT1 args5) -> s3) ->
                                          s7 -> (projT1 args))%ptype
                                      then
                                       xv <- ident.unify
                                               pattern.ident.Literal
                                               ##(projT2 args5);
                                       v <- type.try_make_transport_cps s3 ℤ;
                                       v0 <- type.try_make_transport_cps s7 ℤ;
                                       xv0 <- ident.unify
                                                pattern.ident.Literal
                                                ##(projT2 args);
                                       fv <- (x10 <- (let
                                                      '(r1, r2)%zrange :=
                                                       range in
                                                       fun (rs : zrange)
                                                         (s9 : Z)
                                                         (rx : zrange)
                                                         (x10 : expr ℤ)
                                                         (rshiftr
                                                          ry : zrange)
                                                         (y : expr ℤ)
                                                         (roffset : zrange)
                                                         (offset : Z) =>
                                                       if
                                                        (s9 =? 2 ^ Z.log2 s9) &&
                                                        (ZRange.normalize ry >>
                                                         ZRange.normalize
                                                           (ZRange.constant
                                                              offset) <=?
                                                         ZRange.normalize
                                                           rshiftr)%zrange &&
                                                        (ZRange.normalize
                                                           rshiftr <=?
                                                         r[0 ~> s9 - 1])%zrange &&
                                                        is_bounded_by_bool s9
                                                          (ZRange.normalize
                                                             rs) &&
                                                        is_bounded_by_bool
                                                          offset
                                                          (ZRange.normalize
                                                             roffset)
                                                       then
                                                        Datatypes.Some
                                                          (#(Z_cast2 (r1, r2))%expr @
                                                           (#(fancy_sub
                                                                (Z.log2 s9)
                                                                (- offset))%expr @
                                                            (#(Z_cast rx)%expr @
                                                             x10,
                                                            #(Z_cast ry)%expr @
                                                            y)))%expr_pat
                                                       else Datatypes.None)
                                                       args6
                                                       (let (x10, _) := xv in
                                                        x10) args4
                                                       (v
                                                          (Compile.reflect x4))
                                                       args3 args1
                                                       (v0
                                                          (Compile.reflect x8))
                                                       args0
                                                       (let (x10, _) :=
                                                          xv0 in
                                                        x10);
                                              Datatypes.Some (Base x10));
                                       Datatypes.Some
                                         (fv0 <-- fv;
                                          Base fv0)%under_lets
                                      else Datatypes.None
                                  | Datatypes.None => Datatypes.None
                                  end
                              | (@expr.Ident _ _ _ t6 idc6 @ ($_)%expr)%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @ @expr.Abs _ _ _
                                 _ _ _)%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @ (_ @ _))%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @ @expr.LetIn _ _
                                 _ _ _ _ _)%expr_pat => Datatypes.None
                              | _ => Datatypes.None
                              end
                          | @expr.App _ _ _ s7 _ ($_)%expr _ | @expr.App _ _
                            _ s7 _ (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _
                            _ s7 _ (_ @ _)%expr_pat _ | @expr.App _ _ _ s7 _
                            (@expr.LetIn _ _ _ _ _ _ _) _ => Datatypes.None
                          | _ => Datatypes.None
                          end
                      | _ => Datatypes.None
                      end;;
                      args <- invert_bind_args idc3 Raw.ident.Z_cast;
                      args0 <- invert_bind_args idc2 Raw.ident.Z_cast;
                      args1 <- invert_bind_args idc1 Raw.ident.Literal;
                      args2 <- invert_bind_args idc0 Raw.ident.Z_cast;
                      _ <- invert_bind_args idc Raw.ident.Z_sub_get_borrow;
                      match
                        pattern.type.unify_extracted ((ℤ -> ℤ) -> ℤ)%ptype
                          (((projT1 args1) -> s3) -> s4)%ptype
                      with
                      | Datatypes.Some (_, _, _)%zrange =>
                          if
                           type.type_beq base.type base.type.type_beq
                             ((ℤ -> ℤ) -> ℤ)%ptype
                             (((projT1 args1) -> s3) -> s4)%ptype
                          then
                           xv <- ident.unify pattern.ident.Literal
                                   ##(projT2 args1);
                           v <- type.try_make_transport_cps s3 ℤ;
                           v0 <- type.try_make_transport_cps s4 ℤ;
                           fv <- (x6 <- (let
                                         '(r1, r2)%zrange := range in
                                          fun (rs : zrange) (s5 : Z)
                                            (rx : zrange) (x6 : expr ℤ)
                                            (ry : zrange) (y : expr ℤ) =>
                                          if
                                           (s5 =? 2 ^ Z.log2 s5) &&
                                           (ZRange.normalize ry <=?
                                            r[0 ~> s5 - 1])%zrange &&
                                           is_bounded_by_bool s5
                                             (ZRange.normalize rs)
                                          then
                                           Datatypes.Some
                                             (#(Z_cast2 (r1, r2))%expr @
                                              (#(fancy_sub (Z.log2 s5) 0)%expr @
                                               (#(Z_cast rx)%expr @ x6,
                                               #(Z_cast ry)%expr @ y)))%expr_pat
                                          else Datatypes.None) args2
                                          (let (x6, _) := xv in x6) args0
                                          (v (Compile.reflect x4)) args
                                          (v0 (Compile.reflect x5));
                                  Datatypes.Some (Base x6));
                           Datatypes.Some (fv0 <-- fv;
                                           Base fv0)%under_lets
                          else Datatypes.None
                      | Datatypes.None => Datatypes.None
                      end
                  | @expr.App _ _ _ s4 _ ($_)%expr _ | @expr.App _ _ _ s4 _
                    (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _ _ s4 _
                    (_ @ _)%expr_pat _ | @expr.App _ _ _ s4 _
                    (@expr.LetIn _ _ _ _ _ _ _) _ => Datatypes.None
                  | _ => Datatypes.None
                  end
              | @expr.App _ _ _ s3 _ ($_)%expr _ | @expr.App _ _ _ s3 _
                (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _ _ s3 _
                (_ @ _)%expr_pat _ | @expr.App _ _ _ s3 _
                (@expr.LetIn _ _ _ _ _ _ _) _ => Datatypes.None
              | _ => Datatypes.None
              end
          | (@expr.Ident _ _ _ t0 idc0 @ ($_)%expr)%expr_pat |
            (@expr.Ident _ _ _ t0 idc0 @ @expr.Abs _ _ _ _ _ _)%expr_pat |
            (@expr.Ident _ _ _ t0 idc0 @ (_ @ _))%expr_pat |
            (@expr.Ident _ _ _ t0 idc0 @ @expr.LetIn _ _ _ _ _ _ _)%expr_pat =>
              Datatypes.None
          | _ => Datatypes.None
          end
      | (@expr.Ident _ _ _ t idc @ x3 @ x2 @ x1 @ x0)%expr_pat =>
          match x3 with
          | (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1)%expr_pat =>
              match x2 with
              | @expr.App _ _ _ s4 _ (@expr.Ident _ _ _ t2 idc2) x5 =>
                  match x1 with
                  | @expr.App _ _ _ s5 _ (@expr.Ident _ _ _ t3 idc3) x6 =>
                      match x0 with
                      | @expr.App _ _ _ s6 _ (@expr.Ident _ _ _ t4 idc4)
                        x7 =>
                          match x7 with
                          | (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Ident _ _ _
                                t10 idc10))) @
                             (@expr.Ident _ _ _ t11 idc11 @ @expr.Ident _ _ _
                              t12 idc12))%expr_pat =>
                              args <- invert_bind_args idc12
                                        Raw.ident.Literal;
                              args0 <- invert_bind_args idc11
                                         Raw.ident.Z_cast;
                              args1 <- invert_bind_args idc10
                                         Raw.ident.Literal;
                              args2 <- invert_bind_args idc9 Raw.ident.Z_cast;
                              args3 <- invert_bind_args idc8 Raw.ident.Z_cast;
                              _ <- invert_bind_args idc7 Raw.ident.Z_land;
                              args5 <- invert_bind_args idc6 Raw.ident.Z_cast;
                              _ <- invert_bind_args idc5 Raw.ident.Z_shiftl;
                              args7 <- invert_bind_args idc4 Raw.ident.Z_cast;
                              args8 <- invert_bind_args idc3 Raw.ident.Z_cast;
                              args9 <- invert_bind_args idc2 Raw.ident.Z_cast;
                              args10 <- invert_bind_args idc1
                                          Raw.ident.Literal;
                              args11 <- invert_bind_args idc0
                                          Raw.ident.Z_cast;
                              _ <- invert_bind_args idc
                                     Raw.ident.Z_add_with_get_carry;
                              match
                                pattern.type.unify_extracted
                                  (((ℤ -> ℤ) -> ℤ) -> (ℤ -> ℤ) -> ℤ)%ptype
                                  ((((projT1 args10) -> s4) -> s5) ->
                                   (s12 -> (projT1 args1)) -> (projT1 args))%ptype
                              with
                              | Datatypes.Some (_, _, _, (_, _, _))%zrange =>
                                  if
                                   type.type_beq base.type base.type.type_beq
                                     (((ℤ -> ℤ) -> ℤ) -> (ℤ -> ℤ) -> ℤ)%ptype
                                     ((((projT1 args10) -> s4) -> s5) ->
                                      (s12 -> (projT1 args1)) ->
                                      (projT1 args))%ptype
                                  then
                                   xv <- ident.unify pattern.ident.Literal
                                           ##(projT2 args10);
                                   v <- type.try_make_transport_cps s4 ℤ;
                                   v0 <- type.try_make_transport_cps s5 ℤ;
                                   v1 <- type.try_make_transport_cps s12 ℤ;
                                   xv0 <- ident.unify pattern.ident.Literal
                                            ##(projT2 args1);
                                   xv1 <- ident.unify pattern.ident.Literal
                                            ##(projT2 args);
                                   fv <- (x16 <- (let
                                                  '(r1, r2)%zrange := range
                                                   in
                                                   fun (rs : zrange)
                                                     (s15 : Z) (rc : zrange)
                                                     (c : expr ℤ)
                                                     (rx : zrange)
                                                     (x16 : expr ℤ)
                                                     (rshiftl rland
                                                      ry : zrange)
                                                     (y : expr ℤ)
                                                     (rmask : zrange)
                                                     (mask : Z)
                                                     (roffset : zrange)
                                                     (offset : Z) =>
                                                   if
                                                    (s15 =? 2 ^ Z.log2 s15) &&
                                                    (ZRange.normalize rland <<
                                                     ZRange.normalize
                                                       (ZRange.constant
                                                          offset) <=?
                                                     ZRange.normalize rshiftl)%zrange &&
                                                    (ZRange.normalize ry &'
                                                     ZRange.normalize
                                                       (ZRange.constant mask) <=?
                                                     ZRange.normalize rland)%zrange &&
                                                    (ZRange.normalize rshiftl <=?
                                                     r[0 ~> s15 - 1])%zrange &&
                                                    (mask =?
                                                     Z.ones
                                                       (Z.log2 s15 - offset)) &&
                                                    (0 <=? offset) &&
                                                    (offset <=? Z.log2 s15) &&
                                                    is_bounded_by_bool s15
                                                      (ZRange.normalize rs) &&
                                                    is_bounded_by_bool mask
                                                      (ZRange.normalize rmask) &&
                                                    is_bounded_by_bool offset
                                                      (ZRange.normalize
                                                         roffset)
                                                   then
                                                    Datatypes.Some
                                                      (#(Z_cast2 (r1, r2))%expr @
                                                       (#(fancy_addc
                                                            (Z.log2 s15)
                                                            offset)%expr @
                                                        (#(Z_cast rc)%expr @
                                                         c,
                                                        #(Z_cast rx)%expr @
                                                        x16,
                                                        #(Z_cast ry)%expr @ y)))%expr_pat
                                                   else Datatypes.None)
                                                   args11
                                                   (let (x16, _) := xv in x16)
                                                   args9
                                                   (v (Compile.reflect x5))
                                                   args8
                                                   (v0 (Compile.reflect x6))
                                                   args7 args5 args3
                                                   (v1 (Compile.reflect x13))
                                                   args2
                                                   (let (x16, _) := xv0 in
                                                    x16) args0
                                                   (let (x16, _) := xv1 in
                                                    x16);
                                          Datatypes.Some (Base x16));
                                   Datatypes.Some
                                     (fv0 <-- fv;
                                      Base fv0)%under_lets
                                  else Datatypes.None
                              | Datatypes.None => Datatypes.None
                              end
                          | (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Ident _ _ _
                                t10 idc10))) @
                             (@expr.Ident _ _ _ t11 idc11 @ ($_)%expr))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Ident _ _ _
                                t10 idc10))) @
                             (@expr.Ident _ _ _ t11 idc11 @ @expr.Abs _ _ _ _
                              _ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Ident _ _ _
                                t10 idc10))) @
                             (@expr.Ident _ _ _ t11 idc11 @ (_ @ _)))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Ident _ _ _
                                t10 idc10))) @
                             (@expr.Ident _ _ _ t11 idc11 @ @expr.LetIn _ _ _
                              _ _ _ _))%expr_pat => Datatypes.None
                          | (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Ident _ _ _
                                t10 idc10))) @ #(_))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Ident _ _ _
                                t10 idc10))) @ ($_)%expr)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Ident _ _ _
                                t10 idc10))) @ @expr.Abs _ _ _ _ _ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Ident _ _ _
                                t10 idc10))) @ (($_)%expr @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Ident _ _ _
                                t10 idc10))) @ (@expr.Abs _ _ _ _ _ _ @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Ident _ _ _
                                t10 idc10))) @ (_ @ _ @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Ident _ _ _
                                t10 idc10))) @
                             (@expr.LetIn _ _ _ _ _ _ _ @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Ident _ _ _
                                t10 idc10))) @ @expr.LetIn _ _ _ _ _ _ _)%expr_pat =>
                              Datatypes.None
                          | (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ ($_)%expr))) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Abs _ _ _ _
                                _ _))) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ (_ @ _)))) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.LetIn _ _ _
                                _ _ _ _))) @ _)%expr_pat => Datatypes.None
                          | (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @ #
                               (_))) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               ($_)%expr)) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               @expr.Abs _ _ _ _ _ _)) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (($_)%expr @ _))) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Abs _ _ _ _ _ _ @ _))) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (_ @ _ @ _))) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.LetIn _ _ _ _ _ _ _ @ _))) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               @expr.LetIn _ _ _ _ _ _ _)) @ _)%expr_pat =>
                              Datatypes.None
                          | (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ ($_)%expr _ @ _)) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Abs _ _ _ _ _ _) _ @ _)) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (_ @ _) _ @ _)) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.LetIn _ _ _ _ _ _ _) _ @ _)) @ _)%expr_pat =>
                              Datatypes.None
                          | (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ #(_) @ _)) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ ($_)%expr @ _)) @
                             _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.Abs _ _ _ _
                               _ _ @ _)) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.LetIn _ _ _
                               _ _ _ _ @ _)) @ _)%expr_pat => Datatypes.None
                          | (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ #(_)) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ ($_)%expr) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ @expr.Abs _ _ _ _ _
                              _) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ (#(_) @ _)) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ (($_)%expr @ _)) @
                             _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Abs _ _ _ _ _ _ @ _)) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ (($_)%expr @ _ @ _)) @
                             _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Abs _ _ _ _ _ _ @ _ @ _)) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ (_ @ _ @ _ @ _)) @
                             _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.LetIn _ _ _ _ _ _ _ @ _ @ _)) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.LetIn _ _ _ _ _ _ _ @ _)) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ @expr.LetIn _ _ _ _
                              _ _ _) @ _)%expr_pat => Datatypes.None
                          | (@expr.Ident _ _ _ t5 idc5 @ #(_) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ ($_)%expr @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.Abs _ _ _ _ _
                             _ @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ (($_)%expr @ _) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Abs _ _ _ _ _ _ @ _) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ (_ @ _ @ _) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.LetIn _ _ _ _ _ _ _ @ _) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.LetIn _ _ _ _
                             _ _ _ @ _)%expr_pat => Datatypes.None
                          | _ => Datatypes.None
                          end;;
                          match x6 with
                          | (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Ident _ _ _
                                t10 idc10))) @
                             (@expr.Ident _ _ _ t11 idc11 @ @expr.Ident _ _ _
                              t12 idc12))%expr_pat =>
                              args <- invert_bind_args idc12
                                        Raw.ident.Literal;
                              args0 <- invert_bind_args idc11
                                         Raw.ident.Z_cast;
                              args1 <- invert_bind_args idc10
                                         Raw.ident.Literal;
                              args2 <- invert_bind_args idc9 Raw.ident.Z_cast;
                              args3 <- invert_bind_args idc8 Raw.ident.Z_cast;
                              _ <- invert_bind_args idc7 Raw.ident.Z_land;
                              args5 <- invert_bind_args idc6 Raw.ident.Z_cast;
                              _ <- invert_bind_args idc5 Raw.ident.Z_shiftl;
                              args7 <- invert_bind_args idc4 Raw.ident.Z_cast;
                              args8 <- invert_bind_args idc3 Raw.ident.Z_cast;
                              args9 <- invert_bind_args idc2 Raw.ident.Z_cast;
                              args10 <- invert_bind_args idc1
                                          Raw.ident.Literal;
                              args11 <- invert_bind_args idc0
                                          Raw.ident.Z_cast;
                              _ <- invert_bind_args idc
                                     Raw.ident.Z_add_with_get_carry;
                              match
                                pattern.type.unify_extracted
                                  (((ℤ -> ℤ) -> (ℤ -> ℤ) -> ℤ) -> ℤ)%ptype
                                  ((((projT1 args10) -> s4) ->
                                    (s12 -> (projT1 args1)) -> (projT1 args)) ->
                                   s6)%ptype
                              with
                              | Datatypes.Some (_, _, (_, _, _), _)%zrange =>
                                  if
                                   type.type_beq base.type base.type.type_beq
                                     (((ℤ -> ℤ) -> (ℤ -> ℤ) -> ℤ) -> ℤ)%ptype
                                     ((((projT1 args10) -> s4) ->
                                       (s12 -> (projT1 args1)) ->
                                       (projT1 args)) -> s6)%ptype
                                  then
                                   xv <- ident.unify pattern.ident.Literal
                                           ##(projT2 args10);
                                   v <- type.try_make_transport_cps s4 ℤ;
                                   v0 <- type.try_make_transport_cps s12 ℤ;
                                   xv0 <- ident.unify pattern.ident.Literal
                                            ##(projT2 args1);
                                   xv1 <- ident.unify pattern.ident.Literal
                                            ##(projT2 args);
                                   v1 <- type.try_make_transport_cps s6 ℤ;
                                   fv <- (x16 <- (let
                                                  '(r1, r2)%zrange := range
                                                   in
                                                   fun (rs : zrange)
                                                     (s15 : Z) (rc : zrange)
                                                     (c : expr ℤ)
                                                     (rshiftl rland
                                                      ry : zrange)
                                                     (y : expr ℤ)
                                                     (rmask : zrange)
                                                     (mask : Z)
                                                     (roffset : zrange)
                                                     (offset : Z)
                                                     (rx : zrange)
                                                     (x16 : expr ℤ) =>
                                                   if
                                                    (s15 =? 2 ^ Z.log2 s15) &&
                                                    (ZRange.normalize rland <<
                                                     ZRange.normalize
                                                       (ZRange.constant
                                                          offset) <=?
                                                     ZRange.normalize rshiftl)%zrange &&
                                                    (ZRange.normalize rshiftl <=?
                                                     r[0 ~> s15 - 1])%zrange &&
                                                    (ZRange.normalize ry &'
                                                     ZRange.normalize
                                                       (ZRange.constant mask) <=?
                                                     ZRange.normalize rland)%zrange &&
                                                    (mask =?
                                                     Z.ones
                                                       (Z.log2 s15 - offset)) &&
                                                    (0 <=? offset) &&
                                                    (offset <=? Z.log2 s15) &&
                                                    is_bounded_by_bool s15
                                                      (ZRange.normalize rs) &&
                                                    is_bounded_by_bool mask
                                                      (ZRange.normalize rmask) &&
                                                    is_bounded_by_bool offset
                                                      (ZRange.normalize
                                                         roffset)
                                                   then
                                                    Datatypes.Some
                                                      (#(Z_cast2 (r1, r2))%expr @
                                                       (#(fancy_addc
                                                            (Z.log2 s15)
                                                            offset)%expr @
                                                        (#(Z_cast rc)%expr @
                                                         c,
                                                        #(Z_cast rx)%expr @
                                                        x16,
                                                        #(Z_cast ry)%expr @ y)))%expr_pat
                                                   else Datatypes.None)
                                                   args11
                                                   (let (x16, _) := xv in x16)
                                                   args9
                                                   (v (Compile.reflect x5))
                                                   args8 args5 args3
                                                   (v0 (Compile.reflect x13))
                                                   args2
                                                   (let (x16, _) := xv0 in
                                                    x16) args0
                                                   (let (x16, _) := xv1 in
                                                    x16) args7
                                                   (v1 (Compile.reflect x7));
                                          Datatypes.Some (Base x16));
                                   Datatypes.Some
                                     (fv0 <-- fv;
                                      Base fv0)%under_lets
                                  else Datatypes.None
                              | Datatypes.None => Datatypes.None
                              end
                          | (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Ident _ _ _
                                t10 idc10))) @
                             (@expr.Ident _ _ _ t11 idc11 @ ($_)%expr))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Ident _ _ _
                                t10 idc10))) @
                             (@expr.Ident _ _ _ t11 idc11 @ @expr.Abs _ _ _ _
                              _ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Ident _ _ _
                                t10 idc10))) @
                             (@expr.Ident _ _ _ t11 idc11 @ (_ @ _)))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Ident _ _ _
                                t10 idc10))) @
                             (@expr.Ident _ _ _ t11 idc11 @ @expr.LetIn _ _ _
                              _ _ _ _))%expr_pat => Datatypes.None
                          | (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Ident _ _ _
                                t10 idc10))) @ #(_))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Ident _ _ _
                                t10 idc10))) @ ($_)%expr)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Ident _ _ _
                                t10 idc10))) @ @expr.Abs _ _ _ _ _ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Ident _ _ _
                                t10 idc10))) @ (($_)%expr @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Ident _ _ _
                                t10 idc10))) @ (@expr.Abs _ _ _ _ _ _ @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Ident _ _ _
                                t10 idc10))) @ (_ @ _ @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Ident _ _ _
                                t10 idc10))) @
                             (@expr.LetIn _ _ _ _ _ _ _ @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Ident _ _ _
                                t10 idc10))) @ @expr.LetIn _ _ _ _ _ _ _)%expr_pat =>
                              Datatypes.None
                          | (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ ($_)%expr))) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.Abs _ _ _ _
                                _ _))) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ (_ @ _)))) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Ident _ _ _ t9 idc9 @ @expr.LetIn _ _ _
                                _ _ _ _))) @ _)%expr_pat => Datatypes.None
                          | (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @ #
                               (_))) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               ($_)%expr)) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               @expr.Abs _ _ _ _ _ _)) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (($_)%expr @ _))) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.Abs _ _ _ _ _ _ @ _))) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (_ @ _ @ _))) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               (@expr.LetIn _ _ _ _ _ _ _ @ _))) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                               @expr.LetIn _ _ _ _ _ _ _)) @ _)%expr_pat =>
                              Datatypes.None
                          | (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ ($_)%expr _ @ _)) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.Abs _ _ _ _ _ _) _ @ _)) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (_ @ _) _ @ _)) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                               s12 _ (@expr.LetIn _ _ _ _ _ _ _) _ @ _)) @ _)%expr_pat =>
                              Datatypes.None
                          | (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ #(_) @ _)) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ ($_)%expr @ _)) @
                             _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.Abs _ _ _ _
                               _ _ @ _)) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Ident _ _ _ t7 idc7 @ @expr.LetIn _ _ _
                               _ _ _ _ @ _)) @ _)%expr_pat => Datatypes.None
                          | (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ #(_)) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ ($_)%expr) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ @expr.Abs _ _ _ _ _
                              _) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ (#(_) @ _)) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ (($_)%expr @ _)) @
                             _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Abs _ _ _ _ _ _ @ _)) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ (($_)%expr @ _ @ _)) @
                             _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.Abs _ _ _ _ _ _ @ _ @ _)) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ (_ @ _ @ _ @ _)) @
                             _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.LetIn _ _ _ _ _ _ _ @ _ @ _)) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @
                              (@expr.LetIn _ _ _ _ _ _ _ @ _)) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Ident _ _ _ t6 idc6 @ @expr.LetIn _ _ _ _
                              _ _ _) @ _)%expr_pat => Datatypes.None
                          | (@expr.Ident _ _ _ t5 idc5 @ #(_) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ ($_)%expr @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.Abs _ _ _ _ _
                             _ @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ (($_)%expr @ _) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.Abs _ _ _ _ _ _ @ _) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ (_ @ _ @ _) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @
                             (@expr.LetIn _ _ _ _ _ _ _ @ _) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.LetIn _ _ _ _
                             _ _ _ @ _)%expr_pat => Datatypes.None
                          | _ => Datatypes.None
                          end;;
                          match x7 with
                          | (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Ident _ _ _ t6 idc6) x10 @
                             (@expr.Ident _ _ _ t7 idc7 @ @expr.Ident _ _ _
                              t8 idc8))%expr_pat =>
                              args <- invert_bind_args idc8 Raw.ident.Literal;
                              args0 <- invert_bind_args idc7 Raw.ident.Z_cast;
                              args1 <- invert_bind_args idc6 Raw.ident.Z_cast;
                              _ <- invert_bind_args idc5 Raw.ident.Z_shiftr;
                              args3 <- invert_bind_args idc4 Raw.ident.Z_cast;
                              args4 <- invert_bind_args idc3 Raw.ident.Z_cast;
                              args5 <- invert_bind_args idc2 Raw.ident.Z_cast;
                              args6 <- invert_bind_args idc1
                                         Raw.ident.Literal;
                              args7 <- invert_bind_args idc0 Raw.ident.Z_cast;
                              _ <- invert_bind_args idc
                                     Raw.ident.Z_add_with_get_carry;
                              match
                                pattern.type.unify_extracted
                                  (((ℤ -> ℤ) -> ℤ) -> ℤ -> ℤ)%ptype
                                  ((((projT1 args6) -> s4) -> s5) ->
                                   s9 -> (projT1 args))%ptype
                              with
                              | Datatypes.Some (_, _, _, (_, _))%zrange =>
                                  if
                                   type.type_beq base.type base.type.type_beq
                                     (((ℤ -> ℤ) -> ℤ) -> ℤ -> ℤ)%ptype
                                     ((((projT1 args6) -> s4) -> s5) ->
                                      s9 -> (projT1 args))%ptype
                                  then
                                   xv <- ident.unify pattern.ident.Literal
                                           ##(projT2 args6);
                                   v <- type.try_make_transport_cps s4 ℤ;
                                   v0 <- type.try_make_transport_cps s5 ℤ;
                                   v1 <- type.try_make_transport_cps s9 ℤ;
                                   xv0 <- ident.unify pattern.ident.Literal
                                            ##(projT2 args);
                                   fv <- (x12 <- (let
                                                  '(r1, r2)%zrange := range
                                                   in
                                                   fun (rs : zrange)
                                                     (s11 : Z) (rc : zrange)
                                                     (c : expr ℤ)
                                                     (rx : zrange)
                                                     (x12 : expr ℤ)
                                                     (rshiftr ry : zrange)
                                                     (y : expr ℤ)
                                                     (roffset : zrange)
                                                     (offset : Z) =>
                                                   if
                                                    (s11 =? 2 ^ Z.log2 s11) &&
                                                    (ZRange.normalize ry >>
                                                     ZRange.normalize
                                                       (ZRange.constant
                                                          offset) <=?
                                                     ZRange.normalize rshiftr)%zrange &&
                                                    (ZRange.normalize rshiftr <=?
                                                     r[0 ~> s11 - 1])%zrange &&
                                                    is_bounded_by_bool s11
                                                      (ZRange.normalize rs) &&
                                                    is_bounded_by_bool offset
                                                      (ZRange.normalize
                                                         roffset)
                                                   then
                                                    Datatypes.Some
                                                      (#(Z_cast2 (r1, r2))%expr @
                                                       (#(fancy_addc
                                                            (Z.log2 s11)
                                                            (- offset))%expr @
                                                        (#(Z_cast rc)%expr @
                                                         c,
                                                        #(Z_cast rx)%expr @
                                                        x12,
                                                        #(Z_cast ry)%expr @ y)))%expr_pat
                                                   else Datatypes.None) args7
                                                   (let (x12, _) := xv in x12)
                                                   args5
                                                   (v (Compile.reflect x5))
                                                   args4
                                                   (v0 (Compile.reflect x6))
                                                   args3 args1
                                                   (v1 (Compile.reflect x10))
                                                   args0
                                                   (let (x12, _) := xv0 in
                                                    x12);
                                          Datatypes.Some (Base x12));
                                   Datatypes.Some
                                     (fv0 <-- fv;
                                      Base fv0)%under_lets
                                  else Datatypes.None
                              | Datatypes.None => Datatypes.None
                              end
                          | (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Ident _ _ _ t6 idc6) x10 @
                             (@expr.Ident _ _ _ t7 idc7 @ ($_)%expr))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Ident _ _ _ t6 idc6) x10 @
                             (@expr.Ident _ _ _ t7 idc7 @ @expr.Abs _ _ _ _ _
                              _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Ident _ _ _ t6 idc6) x10 @
                             (@expr.Ident _ _ _ t7 idc7 @ (_ @ _)))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Ident _ _ _ t6 idc6) x10 @
                             (@expr.Ident _ _ _ t7 idc7 @ @expr.LetIn _ _ _ _
                              _ _ _))%expr_pat => Datatypes.None
                          | (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Ident _ _ _ t6 idc6) x10 @ #(_))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Ident _ _ _ t6 idc6) x10 @ ($_)%expr)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Ident _ _ _ t6 idc6) x10 @ @expr.Abs _ _
                             _ _ _ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Ident _ _ _ t6 idc6) x10 @
                             (($_)%expr @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Ident _ _ _ t6 idc6) x10 @
                             (@expr.Abs _ _ _ _ _ _ @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Ident _ _ _ t6 idc6) x10 @ (_ @ _ @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Ident _ _ _ t6 idc6) x10 @
                             (@expr.LetIn _ _ _ _ _ _ _ @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Ident _ _ _ t6 idc6) x10 @ @expr.LetIn _
                             _ _ _ _ _ _)%expr_pat => Datatypes.None
                          | (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             ($_)%expr _ @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Abs _ _ _ _ _ _) _ @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (_ @ _) _ @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.LetIn _ _ _ _ _ _ _) _ @ _)%expr_pat =>
                              Datatypes.None
                          | (@expr.Ident _ _ _ t5 idc5 @ #(_) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ ($_)%expr @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.Abs _ _ _ _ _
                             _ @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.LetIn _ _ _ _
                             _ _ _ @ _)%expr_pat => Datatypes.None
                          | _ => Datatypes.None
                          end;;
                          match x6 with
                          | (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Ident _ _ _ t6 idc6) x10 @
                             (@expr.Ident _ _ _ t7 idc7 @ @expr.Ident _ _ _
                              t8 idc8))%expr_pat =>
                              args <- invert_bind_args idc8 Raw.ident.Literal;
                              args0 <- invert_bind_args idc7 Raw.ident.Z_cast;
                              args1 <- invert_bind_args idc6 Raw.ident.Z_cast;
                              _ <- invert_bind_args idc5 Raw.ident.Z_shiftr;
                              args3 <- invert_bind_args idc4 Raw.ident.Z_cast;
                              args4 <- invert_bind_args idc3 Raw.ident.Z_cast;
                              args5 <- invert_bind_args idc2 Raw.ident.Z_cast;
                              args6 <- invert_bind_args idc1
                                         Raw.ident.Literal;
                              args7 <- invert_bind_args idc0 Raw.ident.Z_cast;
                              _ <- invert_bind_args idc
                                     Raw.ident.Z_add_with_get_carry;
                              match
                                pattern.type.unify_extracted
                                  (((ℤ -> ℤ) -> ℤ -> ℤ) -> ℤ)%ptype
                                  ((((projT1 args6) -> s4) ->
                                    s9 -> (projT1 args)) -> s6)%ptype
                              with
                              | Datatypes.Some (_, _, (_, _), _)%zrange =>
                                  if
                                   type.type_beq base.type base.type.type_beq
                                     (((ℤ -> ℤ) -> ℤ -> ℤ) -> ℤ)%ptype
                                     ((((projT1 args6) -> s4) ->
                                       s9 -> (projT1 args)) -> s6)%ptype
                                  then
                                   xv <- ident.unify pattern.ident.Literal
                                           ##(projT2 args6);
                                   v <- type.try_make_transport_cps s4 ℤ;
                                   v0 <- type.try_make_transport_cps s9 ℤ;
                                   xv0 <- ident.unify pattern.ident.Literal
                                            ##(projT2 args);
                                   v1 <- type.try_make_transport_cps s6 ℤ;
                                   fv <- (x12 <- (let
                                                  '(r1, r2)%zrange := range
                                                   in
                                                   fun (rs : zrange)
                                                     (s11 : Z) (rc : zrange)
                                                     (c : expr ℤ)
                                                     (rshiftr ry : zrange)
                                                     (y : expr ℤ)
                                                     (roffset : zrange)
                                                     (offset : Z)
                                                     (rx : zrange)
                                                     (x12 : expr ℤ) =>
                                                   if
                                                    (s11 =? 2 ^ Z.log2 s11) &&
                                                    (ZRange.normalize ry >>
                                                     ZRange.normalize
                                                       (ZRange.constant
                                                          offset) <=?
                                                     ZRange.normalize rshiftr)%zrange &&
                                                    (ZRange.normalize rshiftr <=?
                                                     r[0 ~> s11 - 1])%zrange &&
                                                    is_bounded_by_bool s11
                                                      (ZRange.normalize rs) &&
                                                    is_bounded_by_bool offset
                                                      (ZRange.normalize
                                                         roffset)
                                                   then
                                                    Datatypes.Some
                                                      (#(Z_cast2 (r1, r2))%expr @
                                                       (#(fancy_addc
                                                            (Z.log2 s11)
                                                            (- offset))%expr @
                                                        (#(Z_cast rc)%expr @
                                                         c,
                                                        #(Z_cast rx)%expr @
                                                        x12,
                                                        #(Z_cast ry)%expr @ y)))%expr_pat
                                                   else Datatypes.None) args7
                                                   (let (x12, _) := xv in x12)
                                                   args5
                                                   (v (Compile.reflect x5))
                                                   args4 args1
                                                   (v0 (Compile.reflect x10))
                                                   args0
                                                   (let (x12, _) := xv0 in
                                                    x12) args3
                                                   (v1 (Compile.reflect x7));
                                          Datatypes.Some (Base x12));
                                   Datatypes.Some
                                     (fv0 <-- fv;
                                      Base fv0)%under_lets
                                  else Datatypes.None
                              | Datatypes.None => Datatypes.None
                              end
                          | (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Ident _ _ _ t6 idc6) x10 @
                             (@expr.Ident _ _ _ t7 idc7 @ ($_)%expr))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Ident _ _ _ t6 idc6) x10 @
                             (@expr.Ident _ _ _ t7 idc7 @ @expr.Abs _ _ _ _ _
                              _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Ident _ _ _ t6 idc6) x10 @
                             (@expr.Ident _ _ _ t7 idc7 @ (_ @ _)))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Ident _ _ _ t6 idc6) x10 @
                             (@expr.Ident _ _ _ t7 idc7 @ @expr.LetIn _ _ _ _
                              _ _ _))%expr_pat => Datatypes.None
                          | (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Ident _ _ _ t6 idc6) x10 @ #(_))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Ident _ _ _ t6 idc6) x10 @ ($_)%expr)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Ident _ _ _ t6 idc6) x10 @ @expr.Abs _ _
                             _ _ _ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Ident _ _ _ t6 idc6) x10 @
                             (($_)%expr @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Ident _ _ _ t6 idc6) x10 @
                             (@expr.Abs _ _ _ _ _ _ @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Ident _ _ _ t6 idc6) x10 @ (_ @ _ @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Ident _ _ _ t6 idc6) x10 @
                             (@expr.LetIn _ _ _ _ _ _ _ @ _))%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Ident _ _ _ t6 idc6) x10 @ @expr.LetIn _
                             _ _ _ _ _ _)%expr_pat => Datatypes.None
                          | (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             ($_)%expr _ @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.Abs _ _ _ _ _ _) _ @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (_ @ _) _ @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.App _ _ _ s9 _
                             (@expr.LetIn _ _ _ _ _ _ _) _ @ _)%expr_pat =>
                              Datatypes.None
                          | (@expr.Ident _ _ _ t5 idc5 @ #(_) @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ ($_)%expr @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.Abs _ _ _ _ _
                             _ @ _)%expr_pat |
                            (@expr.Ident _ _ _ t5 idc5 @ @expr.LetIn _ _ _ _
                             _ _ _ @ _)%expr_pat => Datatypes.None
                          | _ => Datatypes.None
                          end;;
                          args <- invert_bind_args idc4 Raw.ident.Z_cast;
                          args0 <- invert_bind_args idc3 Raw.ident.Z_cast;
                          args1 <- invert_bind_args idc2 Raw.ident.Z_cast;
                          args2 <- invert_bind_args idc1 Raw.ident.Literal;
                          args3 <- invert_bind_args idc0 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc
                                 Raw.ident.Z_add_with_get_carry;
                          match
                            pattern.type.unify_extracted
                              (((ℤ -> ℤ) -> ℤ) -> ℤ)%ptype
                              ((((projT1 args2) -> s4) -> s5) -> s6)%ptype
                          with
                          | Datatypes.Some (_, _, _, _)%zrange =>
                              if
                               type.type_beq base.type base.type.type_beq
                                 (((ℤ -> ℤ) -> ℤ) -> ℤ)%ptype
                                 ((((projT1 args2) -> s4) -> s5) -> s6)%ptype
                              then
                               xv <- ident.unify pattern.ident.Literal
                                       ##(projT2 args2);
                               v <- type.try_make_transport_cps s4 ℤ;
                               v0 <- type.try_make_transport_cps s5 ℤ;
                               v1 <- type.try_make_transport_cps s6 ℤ;
                               fv <- (x8 <- (let
                                             '(r1, r2)%zrange := range in
                                              fun (rs : zrange) (s7 : Z)
                                                (rc : zrange) (c : expr ℤ)
                                                (rx : zrange) (x8 : expr ℤ)
                                                (ry : zrange) (y : expr ℤ) =>
                                              if
                                               (s7 =? 2 ^ Z.log2 s7) &&
                                               (ZRange.normalize ry <=?
                                                r[0 ~> s7 - 1])%zrange &&
                                               is_bounded_by_bool s7
                                                 (ZRange.normalize rs)
                                              then
                                               Datatypes.Some
                                                 (#(Z_cast2 (r1, r2))%expr @
                                                  (#(fancy_addc (Z.log2 s7) 0)%expr @
                                                   (#(Z_cast rc)%expr @ c,
                                                   #(Z_cast rx)%expr @ x8,
                                                   #(Z_cast ry)%expr @ y)))%expr_pat
                                              else Datatypes.None) args3
                                              (let (x8, _) := xv in x8) args1
                                              (v (Compile.reflect x5)) args0
                                              (v0 (Compile.reflect x6)) args
                                              (v1 (Compile.reflect x7));
                                      Datatypes.Some (Base x8));
                               Datatypes.Some
                                 (fv0 <-- fv;
                                  Base fv0)%under_lets
                              else Datatypes.None
                          | Datatypes.None => Datatypes.None
                          end
                      | @expr.App _ _ _ s6 _ ($_)%expr _ | @expr.App _ _ _ s6
                        _ (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _ _ s6 _
                        (_ @ _)%expr_pat _ | @expr.App _ _ _ s6 _
                        (@expr.LetIn _ _ _ _ _ _ _) _ => Datatypes.None
                      | _ => Datatypes.None
                      end
                  | @expr.App _ _ _ s5 _ ($_)%expr _ | @expr.App _ _ _ s5 _
                    (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _ _ s5 _
                    (_ @ _)%expr_pat _ | @expr.App _ _ _ s5 _
                    (@expr.LetIn _ _ _ _ _ _ _) _ => Datatypes.None
                  | _ => Datatypes.None
                  end
              | @expr.App _ _ _ s4 _ ($_)%expr _ | @expr.App _ _ _ s4 _
                (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _ _ s4 _
                (_ @ _)%expr_pat _ | @expr.App _ _ _ s4 _
                (@expr.LetIn _ _ _ _ _ _ _) _ => Datatypes.None
              | _ => Datatypes.None
              end
          | (@expr.Ident _ _ _ t0 idc0 @ ($_)%expr)%expr_pat |
            (@expr.Ident _ _ _ t0 idc0 @ @expr.Abs _ _ _ _ _ _)%expr_pat |
            (@expr.Ident _ _ _ t0 idc0 @ (_ @ _))%expr_pat |
            (@expr.Ident _ _ _ t0 idc0 @ @expr.LetIn _ _ _ _ _ _ _)%expr_pat =>
              Datatypes.None
          | _ => Datatypes.None
          end;;
          match x3 with
          | (@expr.Ident _ _ _ t0 idc0 @ @expr.Ident _ _ _ t1 idc1)%expr_pat =>
              match x2 with
              | @expr.App _ _ _ s4 _ (@expr.Ident _ _ _ t2 idc2) x5 =>
                  match x1 with
                  | @expr.App _ _ _ s5 _ (@expr.Ident _ _ _ t3 idc3) x6 =>
                      match x0 with
                      | @expr.App _ _ _ s6 _ (@expr.Ident _ _ _ t4 idc4)
                        x7 =>
                          match x7 with
                          | (@expr.Ident _ _ _ t5 idc5 @ x9 @ x8)%expr_pat =>
                              match x9 with
                              | (@expr.Ident _ _ _ t6 idc6 @
                                 (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                                  s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                                  (@expr.Ident _ _ _ t9 idc9 @ @expr.Ident _
                                   _ _ t10 idc10)))%expr_pat =>
                                  match x8 with
                                  | (@expr.Ident _ _ _ t11 idc11 @
                                     @expr.Ident _ _ _ t12 idc12)%expr_pat =>
                                      args <- invert_bind_args idc12
                                                Raw.ident.Literal;
                                      args0 <- invert_bind_args idc11
                                                 Raw.ident.Z_cast;
                                      args1 <- invert_bind_args idc10
                                                 Raw.ident.Literal;
                                      args2 <- invert_bind_args idc9
                                                 Raw.ident.Z_cast;
                                      args3 <- invert_bind_args idc8
                                                 Raw.ident.Z_cast;
                                      _ <- invert_bind_args idc7
                                             Raw.ident.Z_land;
                                      args5 <- invert_bind_args idc6
                                                 Raw.ident.Z_cast;
                                      _ <- invert_bind_args idc5
                                             Raw.ident.Z_shiftl;
                                      args7 <- invert_bind_args idc4
                                                 Raw.ident.Z_cast;
                                      args8 <- invert_bind_args idc3
                                                 Raw.ident.Z_cast;
                                      args9 <- invert_bind_args idc2
                                                 Raw.ident.Z_cast;
                                      args10 <- invert_bind_args idc1
                                                  Raw.ident.Literal;
                                      args11 <- invert_bind_args idc0
                                                  Raw.ident.Z_cast;
                                      _ <- invert_bind_args idc
                                             Raw.ident.Z_sub_with_get_borrow;
                                      match
                                        pattern.type.unify_extracted
                                          (((ℤ -> ℤ) -> ℤ) -> (ℤ -> ℤ) -> ℤ)%ptype
                                          ((((projT1 args10) -> s4) -> s5) ->
                                           (s12 -> (projT1 args1)) ->
                                           (projT1 args))%ptype
                                      with
                                      | Datatypes.Some
                                        (_, _, _, (_, _, _))%zrange =>
                                          if
                                           type.type_beq base.type
                                             base.type.type_beq
                                             (((ℤ -> ℤ) -> ℤ) ->
                                              (ℤ -> ℤ) -> ℤ)%ptype
                                             ((((projT1 args10) -> s4) -> s5) ->
                                              (s12 -> (projT1 args1)) ->
                                              (projT1 args))%ptype
                                          then
                                           xv <- ident.unify
                                                   pattern.ident.Literal
                                                   ##(projT2 args10);
                                           v <- type.try_make_transport_cps s4 ℤ;
                                           v0 <- type.try_make_transport_cps s5 ℤ;
                                           v1 <- type.try_make_transport_cps s12 ℤ;
                                           xv0 <- ident.unify
                                                    pattern.ident.Literal
                                                    ##(projT2 args1);
                                           xv1 <- ident.unify
                                                    pattern.ident.Literal
                                                    ##(projT2 args);
                                           fv <- (x16 <- (let
                                                          '(r1, r2)%zrange :=
                                                           range in
                                                           fun (rs : zrange)
                                                             (s15 : Z)
                                                             (rb : zrange)
                                                             (b4 : expr ℤ)
                                                             (rx : zrange)
                                                             (x16 : expr ℤ)
                                                             (rshiftl rland
                                                              ry : zrange)
                                                             (y : expr ℤ)
                                                             (rmask : zrange)
                                                             (mask : Z)
                                                             (roffset : zrange)
                                                             (offset : Z) =>
                                                           if
                                                            (s15 =?
                                                             2 ^ Z.log2 s15) &&
                                                            (ZRange.normalize
                                                               rland <<
                                                             ZRange.normalize
                                                               (ZRange.constant
                                                                  offset) <=?
                                                             ZRange.normalize
                                                               rshiftl)%zrange &&
                                                            (ZRange.normalize
                                                               rshiftl <=?
                                                             r[0 ~> s15 - 1])%zrange &&
                                                            (ZRange.normalize
                                                               ry &'
                                                             ZRange.normalize
                                                               (ZRange.constant
                                                                  mask) <=?
                                                             ZRange.normalize
                                                               rland)%zrange &&
                                                            (mask =?
                                                             Z.ones
                                                               (Z.log2 s15 -
                                                                offset)) &&
                                                            (0 <=? offset) &&
                                                            (offset <=?
                                                             Z.log2 s15) &&
                                                            is_bounded_by_bool
                                                              s15
                                                              (ZRange.normalize
                                                                 rs) &&
                                                            is_bounded_by_bool
                                                              mask
                                                              (ZRange.normalize
                                                                 rmask) &&
                                                            is_bounded_by_bool
                                                              offset
                                                              (ZRange.normalize
                                                                 roffset)
                                                           then
                                                            Datatypes.Some
                                                              (#(Z_cast2
                                                                   (r1, r2))%expr @
                                                               (#(fancy_subb
                                                                    (Z.log2
                                                                    s15)
                                                                    offset)%expr @
                                                                (#(Z_cast rb)%expr @
                                                                 b4,
                                                                #(Z_cast rx)%expr @
                                                                x16,
                                                                #(Z_cast ry)%expr @
                                                                y)))%expr_pat
                                                           else
                                                            Datatypes.None)
                                                           args11
                                                           (let (x16, _) :=
                                                              xv in
                                                            x16) args9
                                                           (v
                                                              (Compile.reflect
                                                                 x5)) args8
                                                           (v0
                                                              (Compile.reflect
                                                                 x6)) args7
                                                           args5 args3
                                                           (v1
                                                              (Compile.reflect
                                                                 x13)) args2
                                                           (let (x16, _) :=
                                                              xv0 in
                                                            x16) args0
                                                           (let (x16, _) :=
                                                              xv1 in
                                                            x16);
                                                  Datatypes.Some (Base x16));
                                           Datatypes.Some
                                             (fv0 <-- fv;
                                              Base fv0)%under_lets
                                          else Datatypes.None
                                      | Datatypes.None => Datatypes.None
                                      end
                                  | (@expr.Ident _ _ _ t11 idc11 @ ($_)%expr)%expr_pat |
                                    (@expr.Ident _ _ _ t11 idc11 @ @expr.Abs
                                     _ _ _ _ _ _)%expr_pat |
                                    (@expr.Ident _ _ _ t11 idc11 @ (_ @ _))%expr_pat |
                                    (@expr.Ident _ _ _ t11 idc11 @
                                     @expr.LetIn _ _ _ _ _ _ _)%expr_pat =>
                                      Datatypes.None
                                  | _ => Datatypes.None
                                  end
                              | (@expr.Ident _ _ _ t6 idc6 @
                                 (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                                  s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                                  (@expr.Ident _ _ _ t9 idc9 @ ($_)%expr)))%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @
                                 (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                                  s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                                  (@expr.Ident _ _ _ t9 idc9 @ @expr.Abs _ _
                                   _ _ _ _)))%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @
                                 (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                                  s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                                  (@expr.Ident _ _ _ t9 idc9 @ (_ @ _))))%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @
                                 (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                                  s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                                  (@expr.Ident _ _ _ t9 idc9 @ @expr.LetIn _
                                   _ _ _ _ _ _)))%expr_pat => Datatypes.None
                              | (@expr.Ident _ _ _ t6 idc6 @
                                 (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                                  s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                                  #(_)))%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @
                                 (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                                  s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                                  ($_)%expr))%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @
                                 (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                                  s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                                  @expr.Abs _ _ _ _ _ _))%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @
                                 (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                                  s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                                  (($_)%expr @ _)))%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @
                                 (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                                  s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                                  (@expr.Abs _ _ _ _ _ _ @ _)))%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @
                                 (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                                  s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                                  (_ @ _ @ _)))%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @
                                 (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                                  s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                                  (@expr.LetIn _ _ _ _ _ _ _ @ _)))%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @
                                 (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                                  s12 _ (@expr.Ident _ _ _ t8 idc8) x13 @
                                  @expr.LetIn _ _ _ _ _ _ _))%expr_pat =>
                                  Datatypes.None
                              | (@expr.Ident _ _ _ t6 idc6 @
                                 (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                                  s12 _ ($_)%expr _ @ _))%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @
                                 (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                                  s12 _ (@expr.Abs _ _ _ _ _ _) _ @ _))%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @
                                 (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                                  s12 _ (_ @ _) _ @ _))%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @
                                 (@expr.Ident _ _ _ t7 idc7 @ @expr.App _ _ _
                                  s12 _ (@expr.LetIn _ _ _ _ _ _ _) _ @ _))%expr_pat =>
                                  Datatypes.None
                              | (@expr.Ident _ _ _ t6 idc6 @
                                 (@expr.Ident _ _ _ t7 idc7 @ #(_) @ _))%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @
                                 (@expr.Ident _ _ _ t7 idc7 @ ($_)%expr @ _))%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @
                                 (@expr.Ident _ _ _ t7 idc7 @ @expr.Abs _ _ _
                                  _ _ _ @ _))%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @
                                 (@expr.Ident _ _ _ t7 idc7 @ @expr.LetIn _ _
                                  _ _ _ _ _ @ _))%expr_pat => Datatypes.None
                              | (@expr.Ident _ _ _ t6 idc6 @ #(_))%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @ ($_)%expr)%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @ @expr.Abs _ _ _
                                 _ _ _)%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @ (#(_) @ _))%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @ (($_)%expr @ _))%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @
                                 (@expr.Abs _ _ _ _ _ _ @ _))%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @
                                 (($_)%expr @ _ @ _))%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @
                                 (@expr.Abs _ _ _ _ _ _ @ _ @ _))%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @ (_ @ _ @ _ @ _))%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @
                                 (@expr.LetIn _ _ _ _ _ _ _ @ _ @ _))%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @
                                 (@expr.LetIn _ _ _ _ _ _ _ @ _))%expr_pat |
                                (@expr.Ident _ _ _ t6 idc6 @ @expr.LetIn _ _
                                 _ _ _ _ _)%expr_pat => Datatypes.None
                              | _ => Datatypes.None
                              end;;
                              match x9 with
                              | @expr.App _ _ _ s9 _
                                (@expr.Ident _ _ _ t6 idc6) x10 =>
                                  match x8 with
                                  | (@expr.Ident _ _ _ t7 idc7 @ @expr.Ident
                                     _ _ _ t8 idc8)%expr_pat =>
                                      args <- invert_bind_args idc8
                                                Raw.ident.Literal;
                                      args0 <- invert_bind_args idc7
                                                 Raw.ident.Z_cast;
                                      args1 <- invert_bind_args idc6
                                                 Raw.ident.Z_cast;
                                      _ <- invert_bind_args idc5
                                             Raw.ident.Z_shiftr;
                                      args3 <- invert_bind_args idc4
                                                 Raw.ident.Z_cast;
                                      args4 <- invert_bind_args idc3
                                                 Raw.ident.Z_cast;
                                      args5 <- invert_bind_args idc2
                                                 Raw.ident.Z_cast;
                                      args6 <- invert_bind_args idc1
                                                 Raw.ident.Literal;
                                      args7 <- invert_bind_args idc0
                                                 Raw.ident.Z_cast;
                                      _ <- invert_bind_args idc
                                             Raw.ident.Z_sub_with_get_borrow;
                                      match
                                        pattern.type.unify_extracted
                                          (((ℤ -> ℤ) -> ℤ) -> ℤ -> ℤ)%ptype
                                          ((((projT1 args6) -> s4) -> s5) ->
                                           s9 -> (projT1 args))%ptype
                                      with
                                      | Datatypes.Some
                                        (_, _, _, (_, _))%zrange =>
                                          if
                                           type.type_beq base.type
                                             base.type.type_beq
                                             (((ℤ -> ℤ) -> ℤ) -> ℤ -> ℤ)%ptype
                                             ((((projT1 args6) -> s4) -> s5) ->
                                              s9 -> (projT1 args))%ptype
                                          then
                                           xv <- ident.unify
                                                   pattern.ident.Literal
                                                   ##(projT2 args6);
                                           v <- type.try_make_transport_cps s4 ℤ;
                                           v0 <- type.try_make_transport_cps s5 ℤ;
                                           v1 <- type.try_make_transport_cps s9 ℤ;
                                           xv0 <- ident.unify
                                                    pattern.ident.Literal
                                                    ##(projT2 args);
                                           fv <- (x12 <- (let
                                                          '(r1, r2)%zrange :=
                                                           range in
                                                           fun (rs : zrange)
                                                             (s11 : Z)
                                                             (rb : zrange)
                                                             (b3 : expr ℤ)
                                                             (rx : zrange)
                                                             (x12 : expr ℤ)
                                                             (rshiftr
                                                              ry : zrange)
                                                             (y : expr ℤ)
                                                             (roffset : zrange)
                                                             (offset : Z) =>
                                                           if
                                                            (s11 =?
                                                             2 ^ Z.log2 s11) &&
                                                            (ZRange.normalize
                                                               ry >>
                                                             ZRange.normalize
                                                               (ZRange.constant
                                                                  offset) <=?
                                                             ZRange.normalize
                                                               rshiftr)%zrange &&
                                                            (ZRange.normalize
                                                               rshiftr <=?
                                                             r[0 ~> s11 - 1])%zrange &&
                                                            is_bounded_by_bool
                                                              s11
                                                              (ZRange.normalize
                                                                 rs) &&
                                                            is_bounded_by_bool
                                                              offset
                                                              (ZRange.normalize
                                                                 roffset)
                                                           then
                                                            Datatypes.Some
                                                              (#(Z_cast2
                                                                   (r1, r2))%expr @
                                                               (#(fancy_subb
                                                                    (Z.log2
                                                                    s11)
                                                                    (- offset))%expr @
                                                                (#(Z_cast rb)%expr @
                                                                 b3,
                                                                #(Z_cast rx)%expr @
                                                                x12,
                                                                #(Z_cast ry)%expr @
                                                                y)))%expr_pat
                                                           else
                                                            Datatypes.None)
                                                           args7
                                                           (let (x12, _) :=
                                                              xv in
                                                            x12) args5
                                                           (v
                                                              (Compile.reflect
                                                                 x5)) args4
                                                           (v0
                                                              (Compile.reflect
                                                                 x6)) args3
                                                           args1
                                                           (v1
                                                              (Compile.reflect
                                                                 x10)) args0
                                                           (let (x12, _) :=
                                                              xv0 in
                                                            x12);
                                                  Datatypes.Some (Base x12));
                                           Datatypes.Some
                                             (fv0 <-- fv;
                                              Base fv0)%under_lets
                                          else Datatypes.None
                                      | Datatypes.None => Datatypes.None
                                      end
                                  | (@expr.Ident _ _ _ t7 idc7 @ ($_)%expr)%expr_pat |
                                    (@expr.Ident _ _ _ t7 idc7 @ @expr.Abs _
                                     _ _ _ _ _)%expr_pat |
                                    (@expr.Ident _ _ _ t7 idc7 @ (_ @ _))%expr_pat |
                                    (@expr.Ident _ _ _ t7 idc7 @ @expr.LetIn
                                     _ _ _ _ _ _ _)%expr_pat =>
                                      Datatypes.None
                                  | _ => Datatypes.None
                                  end
                              | @expr.App _ _ _ s9 _ ($_)%expr _ | @expr.App
                                _ _ _ s9 _ (@expr.Abs _ _ _ _ _ _) _ |
                                @expr.App _ _ _ s9 _ (_ @ _)%expr_pat _ |
                                @expr.App _ _ _ s9 _
                                (@expr.LetIn _ _ _ _ _ _ _) _ =>
                                  Datatypes.None
                              | _ => Datatypes.None
                              end
                          | _ => Datatypes.None
                          end;;
                          args <- invert_bind_args idc4 Raw.ident.Z_cast;
                          args0 <- invert_bind_args idc3 Raw.ident.Z_cast;
                          args1 <- invert_bind_args idc2 Raw.ident.Z_cast;
                          args2 <- invert_bind_args idc1 Raw.ident.Literal;
                          args3 <- invert_bind_args idc0 Raw.ident.Z_cast;
                          _ <- invert_bind_args idc
                                 Raw.ident.Z_sub_with_get_borrow;
                          match
                            pattern.type.unify_extracted
                              (((ℤ -> ℤ) -> ℤ) -> ℤ)%ptype
                              ((((projT1 args2) -> s4) -> s5) -> s6)%ptype
                          with
                          | Datatypes.Some (_, _, _, _)%zrange =>
                              if
                               type.type_beq base.type base.type.type_beq
                                 (((ℤ -> ℤ) -> ℤ) -> ℤ)%ptype
                                 ((((projT1 args2) -> s4) -> s5) -> s6)%ptype
                              then
                               xv <- ident.unify pattern.ident.Literal
                                       ##(projT2 args2);
                               v <- type.try_make_transport_cps s4 ℤ;
                               v0 <- type.try_make_transport_cps s5 ℤ;
                               v1 <- type.try_make_transport_cps s6 ℤ;
                               fv <- (x8 <- (let
                                             '(r1, r2)%zrange := range in
                                              fun (rs : zrange) (s7 : Z)
                                                (rb : zrange) (b2 : expr ℤ)
                                                (rx : zrange) (x8 : expr ℤ)
                                                (ry : zrange) (y : expr ℤ) =>
                                              if
                                               (s7 =? 2 ^ Z.log2 s7) &&
                                               (ZRange.normalize ry <=?
                                                r[0 ~> s7 - 1])%zrange &&
                                               is_bounded_by_bool s7
                                                 (ZRange.normalize rs)
                                              then
                                               Datatypes.Some
                                                 (#(Z_cast2 (r1, r2))%expr @
                                                  (#(fancy_subb (Z.log2 s7) 0)%expr @
                                                   (#(Z_cast rb)%expr @ b2,
                                                   #(Z_cast rx)%expr @ x8,
                                                   #(Z_cast ry)%expr @ y)))%expr_pat
                                              else Datatypes.None) args3
                                              (let (x8, _) := xv in x8) args1
                                              (v (Compile.reflect x5)) args0
                                              (v0 (Compile.reflect x6)) args
                                              (v1 (Compile.reflect x7));
                                      Datatypes.Some (Base x8));
                               Datatypes.Some
                                 (fv0 <-- fv;
                                  Base fv0)%under_lets
                              else Datatypes.None
                          | Datatypes.None => Datatypes.None
                          end
                      | @expr.App _ _ _ s6 _ ($_)%expr _ | @expr.App _ _ _ s6
                        _ (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _ _ s6 _
                        (_ @ _)%expr_pat _ | @expr.App _ _ _ s6 _
                        (@expr.LetIn _ _ _ _ _ _ _) _ => Datatypes.None
                      | _ => Datatypes.None
                      end
                  | @expr.App _ _ _ s5 _ ($_)%expr _ | @expr.App _ _ _ s5 _
                    (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _ _ s5 _
                    (_ @ _)%expr_pat _ | @expr.App _ _ _ s5 _
                    (@expr.LetIn _ _ _ _ _ _ _) _ => Datatypes.None
                  | _ => Datatypes.None
                  end
              | @expr.App _ _ _ s4 _ ($_)%expr _ | @expr.App _ _ _ s4 _
                (@expr.Abs _ _ _ _ _ _) _ | @expr.App _ _ _ s4 _
                (_ @ _)%expr_pat _ | @expr.App _ _ _ s4 _
                (@expr.LetIn _ _ _ _ _ _ _) _ => Datatypes.None
              | _ => Datatypes.None
              end
          | (@expr.Ident _ _ _ t0 idc0 @ ($_)%expr)%expr_pat |
            (@expr.Ident _ _ _ t0 idc0 @ @expr.Abs _ _ _ _ _ _)%expr_pat |
            (@expr.Ident _ _ _ t0 idc0 @ (_ @ _))%expr_pat |
            (@expr.Ident _ _ _ t0 idc0 @ @expr.LetIn _ _ _ _ _ _ _)%expr_pat =>
              Datatypes.None
          | _ => Datatypes.None
          end
      | _ => Datatypes.None
      end;;
      Datatypes.None);;;
     Base (#(Z_cast2 range)%expr @ x)%expr_pat)%option
| Some A => fun x : expr A => Base (#(Some)%expr @ x)%expr_pat
| None A => Base #(None)%expr
| @option_rect A P =>
    fun (x : expr A -> UnderLets (expr P))
      (x0 : expr unit -> UnderLets (expr P)) (x1 : expr (base.type.option A))
    =>
    Base
      (#(option_rect)%expr @ (λ x2 : var A,
                              to_expr (x ($x2)))%expr @
       (λ x2 : var unit,
        to_expr (x0 ($x2)))%expr @ x1)%expr_pat
| Build_zrange =>
    fun x x0 : expr ℤ => Base (#(Build_zrange)%expr @ x @ x0)%expr_pat
| @zrange_rect P =>
    fun (x : expr ℤ -> expr ℤ -> UnderLets (expr P))
      (x0 : expr base.type.zrange) =>
    Base
      (#(zrange_rect)%expr @ (λ x1 x2 : var ℤ,
                              to_expr (x ($x1) ($x2)))%expr @ x0)%expr_pat
| fancy_add log2wordmax imm =>
    fun x : expr (ℤ * ℤ)%etype =>
    Base (#(fancy_add log2wordmax imm)%expr @ x)%expr_pat
| fancy_addc log2wordmax imm =>
    fun x : expr (ℤ * ℤ * ℤ)%etype =>
    Base (#(fancy_addc log2wordmax imm)%expr @ x)%expr_pat
| fancy_sub log2wordmax imm =>
    fun x : expr (ℤ * ℤ)%etype =>
    Base (#(fancy_sub log2wordmax imm)%expr @ x)%expr_pat
| fancy_subb log2wordmax imm =>
    fun x : expr (ℤ * ℤ * ℤ)%etype =>
    Base (#(fancy_subb log2wordmax imm)%expr @ x)%expr_pat
| fancy_mulll log2wordmax =>
    fun x : expr (ℤ * ℤ)%etype =>
    Base (#(fancy_mulll log2wordmax)%expr @ x)%expr_pat
| fancy_mullh log2wordmax =>
    fun x : expr (ℤ * ℤ)%etype =>
    Base (#(fancy_mullh log2wordmax)%expr @ x)%expr_pat
| fancy_mulhl log2wordmax =>
    fun x : expr (ℤ * ℤ)%etype =>
    Base (#(fancy_mulhl log2wordmax)%expr @ x)%expr_pat
| fancy_mulhh log2wordmax =>
    fun x : expr (ℤ * ℤ)%etype =>
    Base (#(fancy_mulhh log2wordmax)%expr @ x)%expr_pat
| fancy_rshi log2wordmax x =>
    fun x0 : expr (ℤ * ℤ)%etype =>
    Base (#(fancy_rshi log2wordmax x)%expr @ x0)%expr_pat
| fancy_selc =>
    fun x : expr (ℤ * ℤ * ℤ)%etype => Base (#(fancy_selc)%expr @ x)%expr_pat
| fancy_selm log2wordmax =>
    fun x : expr (ℤ * ℤ * ℤ)%etype =>
    Base (#(fancy_selm log2wordmax)%expr @ x)%expr_pat
| fancy_sell =>
    fun x : expr (ℤ * ℤ * ℤ)%etype => Base (#(fancy_sell)%expr @ x)%expr_pat
| fancy_addm =>
    fun x : expr (ℤ * ℤ * ℤ)%etype => Base (#(fancy_addm)%expr @ x)%expr_pat
end
     : Compile.value' true t
